{
  "RECORDS": [
    {
      "title": "使用Spring AMQP进行RabbitMQ消息的发送和接收",
      "content": "<p>Spring Framework项目集成Spring AMQP</p><p><strong>#安装好RabbitMQ 3.5.6</strong></p><p>安装的介绍在这篇文章：<a href=\"http://imethan.cn/blog/article/78\" target=\"_blank\" title=\"http://imethan.cn/blog/article/78\">http://imethan.cn/blog/article/78</a></p><p><strong style=\"line-height: 1.42857;\"><br/></strong></p><p><strong style=\"line-height: 1.42857;\">#通过eclipse创建简单的maven项目</strong><br/></p><p><strong>#编辑pom.xml,指定编译器的版本</strong></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;build&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;plugins&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;plugin&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;version&gt;3.1&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;configuration&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t</span>&lt;source&gt;1.8&lt;/source&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t</span>&lt;target&gt;1.8&lt;/target&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t</span>&lt;encoding&gt;UTF-8&lt;/encoding&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;/configuration&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;/plugin&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/plugins&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/build&gt;</p><p><strong>#<span style=\"line-height: 22.8571px; white-space: normal;\">编辑pom.xml，</span>添加maven依赖</strong></p><p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>&lt;properties&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;spring-rabbit-version&gt;1.4.3.RELEASE&lt;/spring-rabbit-version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;rabbitmq-version&gt;3.5.0&lt;/rabbitmq-version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/properties&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;dependencies&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- rabbitmq begin --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;org.springframework.amqp&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;spring-rabbit&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;${spring-rabbit-version}&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;com.rabbitmq&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;amqp-client&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;${rabbitmq-version}&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- rabbitmq end --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;org.springframework&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;spring-test&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;scope&gt;test&lt;/scope&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;junit&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;junit&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;4.12&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;scope&gt;test&lt;/scope&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;commons-logging&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;commons-logging&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;1.2&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>&lt;/dependencies&gt;</p><p><br/></p><p><strong>#添加rabbitmq.properties文件</strong></p><p><strong></strong></p><p>#rabbitmq connection information</p><p>mq.host=192.168.42.133</p><p>mq.port=5673</p><p>mq.username=spring</p><p>mq.password=spring.com</p><p>mq.virtualhost=spring</p><p>mq.defaultqueue=defaultqueue</p><p><strong><br/></strong></p><p><strong>#添加Spring Rabbitmq配置文件“applicationContext-rabbitmq.xml”</strong></p><p><strong></strong></p><p><span style=\"white-space: nowrap;\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></p><p><span style=\"white-space: nowrap;\">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:rabbit=&quot;http://www.springframework.org/schema/rabbit&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xsi:schemaLocation=&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd&quot;&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>default-lazy-init=&quot;true&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;description&gt;Spring AMQP&lt;/description&gt;<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:annotation-config /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:component-scan base-package=&quot;cn.imethan&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:property-placeholder location=&quot;classpath:/rabbitmq/rabbitmq.properties&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 发送确认监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;messageConfirmCallback&quot; class=&quot;cn.imethan.rabbitmq.callback.MessageConfirmCallback&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 失败回调监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;messageReturnCallback&quot; class=&quot;cn.imethan.rabbitmq.callback.MessageReturnCallback&quot;/&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 连接工厂设置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;rabbitConnectionFactory&quot; class=&quot;org.springframework.amqp.rabbit.connection.CachingConnectionFactory&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;username&quot; value=&quot;${mq.username}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;password&quot; value=&quot;${mq.password}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;virtualHost&quot; value=&quot;${mq.virtualhost}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;host&quot; value=&quot;${mq.host}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;port&quot; value=&quot;${mq.port}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;channelCacheSize&quot; value=&quot;25&quot;/&gt;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;publisherConfirms&quot; value=&quot;true&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;publisherReturns&quot; value=&quot;true&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;rabbitTemplate&quot; class=&quot;org.springframework.amqp.rabbit.core.RabbitTemplate&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;connectionFactory&quot; ref=&quot;rabbitConnectionFactory&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- 设置确认监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;confirmCallback&quot; ref=&quot;messageConfirmCallback&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- 如果mandatory设置为true，但是不能被路由，则由returnCallback监听获取消息 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;mandatory&quot; value=&quot;true&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- 设置失败监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;returnCallback&quot; ref=&quot;messageReturnCallback&quot;/&gt;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;exchange&quot; value=&quot;remoting.exchange&quot;/&gt;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;routingKey&quot; value=&quot;${mq.defaultqueue}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 队列创建，并且绑定 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:admin id=&quot;admin&quot; connection-factory=&quot;rabbitConnectionFactory&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:queue name=&quot;${mq.defaultqueue}&quot; declared-by=&quot;admin&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 创建交换机并且绑定 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:direct-exchange name=&quot;remoting.exchange&quot; declared-by=&quot;admin&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;rabbit:bindings&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;rabbit:binding queue=&quot;${mq.defaultqueue}&quot; key=&quot;${mq.defaultqueue}&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/rabbit:bindings&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/rabbit:direct-exchange&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 监听设置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:listener-container connection-factory=&quot;rabbitConnectionFactory&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;rabbit:listener ref=&quot;awareRecviveListener&quot; method=&quot;listen&quot; queue-names=&quot;${mq.defaultqueue}&quot; &nbsp;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/rabbit:listener-container&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 接收监听器 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;awareRecviveListener&quot; class=&quot;cn.imethan.rabbitmq.listener.AwareRecviveListener&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;simpleRecviveListener&quot; class=&quot;cn.imethan.rabbitmq.listener.SimpleRecviveListener&quot; /&gt;</p><p><span style=\"white-space: nowrap;\">&lt;/beans&gt;</span></p><p><strong><br/></strong></p><p><strong><br/></strong></p><p><strong>#创建几个重要的类</strong></p><p><strong><span style=\"line-height: 22.8571px;\">MessageConfirmCallback：</span></strong></p><p><strong></strong></p><p><span style=\"white-space: nowrap;\">public class MessageConfirmCallback implements ConfirmCallback {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void confirm(CorrelationData correlationData, boolean ack,String cause) {<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageConfirmCallback correlationData:&quot;+correlationData);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageConfirmCallback &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ack:&quot;+ack);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageConfirmCallback &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cause:&quot;+cause);<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>if(ack){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>System.out.println(&quot;[RabbitMQ] send message to rabbitmq success !&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}else{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>System.out.println(&quot;[RabbitMQ] send message to rabbitmq fail !&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><strong>MessageReturnCallback ：</strong></span></span></p><p><span style=\"white-space: nowrap;\">public class MessageReturnCallback implements ReturnCallback {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void returnedMessage(Message message, int replyCode,</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>String replyText, String exchange, String routingKey) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback message:&quot;+message);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback replyCode:&quot;+replyCode);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback replyText:&quot;+replyText);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback exchange:&quot;+exchange);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback routingKey:&quot;+routingKey);<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><strong>AwareRecviveListener：</strong></span></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span style=\"white-space: nowrap;\">@Service</span></p><p><span style=\"white-space: nowrap;\">public class AwareRecviveListener implements ChannelAwareMessageListener &nbsp;{</span><span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private RabbitTemplate rabbitTemplate;<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void onMessage(Message message, Channel channel) throws Exception {<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageProperties messageProperties = message.getMessageProperties() ;<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String encoding = messageProperties.getContentEncoding();//编码</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String content = new String(message.getBody(),encoding);//内容<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String appId = messageProperties.getAppId();//发送时设置的发送方标示appid<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] recv message -appId:&quot;+appId +&quot; -message:&quot;+content);<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String vhost = rabbitTemplate.getConnectionFactory().getVirtualHost();//当前虚拟主机名称</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String consumerQueue = messageProperties.getConsumerQueue();//当前接收的队列名称<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//业务处理</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.handle(content);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 业务处理</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:15:03</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private void handle(String message) {<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><strong>SimpleRecviveListener：</strong></span></span></p><p><span style=\"white-space: nowrap;\">@Service</span></p><p><span style=\"white-space: nowrap;\">public class SimpleRecviveListener {</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 消息监听</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:14:36</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void listen(String message) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.handle(message);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 消息监听</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws UnsupportedEncodingException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:14:45</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void listen(byte[] message) throws UnsupportedEncodingException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.handle(new String(message, &quot;UTF-8&quot;));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 业务处理</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:15:03</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private void handle(String message) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] recv message:&quot;+message);</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>RabbitMqSender：</strong></span></p><p><span style=\"white-space: nowrap;\"></span></p><p>@Service</p><p>public class RabbitMqSender {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private RabbitTemplate rabbitTemplate;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param queue</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param content</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年11月9日 下午8:24:00</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void sendMessage(String queue,String content){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>String routingKey = queue;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>rabbitTemplate.setQueue(queue);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>rabbitTemplate.setRoutingKey(routingKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>rabbitTemplate.send(this.generateMessage(content,queue));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (AmqpException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 生成消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param content 消息内容</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param queueName 队列名称</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月6日 下午4:20:50</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private Message generateMessage(String content,String queueName){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String appId = rabbitTemplate.getConnectionFactory().getVirtualHost()+&quot;/&quot;+queueName;//将虚拟主机和队列名称设置为appId<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageProperties props = MessagePropertiesBuilder.newInstance()</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setContentType(MessageProperties.CONTENT_TYPE_TEXT_PLAIN)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setContentEncoding(&quot;UTF-8&quot;)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setTimestamp(new Date()).setHeader(&quot;&quot;, &quot;&quot;)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setAppId(appId)//设置发送中心系统识别</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Message message = MessageBuilder.withBody(content.getBytes())</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>.andProperties(props)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>.build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return message;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p>}</p><p><span style=\"white-space: nowrap;\"><br/></span><strong>#到此处，所有的准备工作都做好了，开始测试，测试类如下：</strong></p><p><span style=\"line-height: 22.8571px;\"><strong>RabbitMqTest：</strong></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span style=\"white-space: nowrap;\">@RunWith(SpringJUnit4ClassRunner.class)</span></p><p><span style=\"white-space: nowrap;\">@ContextConfiguration(locations={&quot;classpath:rabbitmq/applicationContext-rabbitmq.xml&quot;})&nbsp;</span></p><p><span style=\"white-space: nowrap;\">public class RabbitMqTest{ &nbsp;</span></p><p><span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private RabbitMqSender rabbitMqSender;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@BeforeClass</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static void initRabbitMq(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 测试向MQ发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月6日 下午2:47:34</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Test</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void testSend(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>rabbitMqSender.sendMessage(&quot;defaultqueue&quot;, &quot;向RabbitMQ发送消息！！！&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@AfterClass</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static void testRecv(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>源代码后续将和其他部分整理完整后，提交GitHub.</strong></span></p><p><br/></p><p><strong>#参考文档</strong></p><p><a title=\"http://projects.spring.io/spring-amqp/\" href=\"http://projects.spring.io/spring-amqp/\" target=\"_blank\">http://projects.spring.io/spring-amqp/</a></p><p><a title=\"http://docs.spring.io/spring-amqp/docs/1.5.1.RELEASE/reference/html/\" href=\"http://docs.spring.io/spring-amqp/docs/1.5.1.RELEASE/reference/html/\" target=\"_blank\">http://docs.spring.io/spring-amqp/docs/1.5.1.RELEASE/reference/html/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 16:07:20",
      "updateAt": "2015/12/18 16:07:20"
    },
    {
      "title": "使用Spring AMQP动态创建RabbitMQ连接进行消息的发送和接收",
      "content": "<p>使用Spring AMQP动态创建RabbitMQ连接进行消息的发送和接收</p><p><br/></p><p>未完待续~~</p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 16:13:54",
      "updateAt": "2015/12/18 16:13:54"
    },
    {
      "title": "Spring Web Flow 2.0 入门详解",
      "content": "<p><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/xwdreamer/archive/2011/11/10/2296939.html\"><span style=\"font-size:16px\">Spring Web Flow 2.0 入门详解</span></a><span style=\"font-size: 18px;\"><br/></span></p><p>参考文档<br/></p><p><a href=\"http://www.cnblogs.com/xwdreamer/archive/2011/11/10/2296939.html\" title=\"http://www.cnblogs.com/xwdreamer/archive/2011/11/10/2296939.html\" target=\"_blank\">http://www.cnblogs.com/xwdreamer/archive/2011/11/10/2296939.html</a></p><p><a href=\"http://www.ibm.com/developerworks/cn/education/java/j-spring-webflow/index.html\" title=\"http://www.ibm.com/developerworks/cn/education/java/j-spring-webflow/index.html\" target=\"_blank\">http://www.ibm.com/developerworks/cn/education/java/j-spring-webflow/index.html</a></p><p><br/></p>",
      "show": "0",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 17:36:45",
      "updateAt": "2015/12/18 17:36:45"
    },
    {
      "title": "Spring security 3中的10个典型用法小结",
      "content": "<p>Spring security 3中的10个典型用法小结</p><p>参考文档</p><p><a title=\"http://jackyrong.iteye.com/blog/1748493\" target=\"_blank\" href=\"http://jackyrong.iteye.com/blog/1748493\">http://jackyrong.iteye.com/blog/1748493</a></p><p><a href=\"http://stevex.blog.51cto.com/4300375/1358753\" title=\"http://stevex.blog.51cto.com/4300375/1358753\" target=\"_blank\">http://stevex.blog.51cto.com/4300375/1358753</a></p><p><a href=\"http://www.mossle.com/docs/auth/html/ch114-openid.html\" title=\"http://www.mossle.com/docs/auth/html/ch114-openid.html\" target=\"_blank\">http://www.mossle.com/docs/auth/html/ch114-openid.html</a></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 17:36:57",
      "updateAt": "2015/12/18 17:36:57"
    },
    {
      "title": "Spring MVC  i18n国际化配置",
      "content": "<p><strong>Spring MVC i18n国际化配置</strong></p><p><br/></p><p><strong>#准备工作</strong></p><p>该配置在Spring项目上进行自不必再说，另外还需要配置好Spring mvc</p><p><br/></p><p><strong>#message文件创建</strong></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">message文件“<span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">welcome_en_US.properties</span></span>”内容：</span></p><p>#welcome_en_US.properties</p><p>welcome.springmvc = Happy learning Spring MVC</p><p><br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">message文件“<span style=\"line-height: 22.8571px; white-space: normal;\">welcome_zh_CN.properties</span>”</span></span>内容：</span></p><p>#welcome_zh_CN.properties</p><p>welcome.springmvc = \\u5feb\\u4e50\\u5b66\\u4e60 Spring MVC</p><p><strong><br/></strong></p><p><strong><br/></strong></p><p><strong>#向Spring mvc配置文件“spring-mvc.xml”中添加配置</strong></p><p><strong><br/></strong></p><p>&lt;!-- 添加locate拦截器，拦截所有的控制器请求&nbsp;--&gt;</p><p><strong></strong></p><p>&lt;mvc:interceptor&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;mvc:mapping path=&quot;/**&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;mvc:exclude-mapping path=&quot;/theme/**&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;mvc:exclude-mapping path=&quot;/upload/**&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;ref local=&quot;localeChangeInterceptor&quot;/&gt;</p><p>&lt;/mvc:interceptor&gt;</p><p><br/></p><p>&lt;!-- i18n国际化配置 --&gt;</p><p>&lt;bean id=&quot;localeResolver&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>class=&quot;org.springframework.web.servlet.i18n.SessionLocaleResolver&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;defaultLocale&quot; value=&quot;zh_CN&quot; /&gt;</p><p>&lt;/bean&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p>&lt;!-- i18n本地化设置拦截器 --&gt;</p><p>&lt;bean id=&quot;localeChangeInterceptor&quot;&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>class=&quot;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;paramName&quot; value=&quot;language&quot; /&gt;</p><p>&lt;/bean&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p>&lt;!-- 添加message文件 --&gt;</p><p>&lt;bean id=&quot;messageSource&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>class=&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;basename&quot; value=&quot;message/welcome&quot; /&gt;</p><p>&lt;/bean&gt;</p><p><br/></p><p><strong>#JSP页面</strong></p><p>1、添加如下标签支持：</p><p>&lt;%@ taglib prefix=&quot;spring&quot; uri=&quot;http://www.springframework.org/tags&quot; %&gt;</p><p><br/></p><p>2、添加如下内容:</p><p><span style=\"line-height: 1.42857;\">Language : &lt;a href=&quot;?language=en_US&quot;&gt;English&lt;/a&gt;|&lt;a href=&quot;?language=zh_CN&quot;&gt;Chinese&lt;/a&gt;</span><br/></p><p>welcome.springmvc : &lt;spring:message code=&quot;welcome.springmvc&quot; text=&quot;default text&quot; /&gt;</p><p>Current Locale : ${pageContext.response.locale}</p><p><br/></p><p><strong>#结语</strong></p><p>上述过程简单记录spring mvc添加i18国际化配置支持，通过浏览器url请求来更改locate的值，<span style=\"line-height: 22.8571px; white-space: normal;\">messageSource根据不同的locate来切换展现的message内容，添加全局拦截器，所以控制器不需要添加额外的内容。</span></p><p><br/></p><p><strong>#参考文档</strong></p><p><a href=\"http://www.mkyong.com/spring-mvc/spring-mvc-internationalization-example/\" target=\"_blank\" title=\"http://www.mkyong.com/spring-mvc/spring-mvc-internationalization-example/\">http://www.mkyong.com/spring-mvc/spring-mvc-internationalization-example/</a></p><p><a href=\"http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/\" target=\"_blank\" title=\"http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/\">http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/</a></p><p><br/></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 17:37:08",
      "updateAt": "2015/12/18 17:37:08"
    },
    {
      "title": "Spring Security TokenBasedRememberMeServices的cookie加密",
      "content": "<p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * Calculates the digital signature to be put in the cookie. Default value is MD5</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * (&quot;username:tokenExpiryTime:password:key&quot;)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>protected String makeTokenSignature(long tokenExpiryTime, String username,</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>String password) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String data = username + &quot;:&quot; + tokenExpiryTime + &quot;:&quot; + password + &quot;:&quot; + getKey();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageDigest digest;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>digest = MessageDigest.getInstance(&quot;MD5&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>catch (NoSuchAlgorithmException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>throw new IllegalStateException(&quot;No MD5 algorithm available!&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return new String(Hex.encode(digest.digest(data.getBytes())));</p><p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>}</p><p><br/></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 17:38:22",
      "updateAt": "2015/12/18 17:38:22"
    },
    {
      "title": "Spring MVC项目添加Spring mobile支持",
      "content": "<p></p><p>1、添加jar包支持</p><p>//Spring mobile</p><p>compile &#39;org.springframework.mobile:spring-mobile-device:1.1.3.RELEASE&#39;</p><p><br/>2、Spring MVC配置文件添加如下内容&nbsp; <br/>&lt;mvc:interceptors&gt;<br/>&nbsp;&lt;!-- On pre-handle, resolve the device that originated the web request --&gt;<br/>&nbsp;&lt;mvc:interceptor&gt;<br/>&nbsp;&nbsp;&lt;mvc:mapping path=&quot;/mobile/**&quot;/&gt;<br/>&nbsp; &nbsp;&nbsp;&lt;bean class=&quot;org.springframework.mobile.device.DeviceResolverHandlerInterceptor&quot; /&gt;<br/>&nbsp; &nbsp;&lt;/mvc:interceptor&gt;&nbsp; <br/>&lt;/mvc:interceptors&gt;&nbsp;</p><p>&lt;mvc:annotation-driven&gt;<br/>&nbsp;&lt;mvc:argument-resolvers&gt;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&lt;bean class=&quot;org.springframework.mobile.device.DeviceWebArgumentResolver&quot; /&gt;<br/>&nbsp;&lt;/mvc:argument-resolvers&gt;<br/>&lt;/mvc:annotation-driven&gt;</p><p><br/>3、控制器代码</p><p>@Controller</p><p>@RequestMapping(&quot;/mobile&quot;)</p><p>public class MobileController {</p><p>&nbsp;</p><p>&nbsp;&nbsp;&nbsp; @RequestMapping(&quot;&quot;)</p><p>&nbsp;&nbsp;&nbsp; public String mobile(Device device,Model model) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String message = &quot;&quot;;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (device.isMobile()) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(message = &quot;Hello mobile user!&quot;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (device.isTablet()) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(message = &quot;Hello tablet user!&quot;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(message = &quot;Hello desktop user!&quot;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.addAttribute(&quot;message&quot;, message);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return &quot;mobile/mobile&quot;;</p><p>&nbsp;&nbsp;&nbsp; }</p><p>}</p><p>&nbsp;</p><p><br/>更多详细配置请看：<a href=\"http://projects.spring.io/spring-mobile/\">http://projects.spring.io/spring-mobile/</a></p><p></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 17:38:37",
      "updateAt": "2015/12/18 17:38:37"
    },
    {
      "title": "Spring集成分布式Quartz框架之一：常规整合",
      "content": "<p><strong>该配置为了解决WEB项目分布式部署时定时任务的并发冲突问题。</strong></p><p>配置环境如下：</p><p>JDK 1.7</p><p>Spring 4.0.2</p><p>Quartz 2.2.1</p><p><strong>首先要导入quartz涉及到11张表</strong></p><p>从官网http://www.quartz-scheduler.org<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span>下载“<a href=\"http://d2zwv9pap9ylyd.cloudfront.net/quartz-2.2.1-distribution.tar.gz\" target=\"_blank\">quartz-2.2.1-distribution.tar.gz</a>”，解压，从“quartz-2.2.1-distribution\\quartz-2.2.1\\docs\\dbTables”目录下找到合适的您项目的脚本<span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span></p><p><br/></p><p><strong>两个主要配置文件：<span style=\"line-height: 22.8571px; white-space: normal;\">quartz.properties和<span style=\"line-height: 22.8571px; white-space: normal;\">applicationContext-quartz.xml，文件内容</span></span>如下：</strong></p><p>quartz.properties文件内容：</p><p><span style=\"white-space: nowrap;\"># Using Spring datasource in quartzJobsConfig.xml</span></p><p><span style=\"white-space: nowrap;\"># Spring uses LocalDataSourceJobStore extension of JobStoreCMT</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.useProperties=true</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.tablePrefix=QRTZ_</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.isClustered=true</span></p><p><span style=\"white-space: nowrap;\"># 1 mins</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.clusterCheckinInterval=15000</span></p><p><span style=\"white-space: nowrap;\">org.quartz.scheduler.skipUpdateCheck=true</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"># Change this to match your DB vendor</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span></p><p><span style=\"white-space: nowrap;\"># Needed to manage cluster instances</span></p><p><span style=\"white-space: nowrap;\">org.quartz.scheduler.instanceId=AUTO</span></p><p><span style=\"white-space: nowrap;\">org.quartz.scheduler.instanceName=quartzInstanceName</span></p><p><span style=\"white-space: nowrap;\">&nbsp;</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.threadCount=10</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.threadPriority=5</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread=true</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"># Configure Plugins</span></p><p><span style=\"white-space: nowrap;\">org.quartz.plugin.triggHistory.class=org.quartz.plugins.history.LoggingJobHistoryPlugin</span></p><p><span style=\"white-space: nowrap;\">#org.quartz.plugin.triggHistory.class=org.quartz.plugins.history.LoggingTriggerHistoryPlugin</span></p><p><span style=\"white-space: nowrap;\">#org.quartz.plugin.triggHistory.triggerFiredMessage=Trigger \\{1\\}.\\{0\\} fired job \\{6\\}.\\{5\\} at: \\{4, date, HH:mm:ss MM/dd/yyyy}</span></p><p><span style=\"white-space: nowrap;\">#org.quartz.plugin.triggHistory.triggerCompleteMessage=Trigger \\{1\\}.\\{0\\} completed firing job \\{6\\}.\\{5\\} at \\{4, date, HH:mm:ss MM/dd/yyyy\\}</span></p><p><br/></p><p>applicationContext-quartz.xml文件内容：</p><p><span style=\"white-space: nowrap;\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></p><p><span style=\"white-space: nowrap;\">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:task=&quot;http://www.springframework.org/schema/task&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/context</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/context/spring-context-3.2.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/task</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/task/spring-task-3.2.xsd&quot;&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;description&gt;quartz分布式配置文件&lt;/description&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:annotation-config /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 任务配置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;jobDetail&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>class=&quot;org.springframework.scheduling.quartz.JobDetailFactoryBean&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobClass&quot; value=&quot;cn.imethan.admin.quartz.job.TestJob&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;durability&quot; value=&quot;true&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- &lt;property name=&quot;requestsRecovery&quot; value=&quot;true&quot; /&gt; --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 触发器 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;jobDetailTrigger&quot; class=&quot;org.springframework.scheduling.quartz.CronTriggerFactoryBean&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobDetail&quot; ref=&quot;jobDetail&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;cronExpression&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;value&gt;0/5 * * * * ?&lt;/value&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;timeZone&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;value&gt;GMT+8:00&lt;/value&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 任务调度配置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;quartzScheduler&quot; class=&quot;org.springframework.scheduling.quartz.SchedulerFactoryBean&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;configLocation&quot; value=&quot;classpath:/quartz/quartz.properties&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;dataSource&quot; ref=&quot;myDataSource&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;transactionManager&quot; ref=&quot;myTxManager&quot; /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- This name is persisted as SCHED_NAME in db. for local testing could&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>change to unique name to avoid collision with dev server --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;schedulerName&quot; value=&quot;quartzScheduler&quot; /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;startupDelay&quot; value=&quot;5&quot; /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- Will update database cron triggers to what is in this jobs file on&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>each deploy. Replaces all previous trigger and job data that was in the database.&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>YMMV --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;overwriteExistingJobs&quot; value=&quot;true&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;autoStartup&quot; value=&quot;true&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;applicationContextSchedulerContextKey&quot; value=&quot;applicationContext&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobFactory&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;bean class=&quot;cn.imethan.admin.quartz.common.AutowiringSpringBeanJobFactory&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- NOTE: Must add both the jobDetail and trigger to the scheduler! --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;triggers&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;ref bean=&quot;jobDetailTrigger&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;/list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobDetails&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;ref bean=&quot;jobDetail&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;/list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span style=\"white-space: nowrap;\">&lt;/beans&gt;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>两个主要的类，AutowiringSpringBeanJobFactory和TestJob，类内容如下：</strong></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\">AutowiringSpringBeanJobFactory类内容：</span></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"></span></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.common;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.quartz.spi.TriggerFiredBundle;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.beans.factory.config.AutowireCapableBeanFactory;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.context.ApplicationContext;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.context.ApplicationContextAware;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.scheduling.quartz.SpringBeanJobFactory;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* AutowiringSpringBeanJobFactory.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @time 2015年9月19日下午3:33:22</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public final class AutowiringSpringBeanJobFactory extends SpringBeanJobFactory implements ApplicationContextAware {</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private transient AutowireCapableBeanFactory beanFactory;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setApplicationContext(final ApplicationContext context) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>beanFactory = context.getAutowireCapableBeanFactory();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>protected Object createJobInstance(final TriggerFiredBundle bundle) throws Exception {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>final Object job = super.createJobInstance(bundle);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>beanFactory.autowireBean(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return job;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">TestJob类内容如下：</span></span></span><br/></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"></span></span></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.job;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.DisallowConcurrentExecution;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionContext;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionException;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.scheduling.quartz.QuartzJobBean;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import cn.imethan.common.utils.DateUtil;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* TestJob.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @time 2015年9月19日下午3:36:40</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">@DisallowConcurrentExecution</span></p><p><span style=\"white-space: nowrap;\">public class TestJob extends QuartzJobBean {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; protected void executeInternal(JobExecutionContext arg0) throws JobExecutionException {</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>System.out.println(&quot;[TestJob]Sleep 10s begin date:&quot;+DateUtil.getDatetimeStr(DateUtil.DATE_PATTERN_01));</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>try {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>Thread.sleep(4000);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (InterruptedException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>System.out.println(&quot;[TestJob]Sleep 10s end &nbsp; date:&quot;+DateUtil.getDatetimeStr(DateUtil.DATE_PATTERN_01));</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; }</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></span><br/></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></span></p><p>参考文档</p><p><a title=\"http://www.cnblogs.com/skyblue/p/3296350.html\" target=\"_blank\" href=\"http://www.cnblogs.com/skyblue/p/3296350.html\">http://www.cnblogs.com/skyblue/p/3296350.html</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 17:38:10",
      "updateAt": "2015/12/23 11:28:51"
    },
    {
      "title": "Spring集成分布式Quartz框架之二：动态添加、修改、删除任务",
      "content": "<p>在上一篇关于<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span><a title=\"http://www.imethan.cn/blog/article/72\" href=\"http://www.imethan.cn/blog/article/72\" target=\"_blank\">《Spring集成配置分布式Quartz框架之一：常规整合》</a><span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span>的基础之上实现动态添加、修改、删除任务</span></span></p><p><br/></p><p>通常我们将Quartz整合到Spring是通过配置文件的方式配置任务Job和触发器Trigger，每次更改或者添加配置，都需要重新启动项目，为了解决该问题，在网络上翻阅了一些资料后，整理了动态添加、修改和删除任务的功能。<span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span></p><p>主要封装了三个类:QuartzJob（任务信息类）、QuartzJobFactory（任务执行类）、<span style=\"line-height: 22.8571px; white-space: normal;\">DynamicQuartzJobFactory（动态执行任务工厂类）。</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">废话少说，上菜~~</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><strong><span style=\"line-height: 22.8571px; white-space: normal;\">1、任务信息类：</span>QuartzJob</strong></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><strong></strong></span></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.dynamic;</span></p><p><span style=\"white-space: nowrap;\">import java.io.Serializable;</span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* ScheduleJob.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @since JDK 1.7</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2015年12月22日下午3:42:38</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public class QuartzJob implements Serializable {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p>&nbsp; &nbsp; //需要实现序列化接口，否则没办法持久化到数据库</p><p>&nbsp; &nbsp; private static final long serialVersionUID = -1800494926172862932L;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobId;//任务id</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobName;//任务名称</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobGroup;//任务分组</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobStatus;//任务状态 0禁用 1启用 2删除</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String cronExpression;//任务运行时间表达式</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String description;//任务描述</span><span style=\"white-space: nowrap; line-height: 1.42857;\">&nbsp; &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobId() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobId;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobId(String jobId) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobId = jobId;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobName() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobName;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobName(String jobName) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobName = jobName;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobGroup() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobGroup;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobGroup(String jobGroup) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobGroup = jobGroup;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobStatus() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobStatus;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobStatus(String jobStatus) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobStatus = jobStatus;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getCronExpression() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return cronExpression;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setCronExpression(String cronExpression) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.cronExpression = cronExpression;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getDescription() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return description;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setDescription(String description) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.description = description;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><strong style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><br/></span></strong></p><p><strong style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">2、任务执行工厂类：</span>QuartzJobFactory</strong><br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong></strong></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.dynamic;</span></p><p><span style=\"white-space: nowrap;\">import java.io.Serializable;</span></p><p><span style=\"white-space: nowrap;\">import java.text.SimpleDateFormat;</span></p><p><span style=\"white-space: nowrap;\">import java.util.Date;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.quartz.DisallowConcurrentExecution;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.Job;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionContext;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionException;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* QuartzJobFactory.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @since JDK 1.7</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2015年12月21日下午5:36:08</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">@DisallowConcurrentExecution</span></p><p><span style=\"white-space: nowrap;\">public class QuartzJobFactory &nbsp;implements Job,Serializable{</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static final long serialVersionUID = 3352853281096701664L;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void execute(JobExecutionContext context) throws JobExecutionException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>// TODO Auto-generated method stub</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;★★★★★★★★★★★QuartzJob★★★★★★★★★★★:&quot;+new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date())); &nbsp; &nbsp;</p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;QuartzJob Name = [&quot; + context.getJobDetail().getKey() + &quot;]&quot;);</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>Thread.sleep(5000);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (InterruptedException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong><span style=\"line-height: 22.8571px; white-space: normal;\">3、动态执行任务工厂类：</span>DynamicQuartzJobFactory</strong></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong></strong></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.dynamic;</span></p><p><span style=\"white-space: nowrap;\">import java.util.ArrayList;</span></p><p><span style=\"white-space: nowrap;\">import java.util.List;</span></p><p><span style=\"white-space: nowrap;\">import java.util.Set;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import javax.transaction.Transactional;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.quartz.CronScheduleBuilder;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.CronTrigger;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobBuilder;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobDetail;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionContext;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobKey;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.Scheduler;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.SchedulerException;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.Trigger;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.TriggerBuilder;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.TriggerKey;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.impl.matchers.GroupMatcher;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.beans.factory.annotation.Autowired;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.scheduling.quartz.SchedulerFactoryBean;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.stereotype.Component;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* DynamicQuartzJobFactory.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @since JDK 1.7</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2015年12月21日下午5:32:50</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">@Component</span></p><p><span style=\"white-space: nowrap;\">@Transactional//必须添加事务注释，否则任务没办法持久化到数据库</span></p><p><span style=\"white-space: nowrap;\">public class DynamicQuartzJobFactory {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private SchedulerFactoryBean quartzScheduler;//将配置文件的注册的bean注入</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 获取任务调度</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午11:23:49</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private Scheduler getScheduler(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return quartzScheduler.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 准备任务数据</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午11:23:41</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private List&lt;QuartzJob&gt; getAllJob(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;QuartzJob&gt; list = new ArrayList&lt;QuartzJob&gt;();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (int i = 0; i &lt; 5; i++) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>QuartzJob job = new QuartzJob();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobId(&quot;10001&quot; + i);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobName(&quot;TESTJOB&quot; + i);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobGroup(&quot;DEFAULT&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobStatus(&quot;1&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setCronExpression(&quot;0/5 * * * * ?&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setDescription(&quot;测试任务&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>list.add(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return list;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 测试入口</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午11:24:11</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void testOne(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>List&lt;QuartzJob&gt; jobList = getAllJob();//这里获取任务信息数据</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>for (QuartzJob job : jobList) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>this.addJob(job.getJobName(), job.getJobGroup(), job.getCronExpression());</p><p><span style=\"white-space: nowrap;\">//<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>this.deleteJob(job.getJobName(), job.getJobGroup());</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (SchedulerException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 获取计划中的任务列表</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:55:44</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public List&lt;QuartzJob&gt; getTriggersOfJob() throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>GroupMatcher&lt;JobKey&gt; matcher = GroupMatcher.anyJobGroup();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Set&lt;JobKey&gt; jobKeys = scheduler.getJobKeys(matcher);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;QuartzJob&gt; jobList = new ArrayList&lt;QuartzJob&gt;();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (JobKey jobKey : jobKeys) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;List&lt;? extends Trigger&gt; triggers = scheduler.getTriggersOfJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;for (Trigger trigger : triggers) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>QuartzJob job = new QuartzJob();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setJobName(jobKey.getName());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setJobGroup(jobKey.getGroup());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setDescription(&quot;触发器:&quot; + trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;Trigger.TriggerState triggerState = scheduler.getTriggerState(trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setJobStatus(triggerState.name());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;if (trigger instanceof CronTrigger) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CronTrigger cronTrigger = (CronTrigger) trigger;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String cronExpression = cronTrigger.getCronExpression();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;job.setCronExpression(cronExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;jobList.add(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobList;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 获取正在执行的任务列表</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:56:02</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public List&lt;QuartzJob&gt; getCurrentlyExecutingJobs() throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;JobExecutionContext&gt; executingJobs = scheduler.getCurrentlyExecutingJobs();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;QuartzJob&gt; jobList = new ArrayList&lt;QuartzJob&gt;(executingJobs.size());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (JobExecutionContext executingJob : executingJobs) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>QuartzJob job = new QuartzJob();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;JobDetail jobDetail = executingJob.getJobDetail();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;JobKey jobKey = jobDetail.getKey();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;Trigger trigger = executingJob.getTrigger();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setJobName(jobKey.getName());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setJobGroup(jobKey.getGroup());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setDescription(&quot;触发器:&quot; + trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;Trigger.TriggerState triggerState = scheduler.getTriggerState(trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setJobStatus(triggerState.name());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;if (trigger instanceof CronTrigger) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;CronTrigger cronTrigger = (CronTrigger) trigger;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;String cronExpression = cronTrigger.getCronExpression();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setCronExpression(cronExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;jobList.add(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobList;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 添加任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param timeExpression</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:03:02</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public boolean addJob(String jobName,String jobGroup,String timeExpression) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//获取trigger，即在spring配置文件中定义的 bean id=&quot;myTrigger&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>TriggerKey triggerKey = TriggerKey.triggerKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>if (trigger == null) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//不存在，创建一个</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>JobDetail jobDetail = JobBuilder.newJob(QuartzJobFactory.class).withIdentity(jobName, jobGroup).storeDurably().build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>jobDetail.getJobDataMap().put(&quot;scheduleJob&quot;, &quot;job&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>scheduler.addJob(jobDetail, true);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//表达式调度构建器</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(timeExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//按新的cronExpression表达式构建一个新的trigger</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>trigger = TriggerBuilder.newTrigger().withIdentity(jobName, jobGroup).forJob(jobDetail).withSchedule(scheduleBuilder).build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>boolean isExists = scheduler.checkExists(jobDetail.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>if(!isExists){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>scheduler.scheduleJob(jobDetail, trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}else{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>scheduler.scheduleJob(trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} else {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>// Trigger已存在，那么更新相应的定时设置</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//表达式调度构建器</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(timeExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//按新的cronExpression表达式重新构建trigger</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>trigger = trigger.getTriggerBuilder().withIdentity(triggerKey).withSchedule(scheduleBuilder).build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//按新的trigger重新设置job执行</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>scheduler.rescheduleJob(triggerKey, trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return false;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 暂停任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:17:00</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void pauseJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobName);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.pauseJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 恢复任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:17:41</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void resumeJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.resumeJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 删除任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:18:38</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void &nbsp;deleteJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.deleteJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 触发任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:19:49</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void &nbsp;triggerJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.triggerJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 更新任务触发器时间</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param timeExpression</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:21:55</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void modifyTimeExpression(String jobName,String jobGroup,String timeExpression) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>TriggerKey triggerKey = TriggerKey.triggerKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//获取trigger，即在spring配置文件中定义的 bean id=&quot;myTrigger&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//表达式调度构建器</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(timeExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//按新的cronExpression表达式重新构建trigger</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>trigger = trigger.getTriggerBuilder().withIdentity(triggerKey).withSchedule(scheduleBuilder).build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//按新的trigger重新设置job执行</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.rescheduleJob(triggerKey, trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><br/></p><p><br/></p><p><strong>参考文档</strong></p><p><strong><a title=\"http://www.quartz-scheduler.org/\" href=\"http://www.quartz-scheduler.org/\" target=\"_blank\">http://www.quartz-scheduler.org/</a></strong></p><p><a title=\"http://www.dexcoder.com/selfly/article/308\" href=\"http://www.dexcoder.com/selfly/article/308\" target=\"_blank\">http://www.dexcoder.com/selfly/article/308</a></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/23 11:11:20",
      "updateAt": "2015/12/23 14:14:49"
    },
    {
      "title": "Spring security整合CAS单点登录，业务系统无法单点注销",
      "content": "<p>Spring security整合CAS单点登录，业务系统无法单点注销</p><p><br/></p><p>Spring Security启用session-fixation-protection，这会在登录时销毁用户的当前session，然后为用户创建一个新session，并将原有session中的所有属性都复制到新session中，导致单点注销时无法注销登录原有的session，从而导致单点注销失败。</p><p><br/></p><p>将session-fixation-protection禁用后，可以正常单点注销。</p><p><br/></p><p>在Spring security 4 中体现在:<br/></p><p>&lt;bean id=&quot;sessionAuthenticationStrategy&quot; class=&quot;org.springframework.security.web.authentication.session.CompositeSessionAuthenticationStrategy&quot;&gt;<br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;constructor-arg&gt;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;list&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;bean /&gt;<br/></p><p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &lt;/list&gt;<br/>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/constructor-arg&gt;</p><p>&lt;/bean&gt;<br/></p><p>bean类不要引入如下bean<br/></p><p>&lt;bean class=&quot;org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy&quot; /&gt;</p><p><br/></p><p><br/></p><p>参考文档</p><p><a title=\"http://blog.csdn.net/seng3018/article/details/7019872\" target=\"_blank\" href=\"http://blog.csdn.net/seng3018/article/details/7019872\">http://blog.csdn.net/seng3018/article/details/7019872</a></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 16:10:51",
      "updateAt": "2015/12/29 14:40:37"
    },
    {
      "title": "Spring项目整合Logback日志框架",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">1、加入maven依赖</span></p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&lt;!--&nbsp;logback&nbsp;begin&nbsp;&nbsp;--&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;1.1.3&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.logback-extensions&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;logback-ext-spring&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;0.1.2&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;1.7.12&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;!--&nbsp;logback&nbsp;end&nbsp;&nbsp;--&gt;</pre><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: &#39;microsoft yahei&#39;; font-size: 15px; line-height: 35px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">第一个logback-classic包含了logback本身所需的slf4j-api.jar、logback-core.jar及logback-classsic.jar</span></p><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: &#39;microsoft yahei&#39;; font-size: 15px; line-height: 35px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">第二个logback-ext-spring是由官方提供的对Spring的支持，它的作用就相当于log4j中的Log4jConfigListener；这个listener，网上大多都是用的自己实现的，原因在于这个插件似乎并没有出现在官方文档的显要位置导致大多数人并不知道它的存在</span></p><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: &#39;microsoft yahei&#39;; font-size: 15px; line-height: 35px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">第三个jcl-over-slf4j是用来把Spring源代码中大量使用到的commons-logging替换成slf4j，只有在添加了这个依赖之后才能看到Spring框架本身打印的日志，否则只能看到开发者自己打印的日志</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">2、日志配置文件&quot;log/logback.xml&quot;</span></p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;configuration&gt;\n\n\t&lt;!--定义日志文件的存储地址&nbsp;勿在&nbsp;LogBack&nbsp;的配置中使用相对路径--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;LOG_HOME&quot;&nbsp;value=&quot;${user.dir}&quot;&nbsp;/&gt;\n\n\t&lt;!--&nbsp;控制台输出&nbsp;--&gt;\n\t&lt;appender&nbsp;name=&quot;console&quot;&nbsp;class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;\n\t\t&lt;encoder&nbsp;charset=&quot;UTF-8&quot;&gt;\n\t\t\t&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;\n\t\t\t&lt;pattern&gt;%date{HH:mm:ss.SSS}&nbsp;[%thread]&nbsp;%-5level&nbsp;%logger{36}&nbsp;-&nbsp;%msg%n&lt;/pattern&gt;\n\t\t&lt;/encoder&gt;\n\t&lt;/appender&gt;\n\t\n\t&lt;!--&nbsp;按照每天生成日志文件&nbsp;--&gt;\n\t&lt;appender&nbsp;name=&quot;rollingFile&quot;&nbsp;class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;\n\t\t&lt;file&gt;${LOG_HOME}/logs/system.log&lt;/file&gt;\n\t\t&lt;rollingPolicy&nbsp;class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;\n\t\t\t&lt;!--日志文件输出的文件名--&gt;\n\t\t\t&lt;fileNamePattern&gt;${LOG_HOME}/logs/system.%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;\n\t\t\t&lt;!--日志文件保留天数--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;MaxHistory&gt;30&lt;/MaxHistory&gt;\n\t\t&lt;/rollingPolicy&gt;\n\t\t&lt;encoder&gt;\n\t\t\t&lt;pattern&gt;%date{HH:mm:ss.SSS}&nbsp;[%thread]&nbsp;%-5level&nbsp;%logger{36}&nbsp;-&nbsp;%msg%n&lt;/pattern&gt;\n\t\t&lt;/encoder&gt;\n\t&lt;/appender&gt;\n\t\n\t&lt;appender&nbsp;name=&quot;businessLogFile&quot;&nbsp;class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;\n\t\t&lt;file&gt;${LOG_HOME}/logs/system_business.log&lt;/file&gt;\n\t\t&lt;!--&nbsp;按每小时滚动文件，如果一个小时内达到10M也会滚动文件,&nbsp;滚动文件将会压缩成zip格式&nbsp;--&gt;\n\t\t&lt;rollingPolicy&nbsp;class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;\n\t\t\t&lt;fileNamePattern&gt;${LOG_HOME}/logs/system_business_%d{yyyy-MM-dd_HH}.%i.zip&lt;/fileNamePattern&gt;\n\t\t\t&lt;!--日志文件最大的大小--&gt;\n\t\t\t&lt;timeBasedFileNamingAndTriggeringPolicy&nbsp;class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt;\n\t\t\t\t&lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;\n\t\t\t&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;\n\t\t\t&lt;!--日志文件保留天数--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;MaxHistory&gt;30&lt;/MaxHistory&gt;\n\t\t&lt;/rollingPolicy&gt;\n\t\t&lt;!--&nbsp;独立的pattern&nbsp;--&gt;\n\t\t&lt;encoder&nbsp;charset=&quot;UTF-8&quot;&gt;\n\t\t\t&lt;pattern&gt;%d{HH:mm:ss.SSS},%msg%n&lt;/pattern&gt;\n\t\t&lt;/encoder&gt;\n\t&lt;/appender&gt;\n\t\n\t&lt;!--&nbsp;business&nbsp;log&nbsp;使用独立的appender，不继承Root的appender&nbsp;--&gt;\n\t&lt;logger&nbsp;name=&quot;business&quot;&nbsp;level=&quot;INFO&quot;&nbsp;additivity=&quot;false&quot;&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;businessLogFile&quot;&nbsp;/&gt;\n\t&lt;/logger&gt;\n\n\t&lt;!--&nbsp;日志输出级别&nbsp;--&gt;\n\t&lt;root&nbsp;level=&quot;DEBUG&quot;&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;console&quot;&nbsp;/&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;rollingFile&quot;&nbsp;/&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;businessLogFile&quot;&nbsp;/&gt;\n\t&lt;/root&gt;\n\t\n\t&lt;!--&nbsp;下面配置一些第三方包的日志过滤级别，用于避免刷屏，additivity属性为false，表示此loger的打印信息不再向上级传递，默认为true&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;org.hibernate&quot;&nbsp;level=&quot;error&quot;&nbsp;additivity=&quot;false&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;org.springframework&quot;&nbsp;level=&quot;error&quot;&nbsp;additivity=&quot;false&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;com.opensymphony&quot;&nbsp;level=&quot;WARN&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;org.apache&quot;&nbsp;level=&quot;info&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;java.sql.Connection&quot;&nbsp;level=&quot;DEBUG&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;java.sql.Statement&quot;&nbsp;level=&quot;DEBUG&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;java.sql.PreparedStatement&quot;&nbsp;level=&quot;DEBUG&quot;&nbsp;/&gt;\n\t\n&lt;/configuration&gt;</pre><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">3、web.xml配置文件添加如下内容配置</span></p><pre class=\"brush:xml;toolbar:false\">\t&lt;!--&nbsp;logback监听配置,context-param必须独立配置&nbsp;--&gt;\n\t&lt;context-param&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\t&lt;param-name&gt;logbackConfigLocation&lt;/param-name&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\t&lt;param-value&gt;classpath:log/logback.xml&lt;/param-value&gt;\n\t&lt;/context-param&gt;\n\t&lt;listener&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\t&lt;listener-class&gt;ch.qos.logback.ext.spring.web.LogbackConfigListener&lt;/listener-class&gt;\n\t&lt;/listener&gt;</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">注意，该配置文件必须放在&lt;context-param&gt;...&lt;/context-param&gt;配置文件之后，如果没有会导致Logback找不到自定义的配置文件，而使用默认的配置文件，从而导致配置没有生效</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">参考文档：<br/></span></p><p><a href=\"http://logback.qos.ch/\" target=\"_blank\" style=\"text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">http://logback.qos.ch/</span></a></p><p><a href=\"http://blog.csdn.net/sadfishsc/article/details/47160213\" target=\"_self\" style=\"text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">http://blog.csdn.net/sadfishsc/article/details/47160213</span></a></p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Spring Framework",
      "createAt": "2015/12/29 14:43:09",
      "updateAt": "2015/12/29 15:05:29"
    },
    {
      "title": "Spring Framework项目集成Spring Data MongoDB",
      "content": "<p><strong>以下简要记录Spring Framework项目集成Spring Data MongoDB的过程步骤</strong></p><p><strong>#首先引入依赖的类库，Spring Framework项目使用的是Gradle构建工具，所以依赖引入如下：</strong></p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;//Spring&nbsp;data&nbsp;mongodb&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;org.springframework.data:spring-data-mongodb:1.8.0.RELEASE&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;com.mysema.querydsl:querydsl-apt:3.6.7&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;com.mysema.querydsl:querydsl-mongodb:3.6.7&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;//Spring&nbsp;data&nbsp;mongodb&nbsp;end\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;//mongodb&nbsp;driver&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;org.mongodb:mongo-java-driver:2.12.3&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;//mongodb&nbsp;driver&nbsp;end\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;//需要引入测试依赖包\n&nbsp;&nbsp;&nbsp;testCompile&nbsp;&#39;org.springframework:spring-test:4.2.1.RELEASE&#39;\n&nbsp;&nbsp;&nbsp;//引入junit依赖包\n&nbsp;&nbsp;&nbsp;testCompile&nbsp;group:&nbsp;&#39;junit&#39;,&nbsp;name:&nbsp;&#39;junit&#39;,&nbsp;version:&nbsp;&#39;4.+&#39;</pre><p><br/></p><p><strong>#添加mongodb配置文件applicationContext-mongodb.xml,配置文件内容如下：</strong></p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;beans&nbsp;xmlns=&quot;http://www.springframework.org/schema/beans&quot;\nxmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&nbsp;xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;\nxmlns:context=&quot;http://www.springframework.org/schema/context&quot;\nxmlns:mongo=&quot;http://www.springframework.org/schema/data/mongo&quot;\nxsi:schemaLocation=&quot;\nhttp://www.springframework.org/schema/beans&nbsp;http://www.springframework.org/schema/beans/spring-beans-4.1.xsd\nhttp://www.springframework.org/schema/aop&nbsp;http://www.springframework.org/schema/aop/spring-aop-4.0.xsd\nhttp://www.springframework.org/schema/context&nbsp;http://www.springframework.org/schema/context/spring-context-4.0.xsd\nhttp://www.springframework.org/schema/data/mongo&nbsp;http://www.springframework.org/schema/data/mongo/spring-mongo-1.8.xsd&quot;&nbsp;\ndefault-lazy-init=&quot;false&quot;&gt;\n&lt;description&gt;applicationContext&lt;/description&gt;\n\n&lt;mongo:mongo&nbsp;host=&quot;${mongo.host}&quot;&nbsp;port=&quot;${mongo.port}&quot;&gt;\n&lt;mongo:options&nbsp;connections-per-host=&quot;${mongo.connectionsPerHost}&quot;\nthreads-allowed-to-block-for-connection-multiplier=&quot;${mongo.threadsAllowedToBlockForConnectionMultiplier}&quot;\nconnect-timeout=&quot;${mongo.connectTimeout}&quot;&nbsp;max-wait-time=&quot;${mongo.maxWaitTime}&quot;\nauto-connect-retry=&quot;${mongo.autoConnectRetry}&quot;&nbsp;socket-keep-alive=&quot;${mongo.socketKeepAlive}&quot;\nsocket-timeout=&quot;${mongo.socketTimeout}&quot;&nbsp;slave-ok=&quot;${mongo.slaveOk}&quot;\nwrite-number=&quot;1&quot;&nbsp;write-timeout=&quot;0&quot;&nbsp;write-fsync=&quot;true&quot;&nbsp;/&gt;\n&lt;/mongo:mongo&gt;\n\n&lt;!--&nbsp;Factory&nbsp;bean&nbsp;that&nbsp;creates&nbsp;the&nbsp;Mongo&nbsp;instance&nbsp;--&gt;\n&lt;mongo:db-factory&nbsp;dbname=&quot;${mongo.databaseName}&quot;&nbsp;mongo-ref=&quot;mongo&quot;&nbsp;username=&quot;${mongo.username}&quot;&nbsp;password=&quot;${mongo.password}&quot;&nbsp;/&gt;\n\n&lt;bean&nbsp;id=&quot;mongoTemplate&quot;&nbsp;class=&quot;org.springframework.data.mongodb.core.MongoTemplate&quot;&gt;\n&lt;constructor-arg&nbsp;name=&quot;mongoDbFactory&quot;&nbsp;ref=&quot;mongoDbFactory&quot;&nbsp;/&gt;\n&lt;/bean&gt;\n\n&lt;mongo:repositories&nbsp;base-package=&quot;cn.imethan&quot;&nbsp;mongo-template-ref=&quot;mongoTemplate&quot;\nbase-class=&quot;cn.imethan.common.mongodb.BaseRepositoryImpl&quot;&nbsp;/&gt;\n\n&lt;!--&nbsp;Use&nbsp;this&nbsp;post&nbsp;processor&nbsp;to&nbsp;translate&nbsp;any&nbsp;MongoExceptions&nbsp;thrown&nbsp;in&nbsp;@Repository&nbsp;annotated&nbsp;classes&nbsp;--&gt;\n&lt;bean&nbsp;class=&quot;org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor&quot;&nbsp;/&gt;\n&lt;!--&nbsp;Enabling&nbsp;Spring&nbsp;Data&nbsp;web&nbsp;support&nbsp;in&nbsp;XML&nbsp;--&gt;\n&lt;bean&nbsp;class=&quot;org.springframework.data.web.config.SpringDataWebConfiguration&quot;&nbsp;/&gt;\n&lt;/beans&gt;</pre><p><br/></p><p><strong>#添加属性配置文件mongo.properties，配置文件内容如下：</strong></p><pre class=\"brush:xml;toolbar:false\">#local&nbsp;mongo&nbsp;db&nbsp;\nmongo.host=127.0.0.1\nmongo.port=27017\nmongo.username=\nmongo.password=\nmongo.databaseName=test\n\nmongo.connectionsPerHost=8\nmongo.threadsAllowedToBlockForConnectionMultiplier=4\nmongo.connectTimeout=1000\nmongo.maxWaitTime=1500\nmongo.autoConnectRetry=true\nmongo.socketKeepAlive=true\nmongo.socketTimeout=1500\nmongo.slaveOk=true</pre><p><br/></p><p><strong>#增加通用基础Repository接口BaseRepository和<span style=\"line-height: 22.8571px;\">Repository</span>接口实现类BaseRepositoryImpl</strong></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;BaseRepository.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年9月30日下午6:06:15\n&nbsp;*/\n@NoRepositoryBean\npublic&nbsp;interface&nbsp;BaseRepository&lt;T,&nbsp;ID&nbsp;extends&nbsp;Serializable&gt;&nbsp;extends&nbsp;MongoRepository&lt;T,&nbsp;ID&gt;&nbsp;{\n/**\n*&nbsp;Get&nbsp;{@link&nbsp;MongoOperations}.\n*&nbsp;@return\n*\n*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n*&nbsp;@datetime&nbsp;2015年10月1日上午5:38:14\n*/\npublic&nbsp;MongoOperations&nbsp;getMongoOperations();\n/**\n*&nbsp;Get&nbsp;{@link&nbsp;MongoEntityInformation}.\n*&nbsp;@return\n*\n*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n*&nbsp;@datetime&nbsp;2015年10月1日上午5:39:49\n*/\npublic&nbsp;MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;getMongoEntityInformation();\n}</pre><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;BaseRepositoryImpl.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年9月30日下午6:08:09\n&nbsp;*/\npublic&nbsp;class&nbsp;BaseRepositoryImpl&lt;T,&nbsp;ID&nbsp;extends&nbsp;Serializable&gt;&nbsp;extends&nbsp;SimpleMongoRepository&lt;T,&nbsp;ID&gt;implements&nbsp;BaseRepository&lt;T,&nbsp;ID&gt;&nbsp;{\n\nprivate&nbsp;MongoOperations&nbsp;mongoOperations;\nprivate&nbsp;MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;metadata;\n\npublic&nbsp;BaseRepositoryImpl(MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;metadata,&nbsp;MongoOperations&nbsp;mongoOperations)&nbsp;{\nsuper(metadata,&nbsp;mongoOperations);\nthis.mongoOperations&nbsp;=&nbsp;mongoOperations;\nthis.metadata&nbsp;=&nbsp;metadata;\n}\n\n@Override\npublic&nbsp;MongoOperations&nbsp;getMongoOperations()&nbsp;{\nreturn&nbsp;mongoOperations;\n}\n\n@Override\npublic&nbsp;MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;getMongoEntityInformation()&nbsp;{\nreturn&nbsp;metadata;\n}\n}</pre><p><br/></p><p><strong>#以上基础配置完成，以下开始测试</strong></p><p><strong>#添加自定义<span style=\"line-height: 22.8571px;\">Repository接口</span></strong><br/></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;ChannelRepository.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@time&nbsp;2014年3月2日下午4:44:45\n&nbsp;*/\n@Repository\npublic&nbsp;interface&nbsp;ChannelRepository&nbsp;extends&nbsp;MongoRepository&lt;Channel,&nbsp;String&gt;,\nChannelRepositoryCustom&lt;Channel,&nbsp;String&gt;,&nbsp;BaseRepository&lt;Channel,&nbsp;String&gt;&nbsp;{\n/**\n*&nbsp;@see&nbsp;http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/\n*\n*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n*&nbsp;@datetime&nbsp;2015年10月1日上午5:21:48\n*/\nLong&nbsp;countByTitle(String&nbsp;title);\nLong&nbsp;deleteByTitle(String&nbsp;title);\n\nList&lt;Channel&gt;&nbsp;removeByTitle(String&nbsp;title);\nList&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title);\nList&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Sort&nbsp;sort);\n\nPage&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\n//Slice&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\n//List&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\nList&lt;Channel&gt;&nbsp;findTop3ByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\nList&lt;Channel&gt;&nbsp;findFirst10ByTitle(String&nbsp;title,&nbsp;Sort&nbsp;sort);\n\n\nList&lt;Channel&gt;&nbsp;readAllByTitleNotNull();\n}</pre><p><br/></p><p><strong># Channel类：</strong></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;Channel.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@time&nbsp;2014年3月2日下午4:44:32\n&nbsp;*/\n@Document\npublic&nbsp;class&nbsp;Channel&nbsp;extends&nbsp;BaseDocument&nbsp;implements&nbsp;Serializable{\n\nprivate&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;-3919470868083141326L;\nprivate&nbsp;String&nbsp;title;//标题\nprivate&nbsp;String&nbsp;describe;//描述\n\npublic&nbsp;String&nbsp;getTitle()&nbsp;{\nreturn&nbsp;title;\n}\npublic&nbsp;void&nbsp;setTitle(String&nbsp;title)&nbsp;{\nthis.title&nbsp;=&nbsp;title;\n}\npublic&nbsp;String&nbsp;getDescribe()&nbsp;{\nreturn&nbsp;describe;\n}\npublic&nbsp;void&nbsp;setDescribe(String&nbsp;describe)&nbsp;{\nthis.describe&nbsp;=&nbsp;describe;\n}\n}</pre><p><br/></p><p><strong>#添加单元测试类ChannelRepositoryTest，其中<span style=\"line-height: 22.8571px;\">applicationContext.xml为<span style=\"font-weight: 700; line-height: 22.8571px;\">Spring Framework的配置文件</span></span></strong></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;ChannelRepositoryTest.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@time&nbsp;2014年3月12日下午2:39:27\n&nbsp;*/\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations&nbsp;=&nbsp;{&quot;classpath:/main/applicationContext.xml&quot;,\n&quot;classpath*:/mongodb/applicationContext-mongodb.xml&quot;\n})\npublic&nbsp;class&nbsp;ChannelRepositoryTest&nbsp;{\n@Autowired\nprivate&nbsp;ChannelRepository&nbsp;channelRepository;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Test\npublic&nbsp;void&nbsp;testQuery(){\nString&nbsp;name&nbsp;=&nbsp;channelRepository.getDbName();\nSystem.out.println(&quot;name:&quot;+name);\nPageable&nbsp;&nbsp;pageable&nbsp;&nbsp;=&nbsp;new&nbsp;PageRequest(0,10,Direction.DESC,&quot;createTime&quot;);\nString&nbsp;title&nbsp;=&nbsp;&quot;标题1&quot;;\nlong&nbsp;count&nbsp;=&nbsp;channelRepository.countByTitle(title);\nSystem.out.println(&quot;count:&quot;+count);\nList&lt;Channel&gt;&nbsp;list&nbsp;=&nbsp;channelRepository.findByTitle(title);\nSystem.out.println(&quot;list:&quot;+list);\nList&lt;Channel&gt;&nbsp;list1&nbsp;=&nbsp;channelRepository.findTop3ByTitle(title,&nbsp;pageable);\nSystem.out.println(&quot;list1:&quot;+list1);\nList&lt;Channel&gt;&nbsp;list2&nbsp;=&nbsp;channelRepository.readAllByTitleNotNull();\nSystem.out.println(&quot;list2:&quot;+list2);\nMongoTemplate&nbsp;mongoTemplate&nbsp;=&nbsp;(MongoTemplate)&nbsp;channelRepository.getMongoOperations();\nList&lt;Channel&gt;&nbsp;list3&nbsp;=&nbsp;mongoTemplate.findAll(channelRepository.getMongoEntityInformation().getJavaType());\nSystem.out.println(&quot;list3:&quot;+list3);\nQuery&nbsp;query&nbsp;=&nbsp;new&nbsp;Query(Criteria.where(&quot;title&quot;).is(title));\nUpdate&nbsp;update&nbsp;=&nbsp;new&nbsp;Update().set(&quot;describe&quot;,&nbsp;&quot;随便更新点什么&quot;);\nChannel&nbsp;channel&nbsp;=&nbsp;mongoTemplate.findAndModify(query,&nbsp;update,&nbsp;Channel.class);\nSystem.out.println(&quot;channel:&quot;+channel);\n}\n}</pre><p><br/></p><p><br/></p><p>#参考文档</p><p><a href=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/\" target=\"_blank\" title=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/\">http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/</a></p><p><a href=\"http://docs.spring.io/spring/docs/4.1.7.RELEASE/spring-framework-reference/htmlsingle/\" target=\"_blank\" title=\"http://docs.spring.io/spring/docs/4.1.7.RELEASE/spring-framework-reference/htmlsingle/\">http://docs.spring.io/spring/docs/4.1.7.RELEASE/spring-framework-reference/htmlsingle/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "Spring Framework",
      "createAt": "2015/12/18 16:09:32",
      "updateAt": "2016/1/18 16:10:42"
    },
    {
      "title": "通过Spring Data MongoDB向mongoDB GridFs 存储图片",
      "content": "<p><strong>开篇说明</strong><br/></p><p>&nbsp;&nbsp;GridFS会将大文件对象分割成多个小的chunk(文件片段),一般为256k/个,每个chunk将作为mongodb的一个文档(document)被存储在chunks集合中..gridfs模块会为每个文件创建chunks和files信息.每个文件的实际内容被存在chunks(二进制数据)中,和文件有关的meta数据(filename,content_type,还有用户自定义的属性)将会被存在files集合中.files集合中的文档就是BSON格式,可以使用mongodb的索引等等特性。</p><p><span style=\"font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;对于GridFS文件的web访问方式,大家可以搜索一下Gridfs + nginx,既可获取相应的信息..</span></p><p><span style=\"font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; background-color: rgb(255, 255, 255);\"><br/></span></p><p><strong>具体步骤</strong></p><p>1、在applicationContext-mongodb.xml配置文件中添加GridFsTemplate配置：</p><pre class=\"brush:xml;toolbar:false\">\t&lt;!--&nbsp;GridFsTemplate&nbsp;--&gt;\n\t&lt;mongo:mapping-converter&nbsp;id=&quot;converter&quot;&nbsp;/&gt;\n\t&lt;bean&nbsp;class=&quot;org.springframework.data.mongodb.gridfs.GridFsTemplate&quot;&gt;\n\t&nbsp;&nbsp;&nbsp;&nbsp;&lt;constructor-arg&nbsp;ref=&quot;mongoDbFactory&quot;&nbsp;/&gt;\n\t&nbsp;&nbsp;&nbsp;&nbsp;&lt;constructor-arg&nbsp;ref=&quot;converter&quot;&nbsp;/&gt;\n\t&nbsp;&nbsp;&nbsp;&nbsp;&lt;constructor-arg&nbsp;value=&quot;imethan_sys_fs&quot;&nbsp;/&gt;&lt;!--&nbsp;指定GridFS&nbsp;Collections名称&nbsp;--&gt;\n\t&lt;/bean&gt;</pre><p><br/></p><p>2、创建文件存取测试客户端，代码如下：</p><pre class=\"brush:java;toolbar:false\">package&nbsp;cn.imethan.mongodb;\n\nimport&nbsp;java.io.FileInputStream;\nimport&nbsp;java.io.FileNotFoundException;\nimport&nbsp;java.io.IOException;\nimport&nbsp;java.io.InputStream;\nimport&nbsp;java.util.List;\n\nimport&nbsp;org.junit.Test;\nimport&nbsp;org.junit.runner.RunWith;\nimport&nbsp;org.springframework.beans.factory.annotation.Autowired;\nimport&nbsp;org.springframework.data.mongodb.core.query.Criteria;\nimport&nbsp;org.springframework.data.mongodb.core.query.Query;\nimport&nbsp;org.springframework.data.mongodb.gridfs.GridFsOperations;\nimport&nbsp;org.springframework.test.context.ContextConfiguration;\nimport&nbsp;org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\n\nimport&nbsp;com.mongodb.BasicDBObject;\nimport&nbsp;com.mongodb.DBObject;\nimport&nbsp;com.mongodb.gridfs.GridFSDBFile;\nimport&nbsp;com.mongodb.gridfs.GridFSFile;\n\n/**\n&nbsp;*&nbsp;GridFsClient.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2016年1月18日下午3:03:02\n&nbsp;*/\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations&nbsp;=&nbsp;{&nbsp;&quot;classpath:/main/applicationContext.xml&quot;,&nbsp;&quot;classpath:/mongodb/applicationContext-mongodb.xml&quot;&nbsp;})\npublic&nbsp;class&nbsp;GridFsClient&nbsp;{\n\t\n\t@Autowired\n\tprivate&nbsp;GridFsOperations&nbsp;gridFsOperations;\n\t\n\t/**\n\t&nbsp;*&nbsp;保存测试\n\t&nbsp;*&nbsp;\n\t&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n\t&nbsp;*&nbsp;@datetime&nbsp;2016年1月18日下午3:51:28\n\t&nbsp;*/\n\t@Test\n\tpublic&nbsp;void&nbsp;storeFileToGridFs()&nbsp;{\n\t\tDBObject&nbsp;metaData&nbsp;=&nbsp;new&nbsp;BasicDBObject();\n\t\tmetaData.put(&quot;extra1&quot;,&nbsp;&quot;anything&nbsp;1&quot;);\n\t\tmetaData.put(&quot;extra2&quot;,&nbsp;&quot;anything&nbsp;2&quot;);\n\t\tInputStream&nbsp;inputStream&nbsp;=&nbsp;null;\n\t\ttry&nbsp;{\n\t\t\tinputStream&nbsp;=&nbsp;new&nbsp;FileInputStream(&quot;C:/Users/ETHAN/Pictures/e.png&quot;);\n\t\t\tGridFSFile&nbsp;gridFSFile&nbsp;=&nbsp;gridFsOperations.store(inputStream,&nbsp;&quot;e.png&quot;,&nbsp;&quot;image/png&quot;,&nbsp;metaData);\n\t\t\tSystem.out.println(&quot;gridFSFile:&quot;+gridFSFile.toString());\n\t\t}&nbsp;catch&nbsp;(FileNotFoundException&nbsp;e)&nbsp;{\n\t\t\te.printStackTrace();\n\t\t}&nbsp;finally&nbsp;{\n\t\t\tif&nbsp;(inputStream&nbsp;!=&nbsp;null)&nbsp;{\n\t\t\t\ttry&nbsp;{\n\t\t\t\t\tinputStream.close();\n\t\t\t\t}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(&quot;Done&quot;);\n\t}\n\t\n\t/**\n\t&nbsp;*&nbsp;读取测试\n\t&nbsp;*&nbsp;\n\t&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n\t&nbsp;*&nbsp;@datetime&nbsp;2016年1月18日下午3:51:28\n\t&nbsp;*/\n\t@Test\n\tpublic&nbsp;void&nbsp;findFilesInGridFs()&nbsp;{\n\t\tList&lt;GridFSDBFile&gt;&nbsp;result&nbsp;=&nbsp;gridFsOperations.find(new&nbsp;Query().addCriteria(Criteria.where(&quot;filename&quot;).is(&quot;e.png&quot;)));\n\t\tfor&nbsp;(GridFSDBFile&nbsp;file&nbsp;:&nbsp;result)&nbsp;{\n\t\t\ttry&nbsp;{\n\t\t\t\tSystem.out.println(file.getFilename());\n\t\t\t\tSystem.out.println(file.getContentType());\n\t\t\t\t//save&nbsp;as&nbsp;another&nbsp;image\n\t\t\t\tfile.writeTo(&quot;C:/Users/ETHAN/Pictures/e1.png&quot;);\n\t\t\t}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(&quot;Done&quot;);\n\t}\n}</pre><p><br/></p><p>3、登录mongoDB查看结果</p><p>db.getCollection(&#39;imethan_sys_file.files&#39;).find({})</p><pre class=\"brush:xml;toolbar:false\">/*&nbsp;1&nbsp;*/\n{\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;_id&quot;&nbsp;:&nbsp;ObjectId(&quot;569c9831c6a346b44944e6e8&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;chunkSize&quot;&nbsp;:&nbsp;NumberLong(261120),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;length&quot;&nbsp;:&nbsp;NumberLong(3327),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;md5&quot;&nbsp;:&nbsp;&quot;879a908fd59d7419b42d43e389886a0b&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;filename&quot;&nbsp;:&nbsp;&quot;e.png&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;contentType&quot;&nbsp;:&nbsp;&quot;image/png&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;uploadDate&quot;&nbsp;:&nbsp;ISODate(&quot;2016-01-18T07:45:53.828Z&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;aliases&quot;&nbsp;:&nbsp;null,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;metadata&quot;&nbsp;:&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;extra1&quot;&nbsp;:&nbsp;&quot;anything&nbsp;1&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;extra2&quot;&nbsp;:&nbsp;&quot;anything&nbsp;2&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p><br/></p><p>db.getCollection(&#39;imethan_sys_file.chunks&#39;).find({})</p><pre class=\"brush:xml;toolbar:false\">/*&nbsp;1&nbsp;*/\n{\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;_id&quot;&nbsp;:&nbsp;ObjectId(&quot;569c9831c6a346b44944e6e9&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;files_id&quot;&nbsp;:&nbsp;ObjectId(&quot;569c9831c6a346b44944e6e8&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;n&quot;&nbsp;:&nbsp;0,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;data&quot;&nbsp;:&nbsp;{&nbsp;&quot;$binary&quot;&nbsp;:&nbsp;&quot;iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAipJREFUeNrs3T9LHEEcxvHnt3/ucmoai5CkFCGNYCH4BmySKm0qy7R5HemSMkWaEF9ASJE3IIiIyCFY2SmJQVAMMR53N7Np0gXB3dvxZve+T7+w87mZ3wwzw62tfShE7pYEArDAAgsssMCCACywwAILLLAgAAsssBqUrOwDg7Fcw7cLU9ODLDzWyGtzVcuLKhrrZabjC20dKk8CYzmvjSWtPWl2z9r/oU/9KlhJhWHY9FRuAgUeLLDAmkK6WcUHs9Bvdv5H/TOl0fwoienoXKlFidX/qddf1cvjWpR20iixUlMvVy9rw/ilwIMFFlhggUXAAgsssMACi4AFFlhgNSnBN+Wc1/UoihPsXi6LHOvxgl4+q7iNW2NGTrunGjqZRYy18kjvn0+/Ww2dXnzWzVjZBFizUrMGY01eCSjwYIEF1j2lluk4+Gx4PdLZ70kXODW8xlC+iH6dtfddb75N/0S6kJyf9MpF8Eb4QkNX8SJGzRXHoh+GJiVWw4tS4MECi4AFFlhggQUWAQsssMACCywCVrnM0E7p/0mt3EZzcKz5jpYXK/6PQtCYdDXQ5aDELm7wRqw/1ZdXkQ6rjwd6t6OH3WiwEpv+FZpbG1+yYs90gS97a4zZEKxIsNpxAvhvQizZltIFfuzlvIpWSDkfEqub6u225vJWdCvp4kbznWBYZjr5Jd+WbxNkoVfw+QxPCcyGYIEFFlhgEbDAAgsssMAiYIEFFlhNyt8BAPkOZG4vtuN7AAAAAElFTkSuQmCC&quot;,&nbsp;&quot;$type&quot;&nbsp;:&nbsp;&quot;00&quot;&nbsp;}\n}</pre><p><br/></p><p><strong>参考文档</strong><br/></p><p><a href=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.2.RELEASE/reference/html/#gridfs\" target=\"_blank\" textvalue=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.2.RELEASE/reference/html/#gridfs\"><strong>http://docs.spring.io/spring-data/data-mongo/docs/1.8.2.RELEASE/reference/html/#gridfs</strong></a></p><p><a href=\"http://www.mkyong.com/mongodb/spring-data-mongodb-save-binary-file-gridfs-example/\" target=\"_blank\" textvalue=\"http://www.mkyong.com/mongodb/spring-data-mongodb-save-binary-file-gridfs-example/\">http://www.mkyong.com/mongodb/spring-data-mongodb-save-binary-file-gridfs-example/</a><br/></p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "Spring Framework",
      "createAt": "2016/1/18 15:27:46",
      "updateAt": "2016/1/18 16:28:38"
    },
    {
      "title": "使用Spring boot进行微服务应用开发",
      "content": "<p>参考文档</p><p><a href=\"http://www.infoq.com/cn/articles/microframeworks1-spring-boot\" target=\"_blank\" textvalue=\"http://www.infoq.com/cn/articles/microframeworks1-spring-boot\">http://www.infoq.com/cn/articles/microframeworks1-spring-boot</a> </p><p><br/></p>",
      "show": "0",
      "channel": "Spring专题",
      "tag": "Spring Framework",
      "createAt": "2016/1/22 11:21:54",
      "updateAt": "2016/1/22 11:21:59"
    },
    {
      "title": "Spring security 3中的10个典型用法小结",
      "content": "<p>Spring security 3中的10个典型用法小结</p><p>参考文档</p><p><a title=\"http://jackyrong.iteye.com/blog/1748493\" target=\"_blank\" href=\"http://jackyrong.iteye.com/blog/1748493\">http://jackyrong.iteye.com/blog/1748493</a></p><p><a href=\"http://stevex.blog.51cto.com/4300375/1358753\" title=\"http://stevex.blog.51cto.com/4300375/1358753\" target=\"_blank\">http://stevex.blog.51cto.com/4300375/1358753</a></p><p><a href=\"http://www.mossle.com/docs/auth/html/ch114-openid.html\" title=\"http://www.mossle.com/docs/auth/html/ch114-openid.html\" target=\"_blank\">http://www.mossle.com/docs/auth/html/ch114-openid.html</a></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Security",
      "createAt": "2015/12/18 17:36:57",
      "updateAt": "2015/12/18 17:36:57"
    },
    {
      "title": "Spring Security TokenBasedRememberMeServices的cookie加密",
      "content": "<p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * Calculates the digital signature to be put in the cookie. Default value is MD5</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * (&quot;username:tokenExpiryTime:password:key&quot;)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>protected String makeTokenSignature(long tokenExpiryTime, String username,</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>String password) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String data = username + &quot;:&quot; + tokenExpiryTime + &quot;:&quot; + password + &quot;:&quot; + getKey();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageDigest digest;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>digest = MessageDigest.getInstance(&quot;MD5&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>catch (NoSuchAlgorithmException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>throw new IllegalStateException(&quot;No MD5 algorithm available!&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return new String(Hex.encode(digest.digest(data.getBytes())));</p><p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>}</p><p><br/></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Security",
      "createAt": "2015/12/18 17:38:22",
      "updateAt": "2015/12/18 17:38:22"
    },
    {
      "title": "Spring security整合CAS单点登录，业务系统无法单点注销",
      "content": "<p>Spring security整合CAS单点登录，业务系统无法单点注销</p><p><br/></p><p>Spring Security启用session-fixation-protection，这会在登录时销毁用户的当前session，然后为用户创建一个新session，并将原有session中的所有属性都复制到新session中，导致单点注销时无法注销登录原有的session，从而导致单点注销失败。</p><p><br/></p><p>将session-fixation-protection禁用后，可以正常单点注销。</p><p><br/></p><p>在Spring security 4 中体现在:<br/></p><p>&lt;bean id=&quot;sessionAuthenticationStrategy&quot; class=&quot;org.springframework.security.web.authentication.session.CompositeSessionAuthenticationStrategy&quot;&gt;<br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;constructor-arg&gt;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;list&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;bean /&gt;<br/></p><p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &lt;/list&gt;<br/>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/constructor-arg&gt;</p><p>&lt;/bean&gt;<br/></p><p>bean类不要引入如下bean<br/></p><p>&lt;bean class=&quot;org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy&quot; /&gt;</p><p><br/></p><p><br/></p><p>参考文档</p><p><a title=\"http://blog.csdn.net/seng3018/article/details/7019872\" target=\"_blank\" href=\"http://blog.csdn.net/seng3018/article/details/7019872\">http://blog.csdn.net/seng3018/article/details/7019872</a></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring Security",
      "createAt": "2015/12/18 16:10:51",
      "updateAt": "2015/12/29 14:40:37"
    },
    {
      "title": "maven构建hadoop项目执行mapreduce运算",
      "content": "<p><strong><span style=\"font-size:16px\">maven构建hadoop项目执行mapreduce运算</span></strong></p><p><br/></p><p>未完待续~</p><p><br/></p><p># 遇到的问题<span style=\"line-height: 1.42857;\"></span></p><p><span style=\"white-space: nowrap;\">运行hadoop程序报错如下：</span></p><p><span style=\"white-space: nowrap;\">Exception in thread &quot;main&quot; org.apache.hadoop.ipc.RemoteException: Server IPC version 9 cannot communicate with client version 4</span></p><p><span style=\"white-space: nowrap;\">解决办法：将<span style=\"line-height: 22.8571px; white-space: normal;\">hadoop-core依赖版本更新为0.20.2</span></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;hadoop-core&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;0.20.2&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span><br/></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">Exception in thread &quot;main&quot; java.io.IOException: Cannot run program &quot;chmod&quot;: CreateProcess error=2</span></p><p><span style=\"white-space: nowrap;\">解决方法： 只需要把cygwin的bin目录加到windows的用户环境变量中就可以了，然后需要重启eclipse</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">安装cygwin：<a href=\"https://cygwin.com/install.html\" target=\"_blank\" title=\"https://cygwin.com/install.html\">https://cygwin.com/install.html</a></span></p><p><br/></p><p><strong>#参考文档</strong></p><p>http://v-lad.org/Tutorials/Hadoop/00%20-%20Intro.html</p>",
      "show": "0",
      "channel": "Hadoop笔记",
      "tag": "Hadoop",
      "createAt": "2015/12/18 16:04:42",
      "updateAt": "2015/12/18 16:04:42"
    },
    {
      "title": "Hadoop学习之配置单一节点(Setting up a Single Node Cluster)",
      "content": "<p><strong>Hadoop学习之配置单一节点(Setting up a Single Node Cluster)</strong></p><p>2014年就开始学习Hadoop，但也只是阅读资料，安装Hadoop实例以及集群，做下测试，并不系统；现在决定开始系统的将学习的过程记录下来，写成文档的形式；另外，我整理学习笔记不喜欢长篇大论的照抄别家的教程，我只写核心的内容、自己测试的过程和理解；借助的学习资料引用，放在文章结尾的“参考文档”处。</p><p><br/></p><p>百度百科，输入&quot;Hadoop&quot;关键字检索，由&quot;Hadoop&quot;词条开始入门学习Hadoop，Hadoop的研究学习由此处开始。</p><p><br/></p><p><strong>#准备工作</strong></p><p>hadoop同时支持linux和windows平台，这里在linux平台安装学习，准备一台Centos 6.7 Linux虚拟主机。</p><p>安装JDK1.7并且配置好环境变量</p><p>并且安装好ssh并且启动sshd</p><p><br/></p><p>#安装ssh和rsync</p><p>[root@centos1 ~]# yum install ssh</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 ~]# yum install <span style=\"line-height: 22.8571px; white-space: normal;\">rsync</span></span></p><p><br/></p><p>#安装配置</p><p>下载hadoop-2.7.1.tar.gz，<a href=\"http://hadoop.apache.org/releases.html\" target=\"_blank\" title=\"http://hadoop.apache.org/releases.html\">http://hadoop.apache.org/releases.html</a>，解压至/data/hadoop-2.7.1</p><p><br/></p><p>查看JAVA_HOME&nbsp;</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 ~]#&nbsp;</span>echo $JAVA_HOME</p><p>/usr/java/jdk1.7.0_79</p><p><br/></p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 ~]#&nbsp;</span><span style=\"line-height: 22.8571px; white-space: normal;\">cd /data/hadoop-2.7.1/etc/hadoop</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 ~]#&nbsp;</span>vi hadoop-env.sh&nbsp;</p><p># The java implementation to use.</p><p>#export JAVA_HOME=${JAVA_HOME}</p><p>export JAVA_HOME=/usr/java/jdk1.7.0_79</p><p><br/></p><p>#查看hadoop版本</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 ~]#&nbsp;</span><span style=\"white-space: normal; line-height: 22.8571px;\">cd /data/hadoop-2.7.1/bin</span></p><p>[root@centos1 bin]# ./hadoop version</p><p>Hadoop 2.7.1</p><p>Subversion https://git-wip-us.apache.org/repos/asf/hadoop.git -r 15ecc87ccf4a0228f35af08fc56de536e6ce657a</p><p>Compiled by jenkins on 2015-06-29T06:04Z</p><p>Compiled with protoc 2.5.0</p><p>From source with checksum fc0a1a23fc1868e4d5ee7fa2b28a58a</p><p>This command was run using /data/hadoop-2.7.1/share/hadoop/common/hadoop-common-2.7.1.jar</p><p><br/></p><p><strong>#Standalone Operation &nbsp;独立运行操作</strong></p><p><strong></strong></p><p>[root@centos1 hadoop-2.7.1]#&nbsp;mkdir input</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[ro</span><span style=\"line-height: 22.8571px; white-space: normal;\">ot</span>@centos1 hadoop-2.7.1]#&nbsp;cp etc/hadoop/*.xml input</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[ro</span><span style=\"white-space: normal; line-height: 22.8571px;\">ot</span><span style=\"line-height: 22.8571px; white-space: normal;\">@centos1 hadoop-2.7.1]#&nbsp;</span>bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar grep input output &#39;dfs[a-z.]+&#39;</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[ro</span><span style=\"white-space: normal; line-height: 22.8571px;\">ot</span><span style=\"line-height: 22.8571px; white-space: normal;\">@centos1 hadoop-2.7.1]#&nbsp;</span>cat output/*</p><p><br/></p><p><strong><span style=\"font-size:18px\">#Pseudo-Distributed Operation 伪分布式操作</span></strong></p><p>#配置核心site,指定master节点</p><p>[root@centos1 hadoop-2.7.1]# vi etc/hadoop/core-site.xml<strong>&nbsp;</strong><br/></p><p><strong></strong></p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;fs.defaultFS&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;hdfs://centos1:9000&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><br/></p><p>#编辑hdfs-site.xml文件，设置从节点的数量为1</p><p>[root@centos1 hadoop-2.7.1]# vi etc/hadoop/hdfs-site.xml</p><p><strong></strong></p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;dfs.replication&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;1&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><br/></p><p>#ssh无密码登录localhost<br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> ssh-keygen -t dsa -P &#39;&#39; -f ~/.ssh/id_dsa</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> export HADOOP\\_PREFIX=<span style=\"line-height: 22.8571px; white-space: normal;\">/data/hadoop-2.7.1</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 hadoop-2.7.1]#</span><span style=\"line-height: 22.8571px; white-space: normal;\">&nbsp;ssh localhost</span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p>#开始运行</p><p>1、Format the filesystem:格式化文件系统</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span>&nbsp;bin/hdfs namenode -format</p><p><br/></p><p>2、Start NameNode daemon and DataNode daemon:启动NameNode和DataNode&nbsp;<span id=\"_baidu_bookmark_end_52\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 0, 0); font-family: Verdana, Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15.6px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Verdana, Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15.6px; white-space: normal;\"><span id=\"_baidu_bookmark_end_50\" style=\"display: none; line-height: 0px;\">‍</span></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;sbin/start-dfs.sh</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span></p><p>[root@centos1 hadoop-2.7.1]# jps</p><p>53665 NameNode</p><p>54961 Jps</p><p>53783 DataNode</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">3、Browse the web interface for the NameNode; by default it is available at:通过WEB浏览NameNode信息</span></p><p>NameNode - http://localhost:50070/</p><p><br/></p><p>4、Make the HDFS directories required to execute MapReduce jobs：创建执行<span style=\"line-height: 22.8571px; white-space: normal;\">MapReduce 需要的HAFS目录</span></p><p><span style=\"line-height: 22.8571px;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span><span style=\"line-height: 1.42857;\">bin/hdfs dfs -mkdir /user</span><br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>bin/hdfs dfs -mkdir /user/root</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span><span style=\"line-height: 22.8571px; white-space: normal;\">bin/hdfs dfs -mkdir /user/root/input</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span>5、Copy the input files into the distributed filesystem:将<span style=\"line-height: 22.8571px; white-space: normal;\">etc/hadoop下文件copy到input目录</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>bin/hdfs dfs -put etc/hadoop input</span></p><p><br/></p><p>6、Run some of the examples provided:执行example</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span>bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar grep input output &#39;dfs[a-z.]+&#39;</p><p><br/></p><p>7、Examine the output files: Copy the output files from the distributed filesystem to the local filesystem and examine them:</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> bin/hdfs dfs -get output output</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> cat output/*</p><p><br/></p><p>8、When you’re done, stop the daemons with:执行完成后，关闭节点</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span>sbin/stop-dfs.sh</p><p><br/></p><p><strong>#YARN on a Single Node 独立节点中的YARN mapreduce框架</strong></p><p>1、Configure parameters as follows:配置参数</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>vi etc/hadoop/mapred-site.xml</p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;yarn&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>vi etc/hadoop/yarn-site.xml</p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><br/></p><p>2、Start ResourceManager daemon and NodeManager daemon:启动守护进程</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>sbin/start-yarn.sh</p><p>[root@centos1 hadoop-2.7.1]# jps</p><p>56479 Jps</p><p>56386 NodeManager</p><p>56170 ResourceManager</p><p><span style=\"white-space: nowrap; line-height: 1.42857;\"><br/></span></p><p><span style=\"white-space: nowrap; line-height: 1.42857;\">3、Browse the web interface for the ResourceManager; 通过WEB浏览资源管理信息</span></p><p><span style=\"white-space: nowrap;\">ResourceManager - http://localhost:8088/</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">4、Run a MapReduce job.该步骤在伪分布式操作中已经执行过了</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">5、When you’re done, stop the daemons with:关闭</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>$ sbin/stop-yarn.sh</span></p><p><br/></p><p>初步学习和测试Hadoop分布式文件系统到此处结束</p><p><br/></p><p><strong>#参考文档</strong></p><p><a title=\"http://hadoop.apache.org/\" href=\"http://hadoop.apache.org/\" target=\"_blank\">http://hadoop.apache.org/</a></p><p><a title=\"http://blog.fens.me/hadoop-family-roadmap/\" href=\"http://blog.fens.me/hadoop-family-roadmap/\" target=\"_blank\">http://blog.fens.me/hadoop-family-roadmap/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Hadoop笔记",
      "tag": "Hadoop",
      "createAt": "2015/12/18 17:26:03",
      "updateAt": "2015/12/18 17:26:03"
    },
    {
      "title": "Hadoop学习之配置多节点集群(Hadoop Cluster Setup)",
      "content": "<p><strong>Hadoop学习之配置多节点集群(Hadoop Cluster Setup)</strong></p><p><strong><br/></strong></p><p><strong>#多节点集群配置说明</strong></p><p>多节点集群配置是在伪分布式配置的基础上，将安装配置好的“hadoop-2.7.1”复制到其他节点虚拟机上，并且启动。</p><p>伪分布式部署配置详看：<span style=\"font-weight: 700; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px; white-space: normal;\"><a href=\"http://imethan.cn/blog/article/84\" target=\"_blank\" title=\"http://imethan.cn/blog/article/84\"><em>Hadoop学习之配置单一节点(Setting up a Single Node Cluster)</em></a></span></p><p><br/></p><p>虚拟主机：centos1、centos2;分别配置好hosts，使之centos1和centos2之间的ping测试能互通，并且开放对应防火墙端口，<span style=\"line-height: 1.42857;\">这里的测试配置，只提供一台<span style=\"line-height: 22.8571px; white-space: normal;\">slaver</span>节点，即将centos2作为slaver，centos1作为master；而正式生产环境至少需要2两个<span style=\"line-height: 22.8571px; white-space: normal;\">slaver，切记</span>。</span></p><p><span style=\"line-height: 1.42857;\"><br/></span></p><p><span style=\"line-height: 1.42857;\"><strong>#将centos1上安装配置好的hadoop安装包copy至centos2上</strong></span></p><p><span style=\"line-height: 1.42857;\">[root@centos1 data]# scp -r /data/<span style=\"line-height: 22.8571px; white-space: normal;\">hadoop-2.7.1 root@centos2:/data/</span></span></p><p><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><span style=\"line-height: 22.8571px;\"><strong>#分别启动centos1上的hadoop和centos2上的hadoop</strong></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]# sbin/start-dfs.sh</span></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]# jps</span></span></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></span></p><p>41291 DataNode</p><p>41611 Jps</p><p>41464 SecondaryNameNode</p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></span><br/></p><p><span style=\"line-height: 22.8571px;\">[root@centos2 hadoop-2.7.1]# sbin/start-dfs.sh</span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 hadoop-2.7.1]# jps</span></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p>41291 DataNode</p><p>41611 Jps</p><p>41464 SecondaryNameNode</p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span><strong>#查看节点情况</strong></p><p><small></small></p><table class=\"table\"><thead><tr><th>Node</th><th>Last contact</th><th>Admin State</th><th>Capacity</th><th>Used</th><th>Non DFS Used</th><th>Remaining</th><th>Blocks</th><th>Block pool used</th><th>Failed Volumes</th><th>Version</th></tr></thead><tbody><tr><td>centos1.imethan.cn:50010 (192.168.42.133:50010)</td><td>1</td><td>In Service</td><td>17.17 GB</td><td>576 KB</td><td>5.36 GB</td><td>11.81 GB</td><td>58</td><td>576 KB (0%)</td><td>0</td><td>2.7.1</td></tr><tr><td>centos2.imethan.cn:50010 (192.168.42.134:50010)</td><td>2</td><td>In Service</td><td>17.17 GB</td><td>28 KB</td><td>5.72 GB</td><td>11.45 GB</td><td>0</td><td>28 KB (0%)</td><td>0</td><td>2.7.1</td></tr></tbody></table><p></p><p><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p>至此，一个master和一个<span style=\"line-height: 22.8571px; white-space: normal;\">slaver的hadoop分布式部署配置完成。</span></p><p><br/></p><p><strong><br/></strong></p><p><strong></strong></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><span style=\"font-weight: 700;\">#参考文档</span></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><a href=\"http://imethan.cn/blog/article/84\" target=\"_blank\" title=\"http://imethan.cn/blog/article/84\">http://imethan.cn/blog/article/84</a></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><a title=\"http://hadoop.apache.org/\" href=\"http://hadoop.apache.org/\" target=\"_blank\">http://hadoop.apache.org/</a></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><a title=\"http://blog.fens.me/hadoop-family-roadmap/\" href=\"http://blog.fens.me/hadoop-family-roadmap/\" target=\"_blank\">http://blog.fens.me/hadoop-family-roadmap/</a></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><br/></p>",
      "show": "1",
      "channel": "Hadoop笔记",
      "tag": "Hadoop",
      "createAt": "2015/12/18 17:26:13",
      "updateAt": "2015/12/18 17:26:13"
    },
    {
      "title": "Hadoop家族体系介绍",
      "content": "<p>Hadoop家族体系介绍</p><p>参考文档</p><p><span style=\"color:#2a6496;font-family:Helvetica Neue, Helvetica, Arial, Hiragino Sans GB, Hiragino Sans GB W3, WenQuanYi Micro Hei, Microsoft YaHei UI, Microsoft YaHei, sans-serif\"><span style=\"font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);\"><span style=\"text-decoration:underline;\"><a href=\"http://blog.fens.me/hadoop-family-roadmap/\" target=\"_blank\" title=\"http://blog.fens.me/hadoop-family-roadmap/\">http://blog.fens.me/hadoop-family-roadmap/</a></span></span></span></p>",
      "show": "1",
      "channel": "Hadoop笔记",
      "tag": "Hadoop",
      "createAt": "2015/12/18 23:09:39",
      "updateAt": "2016/1/17 23:11:05"
    },
    {
      "title": "CentOS 6.7安装RabbitMQ消息中间件",
      "content": "<p><strong><span style=\"font-size:16px\">#RabbitMQ是基于<span style=\"line-height: 22.8571434020996px; white-space: normal;\">Erlang开发的，所以</span>首先安装Erlang环境</span></strong></p><p><span style=\"font-size:16px\">下载：<strong>erlang-17.4-1.el6.x86_64.rpm</strong> 下载地址：<a href=\"http://www.rabbitmq.com/releases/erlang/\" target=\"_blank\" title=\"http://www.rabbitmq.com/releases/erlang/\"><span style=\"font-size:16px\"><span style=\"font-size:12pxfont-size:12px\">http://www.rabbitmq.com/releases/erlang/</span></span></a></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#rpm安装erlang</span></p><p><span style=\"font-size:16px\">rpm -ivh&nbsp;erlang-17.4-1.el6.x86_64.rpm</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#安装RabbitMQ Server</span></strong></p><p><span style=\"font-size:16px\">下载：<span id=\"_baidu_bookmark_start_14\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_12\" style=\"display: none; line-height: 0px;\">‍</span><strong><a href=\"http://www.rabbitmq.com/releases/rabbitmq-server/v3.5.6/rabbitmq-server-3.5.6-1.noarch.rpm\">rabbitmq-server-3.5.6-1.noarch.rpm</a>&nbsp;</strong><span style=\"line-height: 1.42857143;\">下载地址：</span><a href=\"http://www.rabbitmq.com/install-rpm.html\" target=\"_blank\" title=\"http://www.rabbitmq.com/install-rpm.html\" style=\"line-height: 1.42857143; background-color: rgb(255, 255, 255);\"><span style=\"font-size:16px\"><span style=\"font-size:12pxfont-size:12px\">http://www.rabbitmq.com/install-rpm.html</span></span></a></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#rpm安装rabbitmq-server</span></p><p><span style=\"font-size:16px\">rpm -ivh rabbitmq-server-3.5.6-1.noarch.rpm</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#启动<span style=\"line-height: 22.8571434020996px; white-space: normal;\">rabbitmq-server</span></strong></span></p><p><span style=\"line-height: 22.8571434020996px; white-space: normal;font-size:16px\">/sbin/service rabbitmq-server start</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#设置开机启动</strong></span></p><p><span style=\"font-size:16px\">chkconfig rabbitmq-server on</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#开放防火墙<span style=\"line-height: 22.8571434020996px; white-space: normal;\">端口</span></strong></span></p><p xmlns=\"\" style=\"clear: left; color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\"><span style=\"font-size:16px\">SELinux and similar mechanisms may prevent RabbitMQ from binding to a port. When that happens, RabbitMQ will fail to start. Make sure the following ports can be opened:</span></p><ul style=\"margin-top: 10px; margin-right: 0px; margin-left: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\"><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">4369 (epmd), 25672 (Erlang distribution)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">5672, 5671 (AMQP 0-9-1 without and with TLS)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">15672 (if management plugin is enabled)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">61613, 61614 (if STOMP is enabled)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">1883, 8883 (if MQTT is enabled)</span></li></ul><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><br/></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><strong>#默认安装说明</strong></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-seriffont-size:16pxfont-size:16px\"><span style=\"line-height: 18px;\"></span></span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装日志路径：/var/log/rabbitmq</span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装路径：/usr/lib/rabbitmq</span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装配置文件存放路径：/etc/rabbitmq</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><strong>#默认访问用户和虚拟主机</strong></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\">默认安装的rabbitmq服务，默认拥有一个账号和密码都是“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">guest</span>”的用户，并且绑定到虚拟主机“/”，只能在本机（localhost）访问rabbitmq，正式发布时，建议删除“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">guest</span>”账号和虚拟主机“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">/</span>”</span></span></p><p><strong style=\"line-height: 1.42857143;\"><span style=\"font-size:16px\"><br/></span></strong></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\"><strong>#管理RabbitMQ节点</strong></span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">进入到bin目录:cd&nbsp;<span style=\"line-height: 22.8571434020996px;\">/usr/lib/rabbitmq/bin</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 22.8571434020996px;font-size:16px\">停止服务：./<span xmlns=\"http://www.w3.org/1999/xhtml\" class=\"code \" style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\">rabbitmqctl stop</span></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 22.8571434020996px;\"><span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;font-size:16px\">查看状态：&nbsp;<span style=\"line-height: 22.8571434020996px; white-space: normal;\">./</span><span xmlns=\"http://www.w3.org/1999/xhtml\" class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\">rabbitmqctl status</span></span></span></span></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace;\"><span style=\"line-height: 18px;font-size:16px\">更多<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px; white-space: normal;\">rabbitmqctl</span>命令：<a href=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\" target=\"_self\" title=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\"><span style=\"font-size:16px\">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html</span></a></span></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#查看日志</strong></span></p><p><span style=\"font-size:16px\">进入到日志目录：cd&nbsp;<span style=\"line-height: 22.8571434020996px;\">/var/log/rabbitmq</span></span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">浏览日志文件：ls</span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">rabbit@centos1.log &nbsp;rabbit@centos1-sasl.log &nbsp;startup_err &nbsp;startup_log</span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">查看日志文件：cat&nbsp;<span style=\"line-height: 18.5714282989502px; white-space: normal;\">rabbit@centos1.log</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><br/></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><strong>#开启UI管理界面插件“<span style=\"line-height: 18.5714282989502px; white-space: normal;\">Management Plugin</span>”</strong></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">cd /usr/lib/rabbitmq/bin</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">rabbitmq-plugins enable rabbitmq_management</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><br/></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">URL访问地址：http://server-name:15672</span></span></p><p><span style=\"line-height: 18.5714px;\"><br/></span></p><p><span style=\"line-height: 18.5714px;\"><strong>#创建管理员用户，负责整个MQ的运维</strong></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">rabbitmqctl add_user &nbsp;admin admin &nbsp;</span></span></p><p><span style=\"line-height: 1.42857143;font-size:16px\">rabbitmqctl set_user_tags admin administrator &nbsp;</span></p><p><span style=\"font-size:16px\">更多用户管理命令：<a href=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\" target=\"_self\" title=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\"><span style=\"font-size:16px\">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html</span></a></span></p><p><br/></p><p>创建好后，便可以用账号为admin，密码为admin登录<span style=\"line-height: 18.5714282989502px; white-space: normal;\">http://server-name:15672 进行MQ的维护</span></p><p><span style=\"line-height: 1.42857143;font-size:16px\"><br/></span></p><p><strong style=\"line-height: 1.42857143;\"><span style=\"font-size:16px\"><br/></span></strong></p><p><span style=\"font-size:16px\"><strong style=\"line-height: 1.42857143;\">#参考文档</strong><br/></span></p><p><span style=\"font-size:16px\"><a href=\"http://www.rabbitmq.com/\" target=\"_blank\" title=\"http://www.rabbitmq.com/\">http://www.rabbitmq.com/</a></span></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "RabbitMQ",
      "createAt": "2015/12/18 16:07:04",
      "updateAt": "2015/12/18 16:07:04"
    },
    {
      "title": "使用Spring AMQP进行RabbitMQ消息的发送和接收",
      "content": "<p>Spring Framework项目集成Spring AMQP</p><p><strong>#安装好RabbitMQ 3.5.6</strong></p><p>安装的介绍在这篇文章：<a href=\"http://imethan.cn/blog/article/78\" target=\"_blank\" title=\"http://imethan.cn/blog/article/78\">http://imethan.cn/blog/article/78</a></p><p><strong style=\"line-height: 1.42857;\"><br/></strong></p><p><strong style=\"line-height: 1.42857;\">#通过eclipse创建简单的maven项目</strong><br/></p><p><strong>#编辑pom.xml,指定编译器的版本</strong></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;build&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;plugins&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;plugin&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;version&gt;3.1&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;configuration&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t</span>&lt;source&gt;1.8&lt;/source&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t</span>&lt;target&gt;1.8&lt;/target&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t</span>&lt;encoding&gt;UTF-8&lt;/encoding&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;/configuration&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;/plugin&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/plugins&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/build&gt;</p><p><strong>#<span style=\"line-height: 22.8571px; white-space: normal;\">编辑pom.xml，</span>添加maven依赖</strong></p><p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>&lt;properties&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;spring-rabbit-version&gt;1.4.3.RELEASE&lt;/spring-rabbit-version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;rabbitmq-version&gt;3.5.0&lt;/rabbitmq-version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/properties&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;dependencies&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- rabbitmq begin --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;org.springframework.amqp&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;spring-rabbit&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;${spring-rabbit-version}&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;com.rabbitmq&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;amqp-client&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;${rabbitmq-version}&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- rabbitmq end --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;org.springframework&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;spring-test&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;4.1.7.RELEASE&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;scope&gt;test&lt;/scope&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;junit&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;junit&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;4.12&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;scope&gt;test&lt;/scope&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;groupId&gt;commons-logging&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;artifactId&gt;commons-logging&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;version&gt;1.2&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>&lt;/dependencies&gt;</p><p><br/></p><p><strong>#添加rabbitmq.properties文件</strong></p><p><strong></strong></p><p>#rabbitmq connection information</p><p>mq.host=192.168.42.133</p><p>mq.port=5673</p><p>mq.username=spring</p><p>mq.password=spring.com</p><p>mq.virtualhost=spring</p><p>mq.defaultqueue=defaultqueue</p><p><strong><br/></strong></p><p><strong>#添加Spring Rabbitmq配置文件“applicationContext-rabbitmq.xml”</strong></p><p><strong></strong></p><p><span style=\"white-space: nowrap;\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></p><p><span style=\"white-space: nowrap;\">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:rabbit=&quot;http://www.springframework.org/schema/rabbit&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xsi:schemaLocation=&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd&quot;&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>default-lazy-init=&quot;true&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;description&gt;Spring AMQP&lt;/description&gt;<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:annotation-config /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:component-scan base-package=&quot;cn.imethan&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:property-placeholder location=&quot;classpath:/rabbitmq/rabbitmq.properties&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 发送确认监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;messageConfirmCallback&quot; class=&quot;cn.imethan.rabbitmq.callback.MessageConfirmCallback&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 失败回调监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;messageReturnCallback&quot; class=&quot;cn.imethan.rabbitmq.callback.MessageReturnCallback&quot;/&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 连接工厂设置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;rabbitConnectionFactory&quot; class=&quot;org.springframework.amqp.rabbit.connection.CachingConnectionFactory&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;username&quot; value=&quot;${mq.username}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;password&quot; value=&quot;${mq.password}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;property name=&quot;virtualHost&quot; value=&quot;${mq.virtualhost}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;host&quot; value=&quot;${mq.host}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;port&quot; value=&quot;${mq.port}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;channelCacheSize&quot; value=&quot;25&quot;/&gt;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;publisherConfirms&quot; value=&quot;true&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;publisherReturns&quot; value=&quot;true&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;rabbitTemplate&quot; class=&quot;org.springframework.amqp.rabbit.core.RabbitTemplate&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;connectionFactory&quot; ref=&quot;rabbitConnectionFactory&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- 设置确认监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;confirmCallback&quot; ref=&quot;messageConfirmCallback&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- 如果mandatory设置为true，但是不能被路由，则由returnCallback监听获取消息 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;mandatory&quot; value=&quot;true&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- 设置失败监听 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;returnCallback&quot; ref=&quot;messageReturnCallback&quot;/&gt;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;exchange&quot; value=&quot;remoting.exchange&quot;/&gt;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;&lt;property name=&quot;routingKey&quot; value=&quot;${mq.defaultqueue}&quot;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 队列创建，并且绑定 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:admin id=&quot;admin&quot; connection-factory=&quot;rabbitConnectionFactory&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:queue name=&quot;${mq.defaultqueue}&quot; declared-by=&quot;admin&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 创建交换机并且绑定 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:direct-exchange name=&quot;remoting.exchange&quot; declared-by=&quot;admin&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;rabbit:bindings&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;rabbit:binding queue=&quot;${mq.defaultqueue}&quot; key=&quot;${mq.defaultqueue}&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/rabbit:bindings&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/rabbit:direct-exchange&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 监听设置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;rabbit:listener-container connection-factory=&quot;rabbitConnectionFactory&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;rabbit:listener ref=&quot;awareRecviveListener&quot; method=&quot;listen&quot; queue-names=&quot;${mq.defaultqueue}&quot; &nbsp;/&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/rabbit:listener-container&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 接收监听器 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;awareRecviveListener&quot; class=&quot;cn.imethan.rabbitmq.listener.AwareRecviveListener&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;simpleRecviveListener&quot; class=&quot;cn.imethan.rabbitmq.listener.SimpleRecviveListener&quot; /&gt;</p><p><span style=\"white-space: nowrap;\">&lt;/beans&gt;</span></p><p><strong><br/></strong></p><p><strong><br/></strong></p><p><strong>#创建几个重要的类</strong></p><p><strong><span style=\"line-height: 22.8571px;\">MessageConfirmCallback：</span></strong></p><p><strong></strong></p><p><span style=\"white-space: nowrap;\">public class MessageConfirmCallback implements ConfirmCallback {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void confirm(CorrelationData correlationData, boolean ack,String cause) {<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageConfirmCallback correlationData:&quot;+correlationData);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageConfirmCallback &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ack:&quot;+ack);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageConfirmCallback &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cause:&quot;+cause);<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>if(ack){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>System.out.println(&quot;[RabbitMQ] send message to rabbitmq success !&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}else{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>System.out.println(&quot;[RabbitMQ] send message to rabbitmq fail !&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><strong>MessageReturnCallback ：</strong></span></span></p><p><span style=\"white-space: nowrap;\">public class MessageReturnCallback implements ReturnCallback {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void returnedMessage(Message message, int replyCode,</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>String replyText, String exchange, String routingKey) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback message:&quot;+message);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback replyCode:&quot;+replyCode);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback replyText:&quot;+replyText);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback exchange:&quot;+exchange);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] MessageReturnCallback routingKey:&quot;+routingKey);<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><strong>AwareRecviveListener：</strong></span></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span style=\"white-space: nowrap;\">@Service</span></p><p><span style=\"white-space: nowrap;\">public class AwareRecviveListener implements ChannelAwareMessageListener &nbsp;{</span><span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private RabbitTemplate rabbitTemplate;<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void onMessage(Message message, Channel channel) throws Exception {<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageProperties messageProperties = message.getMessageProperties() ;<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String encoding = messageProperties.getContentEncoding();//编码</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String content = new String(message.getBody(),encoding);//内容<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String appId = messageProperties.getAppId();//发送时设置的发送方标示appid<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] recv message -appId:&quot;+appId +&quot; -message:&quot;+content);<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String vhost = rabbitTemplate.getConnectionFactory().getVirtualHost();//当前虚拟主机名称</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String consumerQueue = messageProperties.getConsumerQueue();//当前接收的队列名称<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//业务处理</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.handle(content);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 业务处理</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:15:03</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private void handle(String message) {<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><strong>SimpleRecviveListener：</strong></span></span></p><p><span style=\"white-space: nowrap;\">@Service</span></p><p><span style=\"white-space: nowrap;\">public class SimpleRecviveListener {</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 消息监听</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:14:36</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void listen(String message) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.handle(message);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 消息监听</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws UnsupportedEncodingException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:14:45</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void listen(byte[] message) throws UnsupportedEncodingException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.handle(new String(message, &quot;UTF-8&quot;));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 业务处理</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param message 消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月9日 下午5:15:03</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private void handle(String message) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;[RabbitMQ] recv message:&quot;+message);</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>RabbitMqSender：</strong></span></p><p><span style=\"white-space: nowrap;\"></span></p><p>@Service</p><p>public class RabbitMqSender {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private RabbitTemplate rabbitTemplate;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param queue</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param content</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年11月9日 下午8:24:00</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void sendMessage(String queue,String content){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>String routingKey = queue;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>rabbitTemplate.setQueue(queue);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>rabbitTemplate.setRoutingKey(routingKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>rabbitTemplate.send(this.generateMessage(content,queue));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (AmqpException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 生成消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param content 消息内容</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param queueName 队列名称</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月6日 下午4:20:50</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private Message generateMessage(String content,String queueName){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String appId = rabbitTemplate.getConnectionFactory().getVirtualHost()+&quot;/&quot;+queueName;//将虚拟主机和队列名称设置为appId<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageProperties props = MessagePropertiesBuilder.newInstance()</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setContentType(MessageProperties.CONTENT_TYPE_TEXT_PLAIN)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setContentEncoding(&quot;UTF-8&quot;)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setTimestamp(new Date()).setHeader(&quot;&quot;, &quot;&quot;)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.setAppId(appId)//设置发送中心系统识别</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>.build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Message message = MessageBuilder.withBody(content.getBytes())</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>.andProperties(props)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>.build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return message;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p>}</p><p><span style=\"white-space: nowrap;\"><br/></span><strong>#到此处，所有的准备工作都做好了，开始测试，测试类如下：</strong></p><p><span style=\"line-height: 22.8571px;\"><strong>RabbitMqTest：</strong></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span style=\"white-space: nowrap;\">@RunWith(SpringJUnit4ClassRunner.class)</span></p><p><span style=\"white-space: nowrap;\">@ContextConfiguration(locations={&quot;classpath:rabbitmq/applicationContext-rabbitmq.xml&quot;})&nbsp;</span></p><p><span style=\"white-space: nowrap;\">public class RabbitMqTest{ &nbsp;</span></p><p><span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private RabbitMqSender rabbitMqSender;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@BeforeClass</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static void initRabbitMq(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 测试向MQ发送消息</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @create-time 2015年5月6日 下午2:47:34</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Test</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void testSend(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>rabbitMqSender.sendMessage(&quot;defaultqueue&quot;, &quot;向RabbitMQ发送消息！！！&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@AfterClass</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static void testRecv(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}<span class=\"Apple-tab-span\" style=\"line-height: 1.42857; white-space: pre;\">\t</span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>源代码后续将和其他部分整理完整后，提交GitHub.</strong></span></p><p><br/></p><p><strong>#参考文档</strong></p><p><a title=\"http://projects.spring.io/spring-amqp/\" href=\"http://projects.spring.io/spring-amqp/\" target=\"_blank\">http://projects.spring.io/spring-amqp/</a></p><p><a title=\"http://docs.spring.io/spring-amqp/docs/1.5.1.RELEASE/reference/html/\" href=\"http://docs.spring.io/spring-amqp/docs/1.5.1.RELEASE/reference/html/\" target=\"_blank\">http://docs.spring.io/spring-amqp/docs/1.5.1.RELEASE/reference/html/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "RabbitMQ",
      "createAt": "2015/12/18 16:07:20",
      "updateAt": "2015/12/18 16:07:20"
    },
    {
      "title": "CentOS 6.7 配置文件的方式部署RabbitMQ消息中间件集群",
      "content": "<p>CentOS 6.7 配置文件的方式部署RabbitMQ消息中间件</p><p><strong>#准备工作</strong></p><p>分别在名为centos1、centos2的Centos 6.7 Linux上安装部署独立节点的RabbitMQ：<a href=\"http://imethan.cn/blog/article/78\" target=\"_blank\" title=\"http://imethan.cn/blog/article/78\">http://imethan.cn/blog/article/78</a></p><p><br/></p><p><strong>#安装完成后停止RabbitMQ<span style=\"line-height: 22.8571px; white-space: normal;\">节点</span>服务</strong></p><p>[root@centos1 bin]# rabbitmqctl stop</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]# rabbitmqctl stop</span></p><p><br/></p><p><strong>#配置文件方式部署说明</strong></p><p>默认安装部署的RabbitMQ并没有生成配置文件，采用的是运行时参数配置和策略（runtime parameters and policies）；自定义配置时，需要手动的创建配置文<span style=\"font-size:16px\">件<span id=\"_baidu_bookmark_start_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_7\" style=\"display: none; line-height: 0px;\">‍</span>:rabbitmq-env.conf（environment variables）、rabbitmq.config（a configuration file），创建的配置文件置于“/etc/rabbitmq”目录下。</span><span id=\"_baidu_bookmark_end_8\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; font-size: small; line-height: 18px;\"><span id=\"_baidu_bookmark_end_6\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#创建环境变量配置文件：<span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\">rabbitmq-env.conf（这步配置可以略过）</span></strong></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px;\">将节点名称更改为“imethan@centos1”</span></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p>vi /etc/rabbitmq/<span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\">rabbitmq-env.conf</span></p><p><span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\"></span></p><p>#example rabbitmq-env.conf file entries</p><p>#Rename the node</p><p>NODENAME=rabbit@centos1</p><p>#Config file location and new filename bunnies.config</p><p>#CONFIG_FILE=/etc/rabbitmq/testdir/bunnies</p><p><br/></p><p><strong>#创建配置文件：rabbitmq.config</strong></p><p>分别在centos1、centos2上创建如下配置文件：</p><p><span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\">vi /etc/rabbitmq/<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; font-size: small; line-height: 18px;\">rabbitmq.config</span></span></p><p><span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\"><br/></span></p><p>[</p><p>&nbsp; &nbsp; {mnesia, [{dump_log_write_threshold, 1000}]},</p><p>&nbsp; &nbsp; {rabbit, [{tcp_listeners, [5673]},{cluster_nodes,{[&#39;rabbit<span style=\"line-height: 22.8571px; white-space: normal;\">@centos1<span style=\"line-height: 22.8571px; white-space: normal;\">&#39;</span></span>,<span style=\"line-height: 22.8571px; white-space: normal;\">&#39;</span>rabbit@centos2<span style=\"line-height: 22.8571px; white-space: normal;\">&#39;</span>], disc}}]},</p><p>&nbsp; &nbsp; {rabbitmq_management, [{listener, [{port, 45672}]}]}</p><p>].</p><p><br/></p><p><strong>#创建完成后启动centos1上的RabbitMQ Master节点和重置centos2上的RabbitMQ&nbsp;Slave节点</strong></p><p><span style=\"line-height: 22.8571px;\">#在<span style=\"line-height: 22.8571px; white-space: normal;\">Master节点上执行</span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 bin]#&nbsp;rabbitmq-server -detached</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span></p><p><span style=\"white-space: nowrap;\">#在<span style=\"line-height: 22.8571px; white-space: normal;\">Slave节点上执行</span></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#&nbsp;</span>rabbitmqctl stop_app</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#&nbsp;</span>rabbitmqctl reset</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#</span> rabbitmqctl start_app</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>#确认集群配置是否成功</strong></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#</span> rabbitmqctl cluster_status</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span></p><p>Cluster status of node rabbit@centos2 ...</p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Name</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Erlang processes</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Memory</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Disk space</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Info</th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.134:45672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos1</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -118px 0px no-repeat rgb(152, 248, 152);\">20</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">176</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -109px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">13GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.134:45672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos2</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -118px 0px no-repeat rgb(152, 248, 152);\">20</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">175</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">12GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym></td></tr></tbody></table><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span><br/></p><p><br/></p><p><strong>#参考文档</strong></p><p><a href=\"http://www.rabbitmq.com/configure.html\" target=\"_blank\" title=\"http://www.rabbitmq.com/configure.html\">http://www.rabbitmq.com/configure.html</a></p><p><a href=\"http://jessesnet.com/development-notes/2015/rabbitmq-cluster/\" target=\"_blank\" title=\"http://jessesnet.com/development-notes/2015/rabbitmq-cluster/\">http://jessesnet.com/development-notes/2015/rabbitmq-cluster/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "RabbitMQ",
      "createAt": "2015/12/18 16:07:35",
      "updateAt": "2015/12/18 16:07:35"
    },
    {
      "title": "CentOS 6.7 部署RabbitMQ消息中间件集群",
      "content": "<p><span id=\"_baidu_bookmark_start_62\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_64\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_58\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_60\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_54\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_56\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_50\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_52\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_46\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_48\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_42\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_44\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_38\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_40\" style=\"display: none; line-height: 0px;\">‍</span></p><p><span style=\"font-size:16px\">CentOS 6.7 部署RabbitMQ消息中间件集群</span></p><p><strong><span style=\"font-size:16px\">#准备工作</span></strong></p><p><span style=\"font-size:16px\"><span style=\"line-height: 1.42857143;\">分别在两台名centos1和centos2的</span><span style=\"line-height: 22.8571434020996px;\">CentOS6.7安装RabbitMQ消息中间件节点：详情步骤请查看：<a title=\"http://imethan.cn/blog/article/78\" href=\"http://imethan.cn/blog/article/78\" target=\"_blank\">http://imethan.cn/blog/article/78</a></span></span></p><p><span style=\"font-size:16px\">将节点服务更新为“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">stop</span>”状态</span></p><p><strong><span style=\"font-size:16px\"><br/></span></strong></p><p><strong><span style=\"font-size:16px\">#集群说明</span></strong></p><p><span style=\"font-size:16px\">默认安装的RabbitMQ节点会自动生成“Erlang cookie”，该cookie用于识别是否是集群中的一个节点，集群中的全部节点的cookie必须保持一致，否则没办法成为集群中的一个节点。</span></p><p><span style=\"font-size:16px\">默认安装生成的cookie位于“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">/</span><span class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\" xmlns=\"http://www.w3.org/1999/xhtml\">var/lib/rabbitmq/.erlang.cookie</span>”路径或者是“<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px; white-space: normal;\">$HOME/.erlang.cookie</span>”路径</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#将centos1中的“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">/</span><span class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\" xmlns=\"http://www.w3.org/1999/xhtml\">var/lib/rabbitmq/.erlang.cookie</span>”复制到centos2的“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">/</span><span class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\" xmlns=\"http://www.w3.org/1999/xhtml\">var/lib/rabbitmq/</span>”目录下</span></strong></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#分别启动CentOS的RabbitMQ服务</span></strong></p><p><strong><span style=\"font-size:16px\">cd&nbsp;/usr/lib/rabbitmq/bin</span></strong></p><p><span style=\"font-size:16px\">centos1$ rabbitmq-server -detached</span></p><p><span style=\"font-size:16px\">centos2$ rabbitmq-server -detached</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#启动过程中出现如下问题：</span></p><p><span style=\"color: rgb(0, 0, 0);font-size:16px\">&quot;Cookie file /var/lib/rabbitmq/.erlang.cookie must be accessible by owner only&quot;</span></p><p><span style=\"color: rgb(0, 0, 0);font-size:16px\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span>chmod 600 /var/lib/rabbitmq/.erlang.cookie<span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></span></p><p><span style=\"color: rgb(0, 0, 0);font-size:16px\"><br/></span></p><p><span style=\"color: rgb(0, 0, 0);\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);font-size:16px\">“Error when reading /var/lib/rabbitmq/.erlang.cookie: eacces”</span></span></p><p><span style=\"color: rgb(0, 0, 0);\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);font-size:16px\">vi&nbsp;/var/lib/rabbitmq/.erlang.cookie</span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\">将centos1中的cookie内容copy到centos2中的cookie</span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"font-size:16px\"><strong><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"></span></span><span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span>#两个节点独立启动后查看状态</strong><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><strong></strong></span></span></span></p><p><span style=\"font-size:16px\"><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span id=\"_baidu_bookmark_start_34\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span><span id=\"_baidu_bookmark_start_36\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_37\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span id=\"_baidu_bookmark_end_35\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos1 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos1]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos1]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px; white-space: normal;font-size:16px\"><br/></span></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;font-size:16px\">centos2$&nbsp;rabbitmqctl cluster_status</span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos2]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos2]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos2.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;font-size:16px\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong><span style=\"font-size:16px\">#创建集群，将centos2节点加入centos1集群</span></strong></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\">centos</span>2$ rabbitmqctl stop_app</span></p><p><span style=\"font-size:16px\">Stopping node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\">centos</span>2$ rabbitmqctl join_cluster rabbit@centos1</span></p><p><span style=\"font-size:16px\">Clustering node rabbit@centos2 with rabbit@centos1 ...</span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\">centos</span>2$ rabbitmqctl start_app</span></p><p><span style=\"font-size:16px\">Starting node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span></span></span><span id=\"_baidu_bookmark_start_6\" style=\"display: none; line-height: 0px;\">‍</span>#查看集群状态</strong><span id=\"_baidu_bookmark_end_7\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><strong><span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span></strong></span></span></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><span style=\"white-space: normal; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_51\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span><span id=\"_baidu_bookmark_start_53\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_54\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><span id=\"_baidu_bookmark_end_52\" style=\"display: none; line-height: 0px;\">‍</span></span></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;font-size:16px\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos1 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos2,rabbit@centos1]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"font-size:16px\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; white-space: normal; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_55\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span><span id=\"_baidu_bookmark_start_57\" style=\"display: none; line-height: 0px;\">‍</span>centos2$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_58\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-size:16px\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_56\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span><br/></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;font-size:16px\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\">登录WEB管理界面首页查看集群状态</span></span></p><p><span id=\"_baidu_bookmark_start_0\" style=\"display: none; line-height: 0px;\">‍</span></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Name</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Erlang processes</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Memory</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Disk space</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Info</span></th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;font-size:12px\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: rgb(34, 34, 34); font-weight: bold;\"><span style=\"font-size:12px\">rabbit@centos1</span></a></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">25</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1024 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">1</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">829 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">181</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1048576 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">39MB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">395MB high watermark</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">13GB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">48MB low watermark</span></sub></div></td><td class=\"c\" style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><span style=\"font-size:12px\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></span></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\"><span style=\"font-size:12px\">rabbit@centos2</span></a></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -118px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">20</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1024 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">1</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">829 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">175</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1048576 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -109px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">38MB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">395MB high watermark</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">12GB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">48MB low watermark</span></sub></div></td><td class=\"c\" style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><span style=\"font-size:12px\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; cursor: default; background-image: initial; background-attachment: initial; background-color: rgb(170, 221, 221); background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; cursor: default; background-image: initial; background-attachment: initial; background-color: rgb(170, 221, 221); background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;\">1<span id=\"_baidu_bookmark_end_1\" style=\"display: none; line-height: 0px;\">‍</span></acronym></span></td></tr></tbody></table><p><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\">至此，centos1和centos2的RabbitMQ集群部署完成。</span></span></p><p><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><hr/><p><strong><span style=\"line-height: 1.42857;\"><span id=\"_baidu_bookmark_start_19\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_21\" style=\"display: none; line-height: 0px;\">‍</span>#其他管理操作</strong></p><p><span style=\"line-height: 22.8571px;\"><strong>#重启节点，本例子集群中只有两个节点，如果将其中的主节点停止，集群的另外节点将切换为主节点</strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; white-space: normal; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_31\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span><span id=\"_baidu_bookmark_start_33\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;<span id=\"_baidu_bookmark_start_23\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_25\" style=\"display: none; line-height: 0px;\">‍</span>rabbitmqctl stop<span id=\"_baidu_bookmark_end_26\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_24\" style=\"display: none; line-height: 0px;\">‍</span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_start_35\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span><span id=\"_baidu_bookmark_start_37\" style=\"display: none; line-height: 0px;\">‍</span>Stopping and halting node rabbit@centos1 ...<span id=\"_baidu_bookmark_end_38\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_36\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><br/></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_39\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></strong></span><span id=\"_baidu_bookmark_start_41\" style=\"display: none; line-height: 0px;\">‍</span>centos2$ <span id=\"_baidu_bookmark_start_27\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_29\" style=\"display: none; line-height: 0px;\">‍</span>rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_42\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_40\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_30\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_28\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></strong></span></p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]<span id=\"_baidu_bookmark_end_34\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_32\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_22\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_20\" style=\"display: none; line-height: 0px;\">‍</span></p><p><br/></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Name</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Erlang processes</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Memory</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Disk space</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Info</th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos1</a></td><td colspan=\"6\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-red\" style=\"text-align: center; border-radius: 3px; padding: 3px; color: white; background: rgb(255, 122, 122);\">Node not running</div></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos2</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\">25</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">181</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">12GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></td></tr></tbody></table><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><br/></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_43\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></strong></span><span id=\"_baidu_bookmark_start_45\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmq-server -detached<span id=\"_baidu_bookmark_end_46\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_44\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_47\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span></span></span></span></strong></span><span id=\"_baidu_bookmark_start_49\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_50\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 18px;\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_48\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span></span></span></span></span></span></strong></span></p><p>Cluster status of node rabbit@centos1 ...</p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos2,rabbit@centos1]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><br/></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></strong></span></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Name</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Erlang processes</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Memory</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Disk space</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Info</th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.133:15672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos1</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\">25</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">179</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">13GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.133:15672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos2</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\">25</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">181</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">12GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></td></tr></tbody></table><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></strong></span><br/></p><p><strong>#从集群中移除一个节点</strong></p><p>停止节点</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span><span style=\"line-height: 22.8571px; white-space: normal;\">$&nbsp;rabbitmqctl stop_app</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">Stopping node rabbit@centos2 ...</span></p><p><span style=\"line-height: 22.8571px;\">重置节点</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl reset</p><p>Resetting node rabbit@rabbit2 ...done.</p><p>启动节点</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl start_app</p><p>Starting node rabbit@rabbit2 ...done.</p><p><br/></p><p>查看centos2节点是否已经移除</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"white-space: normal; line-height: 22.8571px;\">centos1</span><span style=\"line-height: 22.8571px; white-space: normal;\">$ rabbitmqctl <span style=\"line-height: 22.8571px; white-space: normal;\">cluster_status</span></span></span></p><p>Cluster status of node rabbit@centos1 ...</p><p>[{nodes,[{disc,[rabbit@centos1]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><br/></span></strong></span><strong>#默认安装的集群节点是“Disc”类型，可以设置节点类型为“Ram”</strong><br/></p><p>centos2$ rabbitmqctl stop_app</p><p>Stopping node rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span> ...done.</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl join_cluster --ram rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos1</span></p><p>Clustering node rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span> with [rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos1</span>] ...done.</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl start_app</p><p>Starting node rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span> ...done.</p><p><br/></p><p><span style=\"white-space: normal; line-height: 22.8571px;\">centos2</span><span style=\"line-height: 22.8571px; white-space: normal;\">$</span> rabbitmqctl cluster_status</p><p>Cluster status of node rabbit@centos2 ...</p><p>[{nodes,[{disc,[rabbit@centos1]},{ram,[rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><br/></p><p><strong>#修改<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>节点类型为“Ram”，集群中必须存在一个“Disc”类型的节点</strong></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl stop_app</p><p>Stopping node rabbit@centos2 ...</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl change_cluster_node_type disc</p><p>Turning rabbit@rabbit2 into a ram node ...</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">centos2</span><span style=\"line-height: 22.8571px; white-space: normal;\">$ rabbitmqctl start_app</span></p><p>Starting node rabbit@centos2 ...</p><p><br/></p><p>查看状态</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span><span style=\"white-space: normal; line-height: 22.8571px;\">centos2</span><span style=\"white-space: normal; line-height: 22.8571px;\">$ <span style=\"line-height: 22.8571px; white-space: normal;\">rabbitmqctl cluster_status</span></span></p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p>Cluster status of node rabbit@centos2 ...</p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span><br/></p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><br/></p><p><span style=\"font-size:16px\"><strong>#参考文档</strong></span></p><p><span style=\"font-size:16px\"><a title=\"http://www.rabbitmq.com/clustering.html\" href=\"http://www.rabbitmq.com/clustering.html\" target=\"_self\">http://www.rabbitmq.com/clustering.html</a></span></p><p><a href=\"http://www.cnblogs.com/avril/archive/2010/03/23/1692809.html\" target=\"_blank\" title=\"http://www.cnblogs.com/avril/archive/2010/03/23/1692809.html\">http://www.cnblogs.com/avril/archive/2010/03/23/1692809.html</a></p><p><span style=\"font-size:16px\"><br/></span></p><p><br/></p><p><span id=\"_baidu_bookmark_end_41\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_39\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_65\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_63\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_61\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_59\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_57\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_55\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_53\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_51\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_49\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_47\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_45\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_43\" style=\"display: none; line-height: 0px;\">‍</span></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "RabbitMQ",
      "createAt": "2015/12/18 16:07:49",
      "updateAt": "2015/12/18 16:07:49"
    },
    {
      "title": "使用Spring AMQP动态创建RabbitMQ连接进行消息的发送和接收",
      "content": "<p>使用Spring AMQP动态创建RabbitMQ连接进行消息的发送和接收</p><p><br/></p><p>未完待续~~</p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "RabbitMQ",
      "createAt": "2015/12/18 16:13:54",
      "updateAt": "2015/12/18 16:13:54"
    },
    {
      "title": "CentOS 6.7安装RabbitMQ消息中间件",
      "content": "<p><strong><span style=\"font-size:16px\">#RabbitMQ是基于<span style=\"line-height: 22.8571434020996px; white-space: normal;\">Erlang开发的，所以</span>首先安装Erlang环境</span></strong></p><p><span style=\"font-size:16px\">下载：<strong>erlang-17.4-1.el6.x86_64.rpm</strong> 下载地址：<a href=\"http://www.rabbitmq.com/releases/erlang/\" target=\"_blank\" title=\"http://www.rabbitmq.com/releases/erlang/\"><span style=\"font-size:16px\"><span style=\"font-size:12pxfont-size:12px\">http://www.rabbitmq.com/releases/erlang/</span></span></a></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#rpm安装erlang</span></p><p><span style=\"font-size:16px\">rpm -ivh&nbsp;erlang-17.4-1.el6.x86_64.rpm</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#安装RabbitMQ Server</span></strong></p><p><span style=\"font-size:16px\">下载：<span id=\"_baidu_bookmark_start_14\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_12\" style=\"display: none; line-height: 0px;\">‍</span><strong><a href=\"http://www.rabbitmq.com/releases/rabbitmq-server/v3.5.6/rabbitmq-server-3.5.6-1.noarch.rpm\">rabbitmq-server-3.5.6-1.noarch.rpm</a>&nbsp;</strong><span style=\"line-height: 1.42857143;\">下载地址：</span><a href=\"http://www.rabbitmq.com/install-rpm.html\" target=\"_blank\" title=\"http://www.rabbitmq.com/install-rpm.html\" style=\"line-height: 1.42857143; background-color: rgb(255, 255, 255);\"><span style=\"font-size:16px\"><span style=\"font-size:12pxfont-size:12px\">http://www.rabbitmq.com/install-rpm.html</span></span></a></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#rpm安装rabbitmq-server</span></p><p><span style=\"font-size:16px\">rpm -ivh rabbitmq-server-3.5.6-1.noarch.rpm</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#启动<span style=\"line-height: 22.8571434020996px; white-space: normal;\">rabbitmq-server</span></strong></span></p><p><span style=\"line-height: 22.8571434020996px; white-space: normal;font-size:16px\">/sbin/service rabbitmq-server start</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#设置开机启动</strong></span></p><p><span style=\"font-size:16px\">chkconfig rabbitmq-server on</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#开放防火墙<span style=\"line-height: 22.8571434020996px; white-space: normal;\">端口</span></strong></span></p><p xmlns=\"\" style=\"clear: left; color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\"><span style=\"font-size:16px\">SELinux and similar mechanisms may prevent RabbitMQ from binding to a port. When that happens, RabbitMQ will fail to start. Make sure the following ports can be opened:</span></p><ul style=\"margin-top: 10px; margin-right: 0px; margin-left: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\"><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">4369 (epmd), 25672 (Erlang distribution)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">5672, 5671 (AMQP 0-9-1 without and with TLS)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">15672 (if management plugin is enabled)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">61613, 61614 (if STOMP is enabled)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">1883, 8883 (if MQTT is enabled)</span></li></ul><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><br/></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><strong>#默认安装说明</strong></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-seriffont-size:16pxfont-size:16px\"><span style=\"line-height: 18px;\"></span></span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装日志路径：/var/log/rabbitmq</span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装路径：/usr/lib/rabbitmq</span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装配置文件存放路径：/etc/rabbitmq</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><strong>#默认访问用户和虚拟主机</strong></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\">默认安装的rabbitmq服务，默认拥有一个账号和密码都是“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">guest</span>”的用户，并且绑定到虚拟主机“/”，只能在本机（localhost）访问rabbitmq，正式发布时，建议删除“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">guest</span>”账号和虚拟主机“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">/</span>”</span></span></p><p><strong style=\"line-height: 1.42857143;\"><span style=\"font-size:16px\"><br/></span></strong></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\"><strong>#管理RabbitMQ节点</strong></span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">进入到bin目录:cd&nbsp;<span style=\"line-height: 22.8571434020996px;\">/usr/lib/rabbitmq/bin</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 22.8571434020996px;font-size:16px\">停止服务：./<span xmlns=\"http://www.w3.org/1999/xhtml\" class=\"code \" style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\">rabbitmqctl stop</span></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 22.8571434020996px;\"><span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;font-size:16px\">查看状态：&nbsp;<span style=\"line-height: 22.8571434020996px; white-space: normal;\">./</span><span xmlns=\"http://www.w3.org/1999/xhtml\" class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\">rabbitmqctl status</span></span></span></span></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace;\"><span style=\"line-height: 18px;font-size:16px\">更多<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px; white-space: normal;\">rabbitmqctl</span>命令：<a href=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\" target=\"_self\" title=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\"><span style=\"font-size:16px\">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html</span></a></span></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#查看日志</strong></span></p><p><span style=\"font-size:16px\">进入到日志目录：cd&nbsp;<span style=\"line-height: 22.8571434020996px;\">/var/log/rabbitmq</span></span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">浏览日志文件：ls</span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">rabbit@centos1.log &nbsp;rabbit@centos1-sasl.log &nbsp;startup_err &nbsp;startup_log</span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">查看日志文件：cat&nbsp;<span style=\"line-height: 18.5714282989502px; white-space: normal;\">rabbit@centos1.log</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><br/></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><strong>#开启UI管理界面插件“<span style=\"line-height: 18.5714282989502px; white-space: normal;\">Management Plugin</span>”</strong></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">cd /usr/lib/rabbitmq/bin</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">rabbitmq-plugins enable rabbitmq_management</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><br/></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">URL访问地址：http://server-name:15672</span></span></p><p><span style=\"line-height: 18.5714px;\"><br/></span></p><p><span style=\"line-height: 18.5714px;\"><strong>#创建管理员用户，负责整个MQ的运维</strong></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">rabbitmqctl add_user &nbsp;admin admin &nbsp;</span></span></p><p><span style=\"line-height: 1.42857143;font-size:16px\">rabbitmqctl set_user_tags admin administrator &nbsp;</span></p><p><span style=\"font-size:16px\">更多用户管理命令：<a href=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\" target=\"_self\" title=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\"><span style=\"font-size:16px\">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html</span></a></span></p><p><br/></p><p>创建好后，便可以用账号为admin，密码为admin登录<span style=\"line-height: 18.5714282989502px; white-space: normal;\">http://server-name:15672 进行MQ的维护</span></p><p><span style=\"line-height: 1.42857143;font-size:16px\"><br/></span></p><p><strong style=\"line-height: 1.42857143;\"><span style=\"font-size:16px\"><br/></span></strong></p><p><span style=\"font-size:16px\"><strong style=\"line-height: 1.42857143;\">#参考文档</strong><br/></span></p><p><span style=\"font-size:16px\"><a href=\"http://www.rabbitmq.com/\" target=\"_blank\" title=\"http://www.rabbitmq.com/\">http://www.rabbitmq.com/</a></span></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 16:07:04",
      "updateAt": "2015/12/18 16:07:04"
    },
    {
      "title": "CentOS 6.7 配置文件的方式部署RabbitMQ消息中间件集群",
      "content": "<p>CentOS 6.7 配置文件的方式部署RabbitMQ消息中间件</p><p><strong>#准备工作</strong></p><p>分别在名为centos1、centos2的Centos 6.7 Linux上安装部署独立节点的RabbitMQ：<a href=\"http://imethan.cn/blog/article/78\" target=\"_blank\" title=\"http://imethan.cn/blog/article/78\">http://imethan.cn/blog/article/78</a></p><p><br/></p><p><strong>#安装完成后停止RabbitMQ<span style=\"line-height: 22.8571px; white-space: normal;\">节点</span>服务</strong></p><p>[root@centos1 bin]# rabbitmqctl stop</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]# rabbitmqctl stop</span></p><p><br/></p><p><strong>#配置文件方式部署说明</strong></p><p>默认安装部署的RabbitMQ并没有生成配置文件，采用的是运行时参数配置和策略（runtime parameters and policies）；自定义配置时，需要手动的创建配置文<span style=\"font-size:16px\">件<span id=\"_baidu_bookmark_start_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_7\" style=\"display: none; line-height: 0px;\">‍</span>:rabbitmq-env.conf（environment variables）、rabbitmq.config（a configuration file），创建的配置文件置于“/etc/rabbitmq”目录下。</span><span id=\"_baidu_bookmark_end_8\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; font-size: small; line-height: 18px;\"><span id=\"_baidu_bookmark_end_6\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#创建环境变量配置文件：<span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\">rabbitmq-env.conf（这步配置可以略过）</span></strong></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px;\">将节点名称更改为“imethan@centos1”</span></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p>vi /etc/rabbitmq/<span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\">rabbitmq-env.conf</span></p><p><span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\"></span></p><p>#example rabbitmq-env.conf file entries</p><p>#Rename the node</p><p>NODENAME=rabbit@centos1</p><p>#Config file location and new filename bunnies.config</p><p>#CONFIG_FILE=/etc/rabbitmq/testdir/bunnies</p><p><br/></p><p><strong>#创建配置文件：rabbitmq.config</strong></p><p>分别在centos1、centos2上创建如下配置文件：</p><p><span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\">vi /etc/rabbitmq/<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; font-size: small; line-height: 18px;\">rabbitmq.config</span></span></p><p><span style=\"font-size: medium; line-height: 22.8571px; white-space: normal;\"><br/></span></p><p>[</p><p>&nbsp; &nbsp; {mnesia, [{dump_log_write_threshold, 1000}]},</p><p>&nbsp; &nbsp; {rabbit, [{tcp_listeners, [5673]},{cluster_nodes,{[&#39;rabbit<span style=\"line-height: 22.8571px; white-space: normal;\">@centos1<span style=\"line-height: 22.8571px; white-space: normal;\">&#39;</span></span>,<span style=\"line-height: 22.8571px; white-space: normal;\">&#39;</span>rabbit@centos2<span style=\"line-height: 22.8571px; white-space: normal;\">&#39;</span>], disc}}]},</p><p>&nbsp; &nbsp; {rabbitmq_management, [{listener, [{port, 45672}]}]}</p><p>].</p><p><br/></p><p><strong>#创建完成后启动centos1上的RabbitMQ Master节点和重置centos2上的RabbitMQ&nbsp;Slave节点</strong></p><p><span style=\"line-height: 22.8571px;\">#在<span style=\"line-height: 22.8571px; white-space: normal;\">Master节点上执行</span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 bin]#&nbsp;rabbitmq-server -detached</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span></p><p><span style=\"white-space: nowrap;\">#在<span style=\"line-height: 22.8571px; white-space: normal;\">Slave节点上执行</span></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#&nbsp;</span>rabbitmqctl stop_app</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#&nbsp;</span>rabbitmqctl reset</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#</span> rabbitmqctl start_app</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>#确认集群配置是否成功</strong></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 bin]#</span> rabbitmqctl cluster_status</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span></p><p>Cluster status of node rabbit@centos2 ...</p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Name</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Erlang processes</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Memory</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Disk space</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Info</th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.134:45672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos1</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -118px 0px no-repeat rgb(152, 248, 152);\">20</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">176</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -109px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">13GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.134:45672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos2</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -118px 0px no-repeat rgb(152, 248, 152);\">20</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">175</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:45672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">12GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym></td></tr></tbody></table><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span><br/></p><p><br/></p><p><strong>#参考文档</strong></p><p><a href=\"http://www.rabbitmq.com/configure.html\" target=\"_blank\" title=\"http://www.rabbitmq.com/configure.html\">http://www.rabbitmq.com/configure.html</a></p><p><a href=\"http://jessesnet.com/development-notes/2015/rabbitmq-cluster/\" target=\"_blank\" title=\"http://jessesnet.com/development-notes/2015/rabbitmq-cluster/\">http://jessesnet.com/development-notes/2015/rabbitmq-cluster/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 16:07:35",
      "updateAt": "2015/12/18 16:07:35"
    },
    {
      "title": "CentOS 6.7 部署RabbitMQ消息中间件集群",
      "content": "<p><span id=\"_baidu_bookmark_start_62\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_64\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_58\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_60\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_54\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_56\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_50\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_52\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_46\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_48\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_42\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_44\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_38\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_40\" style=\"display: none; line-height: 0px;\">‍</span></p><p><span style=\"font-size:16px\">CentOS 6.7 部署RabbitMQ消息中间件集群</span></p><p><strong><span style=\"font-size:16px\">#准备工作</span></strong></p><p><span style=\"font-size:16px\"><span style=\"line-height: 1.42857143;\">分别在两台名centos1和centos2的</span><span style=\"line-height: 22.8571434020996px;\">CentOS6.7安装RabbitMQ消息中间件节点：详情步骤请查看：<a title=\"http://imethan.cn/blog/article/78\" href=\"http://imethan.cn/blog/article/78\" target=\"_blank\">http://imethan.cn/blog/article/78</a></span></span></p><p><span style=\"font-size:16px\">将节点服务更新为“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">stop</span>”状态</span></p><p><strong><span style=\"font-size:16px\"><br/></span></strong></p><p><strong><span style=\"font-size:16px\">#集群说明</span></strong></p><p><span style=\"font-size:16px\">默认安装的RabbitMQ节点会自动生成“Erlang cookie”，该cookie用于识别是否是集群中的一个节点，集群中的全部节点的cookie必须保持一致，否则没办法成为集群中的一个节点。</span></p><p><span style=\"font-size:16px\">默认安装生成的cookie位于“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">/</span><span class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\" xmlns=\"http://www.w3.org/1999/xhtml\">var/lib/rabbitmq/.erlang.cookie</span>”路径或者是“<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px; white-space: normal;\">$HOME/.erlang.cookie</span>”路径</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#将centos1中的“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">/</span><span class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\" xmlns=\"http://www.w3.org/1999/xhtml\">var/lib/rabbitmq/.erlang.cookie</span>”复制到centos2的“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">/</span><span class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\" xmlns=\"http://www.w3.org/1999/xhtml\">var/lib/rabbitmq/</span>”目录下</span></strong></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#分别启动CentOS的RabbitMQ服务</span></strong></p><p><strong><span style=\"font-size:16px\">cd&nbsp;/usr/lib/rabbitmq/bin</span></strong></p><p><span style=\"font-size:16px\">centos1$ rabbitmq-server -detached</span></p><p><span style=\"font-size:16px\">centos2$ rabbitmq-server -detached</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#启动过程中出现如下问题：</span></p><p><span style=\"color: rgb(0, 0, 0);font-size:16px\">&quot;Cookie file /var/lib/rabbitmq/.erlang.cookie must be accessible by owner only&quot;</span></p><p><span style=\"color: rgb(0, 0, 0);font-size:16px\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span>chmod 600 /var/lib/rabbitmq/.erlang.cookie<span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></span></p><p><span style=\"color: rgb(0, 0, 0);font-size:16px\"><br/></span></p><p><span style=\"color: rgb(0, 0, 0);\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);font-size:16px\">“Error when reading /var/lib/rabbitmq/.erlang.cookie: eacces”</span></span></p><p><span style=\"color: rgb(0, 0, 0);\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);font-size:16px\">vi&nbsp;/var/lib/rabbitmq/.erlang.cookie</span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\">将centos1中的cookie内容copy到centos2中的cookie</span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"font-size:16px\"><strong><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"></span></span><span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span>#两个节点独立启动后查看状态</strong><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><strong></strong></span></span></span></p><p><span style=\"font-size:16px\"><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span id=\"_baidu_bookmark_start_34\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span><span id=\"_baidu_bookmark_start_36\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_37\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span id=\"_baidu_bookmark_end_35\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos1 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos1]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos1]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px; white-space: normal;font-size:16px\"><br/></span></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;font-size:16px\">centos2$&nbsp;rabbitmqctl cluster_status</span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos2]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos2]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos2.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;font-size:16px\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong><span style=\"font-size:16px\">#创建集群，将centos2节点加入centos1集群</span></strong></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\">centos</span>2$ rabbitmqctl stop_app</span></p><p><span style=\"font-size:16px\">Stopping node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\">centos</span>2$ rabbitmqctl join_cluster rabbit@centos1</span></p><p><span style=\"font-size:16px\">Clustering node rabbit@centos2 with rabbit@centos1 ...</span></p><p><span style=\"font-size:16px\"><span style=\"line-height: 22.8571px; white-space: normal;\">centos</span>2$ rabbitmqctl start_app</span></p><p><span style=\"font-size:16px\">Starting node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span></span></span><span id=\"_baidu_bookmark_start_6\" style=\"display: none; line-height: 0px;\">‍</span>#查看集群状态</strong><span id=\"_baidu_bookmark_end_7\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><strong><span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span></strong></span></span></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><span style=\"white-space: normal; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_51\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span><span id=\"_baidu_bookmark_start_53\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_54\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><span id=\"_baidu_bookmark_end_52\" style=\"display: none; line-height: 0px;\">‍</span></span></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;font-size:16px\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos1 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos2,rabbit@centos1]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"font-size:16px\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; white-space: normal; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_55\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span><span id=\"_baidu_bookmark_start_57\" style=\"display: none; line-height: 0px;\">‍</span>centos2$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_58\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-size:16px\"><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_56\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span><br/></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;font-size:16px\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);\"></span></span></p><p><span style=\"font-size:16px\">Cluster status of node rabbit@centos2 ...</span></p><p><span style=\"font-size:16px\">[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</span></p><p><span style=\"font-size:16px\">&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</span></p><p><span style=\"font-size:16px\">&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</span></p><p><span style=\"font-size:16px\">&nbsp;{partitions,[]}]</span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; color: rgb(0, 0, 0); background-color: rgb(250, 250, 250);font-size:16px\">登录WEB管理界面首页查看集群状态</span></span></p><p><span id=\"_baidu_bookmark_start_0\" style=\"display: none; line-height: 0px;\">‍</span></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Name</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Erlang processes</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Memory</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Disk space</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\"><span style=\"font-size:12px\">Info</span></th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;font-size:12px\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: rgb(34, 34, 34); font-weight: bold;\"><span style=\"font-size:12px\">rabbit@centos1</span></a></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">25</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1024 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">1</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">829 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">181</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1048576 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">39MB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">395MB high watermark</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">13GB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">48MB low watermark</span></sub></div></td><td class=\"c\" style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><span style=\"font-size:12px\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></span></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\"><span style=\"font-size:12px\">rabbit@centos2</span></a></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -118px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">20</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1024 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">1</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">829 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">175</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">1048576 available</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -109px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">38MB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">395MB high watermark</span></sub></div></td><td style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\"><span style=\"font-size:12px\">12GB</span></div><sub style=\"display: block; color: rgb(136, 136, 136);\"><span style=\"font-size:12px\">48MB low watermark</span></sub></div></td><td class=\"c\" style=\"font-stretch: normal; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><span style=\"font-size:12px\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; cursor: default; background-image: initial; background-attachment: initial; background-color: rgb(170, 221, 221); background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; cursor: default; background-image: initial; background-attachment: initial; background-color: rgb(170, 221, 221); background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;\">1<span id=\"_baidu_bookmark_end_1\" style=\"display: none; line-height: 0px;\">‍</span></acronym></span></td></tr></tbody></table><p><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><p><span style=\"color:#000000;font-family:Monaco, DejaVu Sans Mono, Bitstream Vera Sans Mono, Consolas, Courier New, monospace\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\">至此，centos1和centos2的RabbitMQ集群部署完成。</span></span></p><p><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace;\"><span style=\"line-height: 18px; background-color: rgb(250, 250, 250);font-size:16px\"><br/></span></span></p><hr/><p><strong><span style=\"line-height: 1.42857;\"><span id=\"_baidu_bookmark_start_19\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_21\" style=\"display: none; line-height: 0px;\">‍</span>#其他管理操作</strong></p><p><span style=\"line-height: 22.8571px;\"><strong>#重启节点，本例子集群中只有两个节点，如果将其中的主节点停止，集群的另外节点将切换为主节点</strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; white-space: normal; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_31\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span><span id=\"_baidu_bookmark_start_33\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;<span id=\"_baidu_bookmark_start_23\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_25\" style=\"display: none; line-height: 0px;\">‍</span>rabbitmqctl stop<span id=\"_baidu_bookmark_end_26\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_24\" style=\"display: none; line-height: 0px;\">‍</span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_start_35\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span><span id=\"_baidu_bookmark_start_37\" style=\"display: none; line-height: 0px;\">‍</span>Stopping and halting node rabbit@centos1 ...<span id=\"_baidu_bookmark_end_38\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_36\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><br/></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_39\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></strong></span><span id=\"_baidu_bookmark_start_41\" style=\"display: none; line-height: 0px;\">‍</span>centos2$ <span id=\"_baidu_bookmark_start_27\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_29\" style=\"display: none; line-height: 0px;\">‍</span>rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_42\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_40\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_30\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_28\" style=\"display: none; line-height: 0px;\">‍</span></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></strong></span></p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]<span id=\"_baidu_bookmark_end_34\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_32\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_22\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_20\" style=\"display: none; line-height: 0px;\">‍</span></p><p><br/></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Name</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Erlang processes</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Memory</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Disk space</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Info</th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos1</a></td><td colspan=\"6\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-red\" style=\"text-align: center; border-radius: 3px; padding: 3px; color: white; background: rgb(255, 122, 122);\">Node not running</div></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.134:15672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos2</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\">25</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">181</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.134:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">12GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></td></tr></tbody></table><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><br/></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_43\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></strong></span><span id=\"_baidu_bookmark_start_45\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmq-server -detached<span id=\"_baidu_bookmark_end_46\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_44\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></strong></span></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><span id=\"_baidu_bookmark_start_47\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span></span></span></span></strong></span><span id=\"_baidu_bookmark_start_49\" style=\"display: none; line-height: 0px;\">‍</span>centos1$&nbsp;rabbitmqctl cluster_status<span id=\"_baidu_bookmark_end_50\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 18px;\"><span style=\"font-weight: 700; line-height: 22.8571px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; background-color: rgb(250, 250, 250);\"><span id=\"_baidu_bookmark_end_48\" style=\"display: none; line-height: 0px;\">‍</span></span></span></span></span></span></span></span></span></span></strong></span></p><p>Cluster status of node rabbit@centos1 ...</p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos2,rabbit@centos1]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><br/></p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></strong></span></p><table class=\"list\" style=\"border-width: 1px; margin-bottom: 0px; font-family: Verdana, sans-serif;\"><tbody><tr><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Name</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">File descriptors&nbsp;<span class=\"help\" id=\"file-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Socket descriptors&nbsp;<span class=\"help\" id=\"socket-descriptors\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">(?)</span></th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Erlang processes</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Memory</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Disk space</th><th style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 5em; width: auto; border: 1px solid rgb(204, 204, 204); text-align: center;\">Info</th><th class=\"plus-minus\" style=\"font-weight: normal; color: black; font-stretch: normal; font-size: 12px; line-height: normal; padding: 5px 4px; vertical-align: top; min-width: 2em; width: auto; border: none; text-align: center;\"><span class=\"popup-options-link\" title=\"Click to change columns\" type=\"columns\" for=\"overview\" style=\"color: rgb(136, 136, 136); cursor: pointer;\">+/-</span></th></tr><tr class=\"alt1\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><a href=\"http://192.168.42.133:15672/#/nodes/rabbit%40centos1\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos1</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\">25</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">179</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">13GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(240, 240, 240)), to(rgb(224, 224, 224)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym></td></tr><tr class=\"alt2\"><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><a href=\"http://192.168.42.133:15672/#/nodes/rabbit%40centos2\" style=\"display: block; width: 104px; color: black; font-weight: bold;\">rabbit@centos2</a></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -117px 0px no-repeat rgb(152, 248, 152);\">25</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1024 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">1</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">829 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">181</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">1048576 available</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -108px 0px no-repeat rgb(152, 248, 152);\">38MB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">395MB high watermark</sub></div></td><td style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><div class=\"status-bar\" style=\"text-align: center; width: 120px;\"><div class=\"status-bar-main green\" style=\"border-radius: 3px; padding: 3px; background: url(http://192.168.42.133:15672/img/bg-green-dark.png) -120px 0px no-repeat rgb(152, 248, 152);\">12GB</div><sub style=\"display: block; font-size: 0.8em; color: rgb(136, 136, 136);\">48MB low watermark</sub></div></td><td class=\"c\" style=\"font-stretch: normal; font-size: 12px; line-height: normal; padding-right: 4px; padding-left: 4px; vertical-align: top; min-width: 5em; width: auto; border-color: rgb(204, 204, 204); text-align: center !important; background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgb(248, 248, 248)), to(rgb(255, 255, 255)));\"><acronym title=\"Broker definitions are held on disc.\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Disc</acronym>&nbsp;<acronym title=\"Plugins: rabbitmq_management\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">1</acronym>&nbsp;<acronym title=\"This node contains the management statistics database\" style=\"color: rgb(34, 34, 34); padding: 2px 4px; border-radius: 2px; border: none; cursor: default; background: rgb(170, 221, 221);\">Stats</acronym></td></tr></tbody></table><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"></span></strong></span><br/></p><p><strong>#从集群中移除一个节点</strong></p><p>停止节点</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span><span style=\"line-height: 22.8571px; white-space: normal;\">$&nbsp;rabbitmqctl stop_app</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">Stopping node rabbit@centos2 ...</span></p><p><span style=\"line-height: 22.8571px;\">重置节点</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl reset</p><p>Resetting node rabbit@rabbit2 ...done.</p><p>启动节点</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl start_app</p><p>Starting node rabbit@rabbit2 ...done.</p><p><br/></p><p>查看centos2节点是否已经移除</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"white-space: normal; line-height: 22.8571px;\">centos1</span><span style=\"line-height: 22.8571px; white-space: normal;\">$ rabbitmqctl <span style=\"line-height: 22.8571px; white-space: normal;\">cluster_status</span></span></span></p><p>Cluster status of node rabbit@centos1 ...</p><p>[{nodes,[{disc,[rabbit@centos1]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><span style=\"line-height: 22.8571px;\"><strong><span style=\"color: rgb(0, 0, 0); font-family: Monaco, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, Consolas, &#39;Courier New&#39;, monospace; line-height: 18px; white-space: normal; background-color: rgb(250, 250, 250);\"><br/></span></strong></span><strong>#默认安装的集群节点是“Disc”类型，可以设置节点类型为“Ram”</strong><br/></p><p>centos2$ rabbitmqctl stop_app</p><p>Stopping node rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span> ...done.</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl join_cluster --ram rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos1</span></p><p>Clustering node rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span> with [rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos1</span>] ...done.</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl start_app</p><p>Starting node rabbit@<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span> ...done.</p><p><br/></p><p><span style=\"white-space: normal; line-height: 22.8571px;\">centos2</span><span style=\"line-height: 22.8571px; white-space: normal;\">$</span> rabbitmqctl cluster_status</p><p>Cluster status of node rabbit@centos2 ...</p><p>[{nodes,[{disc,[rabbit@centos1]},{ram,[rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><br/></p><p><strong>#修改<span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>节点类型为“Ram”，集群中必须存在一个“Disc”类型的节点</strong></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl stop_app</p><p>Stopping node rabbit@centos2 ...</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">centos2</span>$ rabbitmqctl change_cluster_node_type disc</p><p>Turning rabbit@rabbit2 into a ram node ...</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">centos2</span><span style=\"line-height: 22.8571px; white-space: normal;\">$ rabbitmqctl start_app</span></p><p>Starting node rabbit@centos2 ...</p><p><br/></p><p>查看状态</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span><span style=\"white-space: normal; line-height: 22.8571px;\">centos2</span><span style=\"white-space: normal; line-height: 22.8571px;\">$ <span style=\"line-height: 22.8571px; white-space: normal;\">rabbitmqctl cluster_status</span></span></p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p>Cluster status of node rabbit@centos2 ...</p><p>[{nodes,[{disc,[rabbit@centos1,rabbit@centos2]}]},</p><p>&nbsp;{running_nodes,[rabbit@centos1,rabbit@centos2]},</p><p>&nbsp;{cluster_name,&lt;&lt;&quot;rabbit@centos1.imethan.cn&quot;&gt;&gt;},</p><p>&nbsp;{partitions,[]}]</p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span><br/></p><p><span style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><br/></p><p><span style=\"font-size:16px\"><strong>#参考文档</strong></span></p><p><span style=\"font-size:16px\"><a title=\"http://www.rabbitmq.com/clustering.html\" href=\"http://www.rabbitmq.com/clustering.html\" target=\"_self\">http://www.rabbitmq.com/clustering.html</a></span></p><p><a href=\"http://www.cnblogs.com/avril/archive/2010/03/23/1692809.html\" target=\"_blank\" title=\"http://www.cnblogs.com/avril/archive/2010/03/23/1692809.html\">http://www.cnblogs.com/avril/archive/2010/03/23/1692809.html</a></p><p><span style=\"font-size:16px\"><br/></span></p><p><br/></p><p><span id=\"_baidu_bookmark_end_41\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_39\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_65\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_63\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_61\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_59\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_57\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_55\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_53\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_51\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_49\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_47\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_45\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_43\" style=\"display: none; line-height: 0px;\">‍</span></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 16:07:49",
      "updateAt": "2015/12/18 16:07:49"
    },
    {
      "title": "CentOS 6.7安装Mongodb并且配置用户权限",
      "content": "<p><strong>MongoDB安装</strong></p><p>//添加repo文件</p><p>vi&nbsp;/etc/yum.repos.d/mongodb-org-3.0.repo</p><p>[mongodb-org-3.0]</p><p>name=MongoDB Repository</p><p>baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.0/x86_64/</p><p>gpgcheck=0</p><p>enabled=1</p><p><br/></p><p>//yum安装，安装成功后的默认端口为27017</p><p>yum install -y mongodb-org</p><p><br/></p><p>//启动</p><p>/etc/rc.d/init.d/mongod start|stop|status|restart</p><p><br/></p><p><span style=\"line-height: 1.42857;\">//</span><span style=\"line-height: 22.8571px;\">mongo</span><span style=\"line-height: 1.42857;\">本地连接</span><br/></p><p>mongo</p><p><br/></p><p>//远程连接</p><p>mongo 127.0.0.1/admin -u username -p password</p><p><br/></p><p><strong>开启权限AUTH</strong></p><p>//默认安装启动的mongodb，没有设置auth，开启auth前，创建管理用户：siteUserAdmin、siteRootAdmin</p><p>use admin</p><p>db.createUser({user:&quot;siteUserAdmin&quot;,pwd:&quot;123456&quot;,roles:[{role:&quot;userAdminAnyDatabase&quot;,db:&quot;admin&quot;}]});</p><p>db.createUser({user:&quot;siteRootAdmin&quot;,pwd:&quot;123456&quot;,roles:[{role:&quot;root&quot;,db:&quot;admin&quot;}]});</p><p><br/></p><p>//编辑配置文件，开启auth，并且重启</p><p>vi /etc/mongod.conf</p><p>auth=true</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span><span style=\"line-height: 22.8571px; white-space: normal;\">/etc/rc.d/init.d/mongod&nbsp;<span style=\"line-height: 22.8571px; white-space: normal;\">restart</span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><strong>用户权限管理</strong></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">//登录</span></span></p><p><span style=\"line-height: 22.8571px;\">mongo</span></p><p><span style=\"line-height: 22.8571px;\">use admin</span></p><p><span style=\"line-height: 22.8571px;\">useadmindb.auth(&quot;siteRootAdmin&quot;,&quot;123456&quot;);</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\"></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">//查看数据库</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">show dbs</span></p><p><br/></p><p><span style=\"line-height: 22.8571px;\">//创建collection</span></p><p><span style=\"line-height: 22.8571px;\">db.createCollection(&quot;log&quot;)</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\">//插入记录</span><br/></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">use log</span></span></p><p><span style=\"line-height: 22.8571px;\"></span></p><p>db.loginfo.insert(</p><p>&nbsp; &nbsp;{</p><p>&nbsp; &nbsp; &nbsp;item: &quot;ABC1&quot;,</p><p>&nbsp; &nbsp; &nbsp;details: {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; model: &quot;14Q3&quot;,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; manufacturer: &quot;XYZ Company&quot;</p><p>&nbsp; &nbsp; &nbsp;},</p><p>&nbsp; &nbsp; &nbsp;stock: [ { size: &quot;S&quot;, qty: 25 }, { size: &quot;M&quot;, qty: 50 } ],</p><p>&nbsp; &nbsp; &nbsp;category: &quot;clothing&quot;</p><p>&nbsp; &nbsp;}</p><p>)</p><p>//查看记录</p><p>show collections</p><p><br/></p><p>//查询记录</p><p>db.loginfo.find()</p><p><br/></p><p><span style=\"line-height: 22.8571px;\">//创建用户,mongodb在对应数据创建的用户，只能登录对应的数据库登录</span><span style=\"line-height: 22.8571px;\"></span></p><p><span style=\"line-height: 22.8571px;\">db.createUser({user:&quot;loguser&quot;,pwd:&quot;123456&quot;,roles:[{role:&quot;dbOwner&quot;,db:&quot;log&quot;}]})</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\">//查看用户</span></p><p><span style=\"line-height: 22.8571px;\">show users</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\">//配置角色</span></p><p>db.grantRolesToUser( &quot;<span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span>&quot; , [ { role: &quot;readWrite&quot;, db: &quot;<span style=\"line-height: 22.8571px; white-space: normal;\">log</span>&quot; } ])&nbsp;</p><p><br/></p><p>//删除角色</p><p>db.revokeRolesFromUser( &quot;<span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span>&quot; , [ { role: &quot;readWrite&quot;, db: &quot;from_mysql&quot; } ]) &nbsp;</p><p><br/></p><p>//查看用户信息</p><p>db.getUser(&quot;loguser&quot;)</p><p><br/></p><p>//查看角色信息</p><p>db.getRole(&quot;readWrite&quot;,{showPrivileges:true})</p><p><span style=\"line-height: 22.8571px;\"><br/></span>//修改密码</p><p>db.changeUserPassword(&quot;<span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span>&quot;,&quot;1234567890&quot;)</p><p><br/></p><p>//删除用户</p><p><span style=\"line-height: 1.42857;\"></span><span style=\"line-height: 1.42857;\">db.dropUser(&quot;</span><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span></span><span style=\"line-height: 1.42857;\">&quot;)</span><br/></p><p><span style=\"line-height: 1.42857;\"><br/></span></p><p><span style=\"line-height: 1.42857;\">//无限制角色用户创建</span></p><p><span style=\"line-height: 1.42857;\">useadmindb.createUser({user:&quot;root&quot;,pwd:&quot;123456&quot;,roles:[&quot;root&quot;]})</span></p><p><span style=\"line-height: 1.42857;\">useadmindb.createUser({user:&quot;system&quot;,pwd:&quot;123456&quot;,roles:[&quot;__system&quot;]})</span></p><p><span style=\"line-height: 1.42857;\"><br/></span></p><p><br/></p><p><span style=\"line-height: 22.8571px;\"><strong>参考</strong></span></p><p><span style=\"line-height: 22.8571px;\"><a href=\"http://docs.mongodb.org/manual/\" target=\"_blank\">http://docs.mongodb.org/manual/</a></span></p><p>//mongo内置角色</p><p><a href=\"http://docs.mongodb.org/manual/reference/built-in-roles/\" target=\"_blank\">http://docs.mongodb.org/manual/reference/built-in-roles/</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">//mongo shell命令参考</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><a href=\"http://docs.mongodb.org/manual/reference/method/\" target=\"_blank\">http://docs.mongodb.org/manual/reference/method/</a></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 16:09:13",
      "updateAt": "2015/12/18 16:09:13"
    },
    {
      "title": "CentOS 6.7上安装Redis 3.0.5",
      "content": "<p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">在CentOS 6.7上安装Redis 3.0.5</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#Redis是什么？</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">Redis是一个key-value存储系统。和Memcached类似，它支持存储的value类型相对更多，包括string(字符串)、list(链表)、set(集合)、zset(sorted set --有序集合)和hash（哈希类型）。这些数据类型都支持push/pop、add/remove及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。在此基础上，redis支持各种不同方式的排序。与memcached一样，为了保证效率，数据都是缓存在内存中。区别的是redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#wget获取安装包并且安装</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] wget http://download.redis.io/releases/redis-3.0.5.tar.gz</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] tar xzf redis-3.0.5.tar.gz</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] cd redis-3.0.5</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date] make</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#安装过程中遇到的问题</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">1、提示没有“<span style=\"line-height: 22.8571px;\">CC</span>”编译器，于是安装“GCC”编译器</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span>yum install gcc</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">make</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\">2、提示“<span style=\"color: rgb(0, 0, 0); font-family: Simsun; font-size: 14px; line-height: 20px;\">File `Makefile&#39; has modification time 1.8e+06 s in the future</span>”，<span style=\"line-height: 1.42857;\">将系统时间改为当前时间即可</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span>date -s &quot;2015-11-08 15:15:00&quot;</span><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">make</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">3、提示“Newer version of jemalloc required”，“Leaving directory `/data/redis-3.0.5/src&#39;”</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">cd src</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">[root@centos1 src] &nbsp;make MALLOC=libc</span></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">#启动服务并且使用内置客户端测试</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]</span>&nbsp;src/redis-server</span></p><p style=\"white-space: normal;\"><span style=\"line-height: 22.8571px;\">......</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">359:M 08 Nov 15:28:30.429 * The server is now ready to accept connections on port 6379</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">说明启动成功，默认端口是：<strong>6379</strong></span><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]</span>&nbsp;src/redis-cli</p><p style=\"line-height: 22.8571px; white-space: normal;\">redis&gt; set foo bar</p><p style=\"line-height: 22.8571px; white-space: normal;\">OK</p><p style=\"line-height: 22.8571px; white-space: normal;\">redis&gt; get foo</p><p style=\"line-height: 22.8571px; white-space: normal;\">&quot;bar&quot;</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#结语</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">Redis的默认安装比较简单，默认安装启动没有在后台运行；指定配置文件启动可以配置为后台运行，IP、端口、主从配置、安全配置等等</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">#指定配置文件启动</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">redis-3.0.5根目录有一个配置文件example,将后台运行打开</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date] vi&nbsp;/data/redis-3.0.5/redis.conf</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p># By default Redis does not run as a daemon. Use &#39;yes&#39; if you need it.</p><p># Note that Redis will write a pid file in /var/run/redis.pid when daemonized.</p><p><strong>daemonize yes</strong></p><p><br/></p><p>指定配置文件开启服务</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date]&nbsp;</span>src/redis-server /data/redis-3.0.5/redis.conf</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">参考文档</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"http://redis.io/\" target=\"_blank\" title=\"http://redis.io/\">http://redis.io/</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"https://github.com/cinience/RedisStudio/releases\" target=\"_blank\" title=\"https://github.com/cinience/RedisStudio/releases\">https://github.com/cinience/RedisStudio/releases</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html\" target=\"_blank\" title=\"http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html\">http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p><br/></p>",
      "show": "1",
      "channel": "数据存储篇",
      "tag": "CentOS",
      "createAt": "2015/12/18 16:10:27",
      "updateAt": "2015/12/18 16:10:27"
    },
    {
      "title": "Hadoop学习之配置单一节点(Setting up a Single Node Cluster)",
      "content": "<p><strong>Hadoop学习之配置单一节点(Setting up a Single Node Cluster)</strong></p><p>2014年就开始学习Hadoop，但也只是阅读资料，安装Hadoop实例以及集群，做下测试，并不系统；现在决定开始系统的将学习的过程记录下来，写成文档的形式；另外，我整理学习笔记不喜欢长篇大论的照抄别家的教程，我只写核心的内容、自己测试的过程和理解；借助的学习资料引用，放在文章结尾的“参考文档”处。</p><p><br/></p><p>百度百科，输入&quot;Hadoop&quot;关键字检索，由&quot;Hadoop&quot;词条开始入门学习Hadoop，Hadoop的研究学习由此处开始。</p><p><br/></p><p><strong>#准备工作</strong></p><p>hadoop同时支持linux和windows平台，这里在linux平台安装学习，准备一台Centos 6.7 Linux虚拟主机。</p><p>安装JDK1.7并且配置好环境变量</p><p>并且安装好ssh并且启动sshd</p><p><br/></p><p>#安装ssh和rsync</p><p>[root@centos1 ~]# yum install ssh</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 ~]# yum install <span style=\"line-height: 22.8571px; white-space: normal;\">rsync</span></span></p><p><br/></p><p>#安装配置</p><p>下载hadoop-2.7.1.tar.gz，<a href=\"http://hadoop.apache.org/releases.html\" target=\"_blank\" title=\"http://hadoop.apache.org/releases.html\">http://hadoop.apache.org/releases.html</a>，解压至/data/hadoop-2.7.1</p><p><br/></p><p>查看JAVA_HOME&nbsp;</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 ~]#&nbsp;</span>echo $JAVA_HOME</p><p>/usr/java/jdk1.7.0_79</p><p><br/></p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 ~]#&nbsp;</span><span style=\"line-height: 22.8571px; white-space: normal;\">cd /data/hadoop-2.7.1/etc/hadoop</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 ~]#&nbsp;</span>vi hadoop-env.sh&nbsp;</p><p># The java implementation to use.</p><p>#export JAVA_HOME=${JAVA_HOME}</p><p>export JAVA_HOME=/usr/java/jdk1.7.0_79</p><p><br/></p><p>#查看hadoop版本</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 ~]#&nbsp;</span><span style=\"white-space: normal; line-height: 22.8571px;\">cd /data/hadoop-2.7.1/bin</span></p><p>[root@centos1 bin]# ./hadoop version</p><p>Hadoop 2.7.1</p><p>Subversion https://git-wip-us.apache.org/repos/asf/hadoop.git -r 15ecc87ccf4a0228f35af08fc56de536e6ce657a</p><p>Compiled by jenkins on 2015-06-29T06:04Z</p><p>Compiled with protoc 2.5.0</p><p>From source with checksum fc0a1a23fc1868e4d5ee7fa2b28a58a</p><p>This command was run using /data/hadoop-2.7.1/share/hadoop/common/hadoop-common-2.7.1.jar</p><p><br/></p><p><strong>#Standalone Operation &nbsp;独立运行操作</strong></p><p><strong></strong></p><p>[root@centos1 hadoop-2.7.1]#&nbsp;mkdir input</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[ro</span><span style=\"line-height: 22.8571px; white-space: normal;\">ot</span>@centos1 hadoop-2.7.1]#&nbsp;cp etc/hadoop/*.xml input</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[ro</span><span style=\"white-space: normal; line-height: 22.8571px;\">ot</span><span style=\"line-height: 22.8571px; white-space: normal;\">@centos1 hadoop-2.7.1]#&nbsp;</span>bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar grep input output &#39;dfs[a-z.]+&#39;</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[ro</span><span style=\"white-space: normal; line-height: 22.8571px;\">ot</span><span style=\"line-height: 22.8571px; white-space: normal;\">@centos1 hadoop-2.7.1]#&nbsp;</span>cat output/*</p><p><br/></p><p><strong><span style=\"font-size:18px\">#Pseudo-Distributed Operation 伪分布式操作</span></strong></p><p>#配置核心site,指定master节点</p><p>[root@centos1 hadoop-2.7.1]# vi etc/hadoop/core-site.xml<strong>&nbsp;</strong><br/></p><p><strong></strong></p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;fs.defaultFS&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;hdfs://centos1:9000&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><br/></p><p>#编辑hdfs-site.xml文件，设置从节点的数量为1</p><p>[root@centos1 hadoop-2.7.1]# vi etc/hadoop/hdfs-site.xml</p><p><strong></strong></p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;dfs.replication&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;1&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><br/></p><p>#ssh无密码登录localhost<br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> ssh-keygen -t dsa -P &#39;&#39; -f ~/.ssh/id_dsa</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> export HADOOP\\_PREFIX=<span style=\"line-height: 22.8571px; white-space: normal;\">/data/hadoop-2.7.1</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 hadoop-2.7.1]#</span><span style=\"line-height: 22.8571px; white-space: normal;\">&nbsp;ssh localhost</span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p>#开始运行</p><p>1、Format the filesystem:格式化文件系统</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span>&nbsp;bin/hdfs namenode -format</p><p><br/></p><p>2、Start NameNode daemon and DataNode daemon:启动NameNode和DataNode&nbsp;<span id=\"_baidu_bookmark_end_52\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 0, 0); font-family: Verdana, Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15.6px; white-space: normal;\"><span style=\"color: rgb(0, 0, 0); font-family: Verdana, Helvetica, Arial, sans-serif; font-size: 12px; line-height: 15.6px; white-space: normal;\"><span id=\"_baidu_bookmark_end_50\" style=\"display: none; line-height: 0px;\">‍</span></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;sbin/start-dfs.sh</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span></p><p>[root@centos1 hadoop-2.7.1]# jps</p><p>53665 NameNode</p><p>54961 Jps</p><p>53783 DataNode</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">3、Browse the web interface for the NameNode; by default it is available at:通过WEB浏览NameNode信息</span></p><p>NameNode - http://localhost:50070/</p><p><br/></p><p>4、Make the HDFS directories required to execute MapReduce jobs：创建执行<span style=\"line-height: 22.8571px; white-space: normal;\">MapReduce 需要的HAFS目录</span></p><p><span style=\"line-height: 22.8571px;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span><span style=\"line-height: 1.42857;\">bin/hdfs dfs -mkdir /user</span><br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>bin/hdfs dfs -mkdir /user/root</p><p><span style=\"white-space: normal; line-height: 22.8571px;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span><span style=\"line-height: 22.8571px; white-space: normal;\">bin/hdfs dfs -mkdir /user/root/input</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span>5、Copy the input files into the distributed filesystem:将<span style=\"line-height: 22.8571px; white-space: normal;\">etc/hadoop下文件copy到input目录</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>bin/hdfs dfs -put etc/hadoop input</span></p><p><br/></p><p>6、Run some of the examples provided:执行example</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span>bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar grep input output &#39;dfs[a-z.]+&#39;</p><p><br/></p><p>7、Examine the output files: Copy the output files from the distributed filesystem to the local filesystem and examine them:</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> bin/hdfs dfs -get output output</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span> cat output/*</p><p><br/></p><p>8、When you’re done, stop the daemons with:执行完成后，关闭节点</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#</span>sbin/stop-dfs.sh</p><p><br/></p><p><strong>#YARN on a Single Node 独立节点中的YARN mapreduce框架</strong></p><p>1、Configure parameters as follows:配置参数</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>vi etc/hadoop/mapred-site.xml</p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;yarn&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>vi etc/hadoop/yarn-site.xml</p><p>&lt;configuration&gt;</p><p>&nbsp; &nbsp; &lt;property&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</p><p>&nbsp; &nbsp; &lt;/property&gt;</p><p>&lt;/configuration&gt;</p><p><br/></p><p>2、Start ResourceManager daemon and NodeManager daemon:启动守护进程</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>sbin/start-yarn.sh</p><p>[root@centos1 hadoop-2.7.1]# jps</p><p>56479 Jps</p><p>56386 NodeManager</p><p>56170 ResourceManager</p><p><span style=\"white-space: nowrap; line-height: 1.42857;\"><br/></span></p><p><span style=\"white-space: nowrap; line-height: 1.42857;\">3、Browse the web interface for the ResourceManager; 通过WEB浏览资源管理信息</span></p><p><span style=\"white-space: nowrap;\">ResourceManager - http://localhost:8088/</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">4、Run a MapReduce job.该步骤在伪分布式操作中已经执行过了</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">5、When you’re done, stop the daemons with:关闭</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]#&nbsp;</span>$ sbin/stop-yarn.sh</span></p><p><br/></p><p>初步学习和测试Hadoop分布式文件系统到此处结束</p><p><br/></p><p><strong>#参考文档</strong></p><p><a title=\"http://hadoop.apache.org/\" href=\"http://hadoop.apache.org/\" target=\"_blank\">http://hadoop.apache.org/</a></p><p><a title=\"http://blog.fens.me/hadoop-family-roadmap/\" href=\"http://blog.fens.me/hadoop-family-roadmap/\" target=\"_blank\">http://blog.fens.me/hadoop-family-roadmap/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Hadoop笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 17:26:03",
      "updateAt": "2015/12/18 17:26:03"
    },
    {
      "title": "Hadoop学习之配置多节点集群(Hadoop Cluster Setup)",
      "content": "<p><strong>Hadoop学习之配置多节点集群(Hadoop Cluster Setup)</strong></p><p><strong><br/></strong></p><p><strong>#多节点集群配置说明</strong></p><p>多节点集群配置是在伪分布式配置的基础上，将安装配置好的“hadoop-2.7.1”复制到其他节点虚拟机上，并且启动。</p><p>伪分布式部署配置详看：<span style=\"font-weight: 700; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px; white-space: normal;\"><a href=\"http://imethan.cn/blog/article/84\" target=\"_blank\" title=\"http://imethan.cn/blog/article/84\"><em>Hadoop学习之配置单一节点(Setting up a Single Node Cluster)</em></a></span></p><p><br/></p><p>虚拟主机：centos1、centos2;分别配置好hosts，使之centos1和centos2之间的ping测试能互通，并且开放对应防火墙端口，<span style=\"line-height: 1.42857;\">这里的测试配置，只提供一台<span style=\"line-height: 22.8571px; white-space: normal;\">slaver</span>节点，即将centos2作为slaver，centos1作为master；而正式生产环境至少需要2两个<span style=\"line-height: 22.8571px; white-space: normal;\">slaver，切记</span>。</span></p><p><span style=\"line-height: 1.42857;\"><br/></span></p><p><span style=\"line-height: 1.42857;\"><strong>#将centos1上安装配置好的hadoop安装包copy至centos2上</strong></span></p><p><span style=\"line-height: 1.42857;\">[root@centos1 data]# scp -r /data/<span style=\"line-height: 22.8571px; white-space: normal;\">hadoop-2.7.1 root@centos2:/data/</span></span></p><p><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><span style=\"line-height: 22.8571px;\"><strong>#分别启动centos1上的hadoop和centos2上的hadoop</strong></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]# sbin/start-dfs.sh</span></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 hadoop-2.7.1]# jps</span></span></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></span></p><p>41291 DataNode</p><p>41611 Jps</p><p>41464 SecondaryNameNode</p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></span><br/></p><p><span style=\"line-height: 22.8571px;\">[root@centos2 hadoop-2.7.1]# sbin/start-dfs.sh</span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos2 hadoop-2.7.1]# jps</span></span></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"></span></span></p><p>41291 DataNode</p><p>41611 Jps</p><p>41464 SecondaryNameNode</p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span><strong>#查看节点情况</strong></p><p><small></small></p><table class=\"table\"><thead><tr><th>Node</th><th>Last contact</th><th>Admin State</th><th>Capacity</th><th>Used</th><th>Non DFS Used</th><th>Remaining</th><th>Blocks</th><th>Block pool used</th><th>Failed Volumes</th><th>Version</th></tr></thead><tbody><tr><td>centos1.imethan.cn:50010 (192.168.42.133:50010)</td><td>1</td><td>In Service</td><td>17.17 GB</td><td>576 KB</td><td>5.36 GB</td><td>11.81 GB</td><td>58</td><td>576 KB (0%)</td><td>0</td><td>2.7.1</td></tr><tr><td>centos2.imethan.cn:50010 (192.168.42.134:50010)</td><td>2</td><td>In Service</td><td>17.17 GB</td><td>28 KB</td><td>5.72 GB</td><td>11.45 GB</td><td>0</td><td>28 KB (0%)</td><td>0</td><td>2.7.1</td></tr></tbody></table><p></p><p><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p>至此，一个master和一个<span style=\"line-height: 22.8571px; white-space: normal;\">slaver的hadoop分布式部署配置完成。</span></p><p><br/></p><p><strong><br/></strong></p><p><strong></strong></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><span style=\"font-weight: 700;\">#参考文档</span></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><a href=\"http://imethan.cn/blog/article/84\" target=\"_blank\" title=\"http://imethan.cn/blog/article/84\">http://imethan.cn/blog/article/84</a></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><a title=\"http://hadoop.apache.org/\" href=\"http://hadoop.apache.org/\" target=\"_blank\">http://hadoop.apache.org/</a></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><a title=\"http://blog.fens.me/hadoop-family-roadmap/\" href=\"http://blog.fens.me/hadoop-family-roadmap/\" target=\"_blank\">http://blog.fens.me/hadoop-family-roadmap/</a></p><p style=\"margin-top: 0px; margin-bottom: 10px; white-space: normal; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, &#39;Hiragino Sans GB&#39;, &#39;Hiragino Sans GB W3&#39;, &#39;WenQuanYi Micro Hei&#39;, &#39;Microsoft YaHei UI&#39;, &#39;Microsoft YaHei&#39;, sans-serif; font-size: 14px; line-height: 20px;\"><br/></p>",
      "show": "1",
      "channel": "Hadoop笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 17:26:13",
      "updateAt": "2015/12/18 17:26:13"
    },
    {
      "title": "CentOS 6  Linux 常用配置",
      "content": "<p><strong>关闭防火墙</strong></p><p>service iptables stop</p><p>限制防火墙开机启动</p><p>chkconfig iptables off</p><p>防火墙添加端口规则</p><p>修改/etc/sysconfig/iptables 文件，添加以下内容：</p><p>-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT</p><p><br/></p><p><strong>修改主机名称，重启也生效</strong></p><p>uname -a 查看hostname</p><p>hostname centos1.imethan.cn 修改让hostname立刻生效</p><p>vi /etc/hosts 修改原hostname为 centos1.imethan.cn</p><p>vi &nbsp;/etc/sysconfig/network 修改原hostname为 centos1.imethan.cn,这样可以让reboot重启后也生效</p><p>reboot重启，uname -a 重新检查</p><p><br/></p><p><strong>添加DNS域名转发</strong></p><p>vi /etc/hosts</p><p>添加转发域名记录，例如</p><p>192.168.42.131 www.imethan.cn &nbsp;blog</p><p>#IP地址 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #转发目标域名 &nbsp; &nbsp; &nbsp; #别名</p><p>#hosts文件格式是一行一条记录，分别是IP地址 hostname aliases，三者用空白字符分隔，aliases可选</p><p><br/></p><p><br/></p><p><strong style=\"background-color: inherit;\">修改系统时间</strong></p><p>date -s &quot;2015-11-08 15:15:00&quot;</p><p><br/></p><p><strong>JDK环境变量配置</strong></p><p>#vi /etc/profile</p><p>在最后面加入</p><p>#set java environment</p><p>JAVA_HOME=/usr/java/jdk1.7.0_79</p><p>CLASSPATH=.:$JAVA_HOME/lib.tools.jar</p><p>PATH=$JAVA_HOME/bin:$PATH</p><p>export JAVA_HOME CLASSPATH PATH</p><p>保存退出，是配置马上生效</p><p>source /etc/profile</p><p><br/></p><p><strong>配置SSH免用户名和密码登录</strong></p><p></p><p>ssh-keygen -t rsa -P &#39;&#39;</p><p>scp /home/tungsten/.ssh/id_rsa.pub tungsten@centos1:/home/tungsten/.ssh/authorized_keys</p><p>service sshd restart</p><p><strong><br/></strong><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "CentOS",
      "createAt": "2015/12/18 17:26:46",
      "updateAt": "2016/1/5 12:13:22"
    },
    {
      "title": "Linux chown命令使用说明",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown命令<br/></span></p><p><span style=\"font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、命令格式：</strong><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"></strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown&nbsp;[选项]...&nbsp;[所有者][:[组]]&nbsp;文件...</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、命令功能：</strong></strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;chown命令可以将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户ID；组可以是组名或者组ID；文件以空格分开要改变权限的文件列表，支持通配符。系统管理员经常使用chown命令，在将文件拷贝到另一个用户的名录下之后，让用户拥有使用该文件的权限。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">3、命令参数：</strong><strong style=\"margin: 0px; padding: 0px;\"></strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　<strong style=\"margin: 0px; padding: 0px;\">　必要参数:</strong><strong style=\"margin: 0px; padding: 0px;\"></strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-c&nbsp;显示更改的部分的信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-f&nbsp;忽略错误信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-h&nbsp;修复符号链接</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-R&nbsp;处理指定目录以及其子目录下的所有文件</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-v&nbsp;显示详细的处理信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-deference&nbsp;作用于符号链接的指向，而不是链接文件本身</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　<strong style=\"margin: 0px; padding: 0px;\">选择参数:</strong><strong style=\"margin: 0px; padding: 0px;\"></strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--reference=&lt;目录或文件&gt;&nbsp;把指定的目录/文件作为参考，把操作的文件/目录设置成参考文件/目录相同拥有者和群组</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--from=&lt;当前用户：当前群组&gt;&nbsp;只有当前用户和群组跟指定的用户和群组相同时才进行改变</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--help&nbsp;显示帮助信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--version&nbsp;显示版本信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">4．使用实例：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　<strong style=\"margin: 0px; padding: 0px;\">实例1：改变拥有者和群组</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown tomcat:tomcat /date/apache-tomcat-7.0.64-8180</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">实例2：改变文件拥有者</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>:&nbsp;log2015.log</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">实例3：改变文件群组</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown&nbsp;:<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>&nbsp;log2015.log</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">实例4：改变指定目录以及其子目录下的所有文件的拥有者和群组&nbsp;</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown&nbsp;-R&nbsp;-v&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>:<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">/date/apache-tomcat-7.0.64-8180</span></span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">参考文档</span></p><p><a href=\"http://www.cnblogs.com/peida/archive/2012/12/04/2800684.html\" target=\"_blank\" style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">http://www.cnblogs.com/peida/archive/2012/12/04/2800684.html</span></a> </p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "CentOS",
      "createAt": "2015/12/31 16:18:06",
      "updateAt": "2016/1/5 12:16:06"
    },
    {
      "title": "CentOS 6.7安装RabbitMQ消息中间件",
      "content": "<p><strong><span style=\"font-size:16px\">#RabbitMQ是基于<span style=\"line-height: 22.8571434020996px; white-space: normal;\">Erlang开发的，所以</span>首先安装Erlang环境</span></strong></p><p><span style=\"font-size:16px\">下载：<strong>erlang-17.4-1.el6.x86_64.rpm</strong> 下载地址：<a href=\"http://www.rabbitmq.com/releases/erlang/\" target=\"_blank\" title=\"http://www.rabbitmq.com/releases/erlang/\"><span style=\"font-size:16px\"><span style=\"font-size:12pxfont-size:12px\">http://www.rabbitmq.com/releases/erlang/</span></span></a></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#rpm安装erlang</span></p><p><span style=\"font-size:16px\">rpm -ivh&nbsp;erlang-17.4-1.el6.x86_64.rpm</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><strong><span style=\"font-size:16px\">#安装RabbitMQ Server</span></strong></p><p><span style=\"font-size:16px\">下载：<span id=\"_baidu_bookmark_start_14\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_12\" style=\"display: none; line-height: 0px;\">‍</span><strong><a href=\"http://www.rabbitmq.com/releases/rabbitmq-server/v3.5.6/rabbitmq-server-3.5.6-1.noarch.rpm\">rabbitmq-server-3.5.6-1.noarch.rpm</a>&nbsp;</strong><span style=\"line-height: 1.42857143;\">下载地址：</span><a href=\"http://www.rabbitmq.com/install-rpm.html\" target=\"_blank\" title=\"http://www.rabbitmq.com/install-rpm.html\" style=\"line-height: 1.42857143; background-color: rgb(255, 255, 255);\"><span style=\"font-size:16px\"><span style=\"font-size:12pxfont-size:12px\">http://www.rabbitmq.com/install-rpm.html</span></span></a></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\">#rpm安装rabbitmq-server</span></p><p><span style=\"font-size:16px\">rpm -ivh rabbitmq-server-3.5.6-1.noarch.rpm</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#启动<span style=\"line-height: 22.8571434020996px; white-space: normal;\">rabbitmq-server</span></strong></span></p><p><span style=\"line-height: 22.8571434020996px; white-space: normal;font-size:16px\">/sbin/service rabbitmq-server start</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#设置开机启动</strong></span></p><p><span style=\"font-size:16px\">chkconfig rabbitmq-server on</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#开放防火墙<span style=\"line-height: 22.8571434020996px; white-space: normal;\">端口</span></strong></span></p><p xmlns=\"\" style=\"clear: left; color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\"><span style=\"font-size:16px\">SELinux and similar mechanisms may prevent RabbitMQ from binding to a port. When that happens, RabbitMQ will fail to start. Make sure the following ports can be opened:</span></p><ul style=\"margin-top: 10px; margin-right: 0px; margin-left: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\"><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">4369 (epmd), 25672 (Erlang distribution)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">5672, 5671 (AMQP 0-9-1 without and with TLS)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">15672 (if management plugin is enabled)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">61613, 61614 (if STOMP is enabled)</span></li><li style=\"list-style-type: none; margin: 0px; padding: 3px 0px 2px 10px; background: url(http://www.rabbitmq.com/img/li.gif) 1px 9px no-repeat;\"><span style=\"font-size:16px\">1883, 8883 (if MQTT is enabled)</span></li></ul><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><br/></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><strong>#默认安装说明</strong></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-seriffont-size:16pxfont-size:16px\"><span style=\"line-height: 18px;\"></span></span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装日志路径：/var/log/rabbitmq</span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装路径：/usr/lib/rabbitmq</span></p><p style=\"line-height: 22.8571434020996px; white-space: normal;\"><span style=\"white-space: nowrap;font-size:16px\">默认安装配置文件存放路径：/etc/rabbitmq</span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\"><strong>#默认访问用户和虚拟主机</strong></span></span></p><p><span style=\"color:#555555;font-family:Verdana, sans-serif\"><span style=\"line-height: 18px;font-size:16px\">默认安装的rabbitmq服务，默认拥有一个账号和密码都是“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">guest</span>”的用户，并且绑定到虚拟主机“/”，只能在本机（localhost）访问rabbitmq，正式发布时，建议删除“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">guest</span>”账号和虚拟主机“<span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;\">/</span>”</span></span></p><p><strong style=\"line-height: 1.42857143;\"><span style=\"font-size:16px\"><br/></span></strong></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\"><strong>#管理RabbitMQ节点</strong></span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">进入到bin目录:cd&nbsp;<span style=\"line-height: 22.8571434020996px;\">/usr/lib/rabbitmq/bin</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 22.8571434020996px;font-size:16px\">停止服务：./<span xmlns=\"http://www.w3.org/1999/xhtml\" class=\"code \" style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\">rabbitmqctl stop</span></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 22.8571434020996px;\"><span style=\"color: rgb(85, 85, 85); font-family: Verdana, sans-serif; line-height: 18px; white-space: normal;font-size:16px\">查看状态：&nbsp;<span style=\"line-height: 22.8571434020996px; white-space: normal;\">./</span><span xmlns=\"http://www.w3.org/1999/xhtml\" class=\"code \" style=\"white-space: normal; color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px;\">rabbitmqctl status</span></span></span></span></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace;\"><span style=\"line-height: 18px;font-size:16px\">更多<span style=\"color: rgb(51, 51, 51); font-family: &#39;Courier New&#39;, Courier, monospace; line-height: 18px; white-space: normal;\">rabbitmqctl</span>命令：<a href=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\" target=\"_self\" title=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\"><span style=\"font-size:16px\">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html</span></a></span></span></p><p><span style=\"font-size:16px\"><br/></span></p><p><span style=\"font-size:16px\"><strong>#查看日志</strong></span></p><p><span style=\"font-size:16px\">进入到日志目录：cd&nbsp;<span style=\"line-height: 22.8571434020996px;\">/var/log/rabbitmq</span></span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">浏览日志文件：ls</span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">rabbit@centos1.log &nbsp;rabbit@centos1-sasl.log &nbsp;startup_err &nbsp;startup_log</span></p><p><span style=\"line-height: 18.5714282989502px;font-size:16px\">查看日志文件：cat&nbsp;<span style=\"line-height: 18.5714282989502px; white-space: normal;\">rabbit@centos1.log</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><br/></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><strong>#开启UI管理界面插件“<span style=\"line-height: 18.5714282989502px; white-space: normal;\">Management Plugin</span>”</strong></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">cd /usr/lib/rabbitmq/bin</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">rabbitmq-plugins enable rabbitmq_management</span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\"><br/></span></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">URL访问地址：http://server-name:15672</span></span></p><p><span style=\"line-height: 18.5714px;\"><br/></span></p><p><span style=\"line-height: 18.5714px;\"><strong>#创建管理员用户，负责整个MQ的运维</strong></span></p><p><span style=\"line-height: 18.5714282989502px;\"><span style=\"line-height: 18.5714282989502px; white-space: normal;font-size:16px\">rabbitmqctl add_user &nbsp;admin admin &nbsp;</span></span></p><p><span style=\"line-height: 1.42857143;font-size:16px\">rabbitmqctl set_user_tags admin administrator &nbsp;</span></p><p><span style=\"font-size:16px\">更多用户管理命令：<a href=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\" target=\"_self\" title=\"http://www.rabbitmq.com/man/rabbitmqctl.1.man.html\"><span style=\"font-size:16px\">http://www.rabbitmq.com/man/rabbitmqctl.1.man.html</span></a></span></p><p><br/></p><p>创建好后，便可以用账号为admin，密码为admin登录<span style=\"line-height: 18.5714282989502px; white-space: normal;\">http://server-name:15672 进行MQ的维护</span></p><p><span style=\"line-height: 1.42857143;font-size:16px\"><br/></span></p><p><strong style=\"line-height: 1.42857143;\"><span style=\"font-size:16px\"><br/></span></strong></p><p><span style=\"font-size:16px\"><strong style=\"line-height: 1.42857143;\">#参考文档</strong><br/></span></p><p><span style=\"font-size:16px\"><a href=\"http://www.rabbitmq.com/\" target=\"_blank\" title=\"http://www.rabbitmq.com/\">http://www.rabbitmq.com/</a></span></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "RabbitMQ笔记",
      "tag": "Linux",
      "createAt": "2015/12/18 16:07:04",
      "updateAt": "2015/12/18 16:07:04"
    },
    {
      "title": "CentOS 6.7上安装Redis 3.0.5",
      "content": "<p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">在CentOS 6.7上安装Redis 3.0.5</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#Redis是什么？</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">Redis是一个key-value存储系统。和Memcached类似，它支持存储的value类型相对更多，包括string(字符串)、list(链表)、set(集合)、zset(sorted set --有序集合)和hash（哈希类型）。这些数据类型都支持push/pop、add/remove及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。在此基础上，redis支持各种不同方式的排序。与memcached一样，为了保证效率，数据都是缓存在内存中。区别的是redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#wget获取安装包并且安装</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] wget http://download.redis.io/releases/redis-3.0.5.tar.gz</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] tar xzf redis-3.0.5.tar.gz</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] cd redis-3.0.5</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date] make</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#安装过程中遇到的问题</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">1、提示没有“<span style=\"line-height: 22.8571px;\">CC</span>”编译器，于是安装“GCC”编译器</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span>yum install gcc</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">make</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\">2、提示“<span style=\"color: rgb(0, 0, 0); font-family: Simsun; font-size: 14px; line-height: 20px;\">File `Makefile&#39; has modification time 1.8e+06 s in the future</span>”，<span style=\"line-height: 1.42857;\">将系统时间改为当前时间即可</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span>date -s &quot;2015-11-08 15:15:00&quot;</span><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">make</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">3、提示“Newer version of jemalloc required”，“Leaving directory `/data/redis-3.0.5/src&#39;”</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">cd src</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">[root@centos1 src] &nbsp;make MALLOC=libc</span></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">#启动服务并且使用内置客户端测试</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]</span>&nbsp;src/redis-server</span></p><p style=\"white-space: normal;\"><span style=\"line-height: 22.8571px;\">......</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">359:M 08 Nov 15:28:30.429 * The server is now ready to accept connections on port 6379</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">说明启动成功，默认端口是：<strong>6379</strong></span><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]</span>&nbsp;src/redis-cli</p><p style=\"line-height: 22.8571px; white-space: normal;\">redis&gt; set foo bar</p><p style=\"line-height: 22.8571px; white-space: normal;\">OK</p><p style=\"line-height: 22.8571px; white-space: normal;\">redis&gt; get foo</p><p style=\"line-height: 22.8571px; white-space: normal;\">&quot;bar&quot;</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#结语</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">Redis的默认安装比较简单，默认安装启动没有在后台运行；指定配置文件启动可以配置为后台运行，IP、端口、主从配置、安全配置等等</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">#指定配置文件启动</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">redis-3.0.5根目录有一个配置文件example,将后台运行打开</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date] vi&nbsp;/data/redis-3.0.5/redis.conf</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p># By default Redis does not run as a daemon. Use &#39;yes&#39; if you need it.</p><p># Note that Redis will write a pid file in /var/run/redis.pid when daemonized.</p><p><strong>daemonize yes</strong></p><p><br/></p><p>指定配置文件开启服务</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date]&nbsp;</span>src/redis-server /data/redis-3.0.5/redis.conf</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">参考文档</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"http://redis.io/\" target=\"_blank\" title=\"http://redis.io/\">http://redis.io/</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"https://github.com/cinience/RedisStudio/releases\" target=\"_blank\" title=\"https://github.com/cinience/RedisStudio/releases\">https://github.com/cinience/RedisStudio/releases</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html\" target=\"_blank\" title=\"http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html\">http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p><br/></p>",
      "show": "1",
      "channel": "数据存储篇",
      "tag": "Linux",
      "createAt": "2015/12/18 16:10:27",
      "updateAt": "2015/12/18 16:10:27"
    },
    {
      "title": "CentOS 6  Linux 常用配置",
      "content": "<p><strong>关闭防火墙</strong></p><p>service iptables stop</p><p>限制防火墙开机启动</p><p>chkconfig iptables off</p><p>防火墙添加端口规则</p><p>修改/etc/sysconfig/iptables 文件，添加以下内容：</p><p>-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT</p><p><br/></p><p><strong>修改主机名称，重启也生效</strong></p><p>uname -a 查看hostname</p><p>hostname centos1.imethan.cn 修改让hostname立刻生效</p><p>vi /etc/hosts 修改原hostname为 centos1.imethan.cn</p><p>vi &nbsp;/etc/sysconfig/network 修改原hostname为 centos1.imethan.cn,这样可以让reboot重启后也生效</p><p>reboot重启，uname -a 重新检查</p><p><br/></p><p><strong>添加DNS域名转发</strong></p><p>vi /etc/hosts</p><p>添加转发域名记录，例如</p><p>192.168.42.131 www.imethan.cn &nbsp;blog</p><p>#IP地址 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #转发目标域名 &nbsp; &nbsp; &nbsp; #别名</p><p>#hosts文件格式是一行一条记录，分别是IP地址 hostname aliases，三者用空白字符分隔，aliases可选</p><p><br/></p><p><br/></p><p><strong style=\"background-color: inherit;\">修改系统时间</strong></p><p>date -s &quot;2015-11-08 15:15:00&quot;</p><p><br/></p><p><strong>JDK环境变量配置</strong></p><p>#vi /etc/profile</p><p>在最后面加入</p><p>#set java environment</p><p>JAVA_HOME=/usr/java/jdk1.7.0_79</p><p>CLASSPATH=.:$JAVA_HOME/lib.tools.jar</p><p>PATH=$JAVA_HOME/bin:$PATH</p><p>export JAVA_HOME CLASSPATH PATH</p><p>保存退出，是配置马上生效</p><p>source /etc/profile</p><p><br/></p><p><strong>配置SSH免用户名和密码登录</strong></p><p></p><p>ssh-keygen -t rsa -P &#39;&#39;</p><p>scp /home/tungsten/.ssh/id_rsa.pub tungsten@centos1:/home/tungsten/.ssh/authorized_keys</p><p>service sshd restart</p><p><strong><br/></strong><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2015/12/18 17:26:46",
      "updateAt": "2016/1/5 12:13:22"
    },
    {
      "title": "Linux安装配置Tomcat",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">一、安装JAVA运行时环境jre</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">到oracle官网下载“jre-7u79-linux-x64.rpm”，并且安装（使用root账号登录安装）</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">rpm -ivh&nbsp;jre-7u79-linux-x64.rpm</span><br/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">查看默认安装目录&nbsp;</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">find / -name java</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">/usr/java/jre1.7.0_79</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">环境变量配置</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi&nbsp;<span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">/etc/profile</span></span></p><p><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">在profile文件末尾加入：&nbsp;</span><br style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">export JAVA_HOME=/usr/java/jre1.7.0_79&nbsp;</span><br style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">export PATH=$JAVA_HOME/bin:$PATH&nbsp;</span><br style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar&nbsp;</span></span></p><p><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">二、安装配置Tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1、到tomcat官网下载“apache-tomcat-7.0.67-windows-x64.zip”，将安装zip文件上传至/data并且解压</span></p><p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">cd /</span></p><p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">mkdir data</span></p><p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">cd /data</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">unzip&nbsp;apache-tomcat-7.0.67-windows-x64.zip &nbsp;(如果没有unzip命令则安装：yum install unzip)</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">2、解压完成后，为脚本文件授权</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">cd&nbsp;/data/apache-tomcat-7.0.67/bin</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod +x startup.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod +x&nbsp;catalina.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod +x&nbsp;shutdown.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">3、配置server.xml中的URIEncoding编码为：URIEncoding=&quot;utf-8&quot;，</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi&nbsp;/data/apache-tomcat-7.0.67/conf/server.xml</span></p><pre class=\"brush:xml;toolbar:false\">&lt;Connector&nbsp;port=&quot;8080&quot;&nbsp;protocol=&quot;HTTP/1.1&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectionTimeout=&quot;20000&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectPort=&quot;8443&quot;&nbsp;URIEncoding=&quot;utf-8&quot;&nbsp;/&gt;</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">这里同时可以修改默认端口8080为其他未被占用的端口</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">4、为tomcat加大内存配置：编辑catalina.sh添加内存配置，这里最大内存配置为2G</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi&nbsp;/data/apache-tomcat-7.0.67/bin/catalina.sh</span></p><pre class=\"brush:xml;toolbar:false\">JAVA_OPTS=&quot;-server&nbsp;-Xms1600m&nbsp;-Xmx1600m&nbsp;-Xmn533m&nbsp;-XX:PermSize=128m&nbsp;-XX:MaxPermSize=320m\n-XX:NewSize=320m&nbsp;-XX:MaxNewSize=512m&nbsp;-Dfile.encoding=utf-8&quot;</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">至此，tomcat可以开始启动运行工作</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">./startup.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CATALINA_BASE: &nbsp; /data/apache-tomcat-7.0.67</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CATALINA_HOME: &nbsp; /data/apache-tomcat-7.0.67</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CATALINA_TMPDIR: /data/apache-tomcat-7.0.67/temp</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using JRE_HOME: &nbsp; &nbsp; &nbsp; &nbsp;/usr</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CLASSPATH: &nbsp; &nbsp; &nbsp; /data/apache-tomcat-7.0.67/bin/bootstrap.jar:/data/apache-tomcat-7.0.67/bin/tomcat-juli.jar</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Tomcat started.</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">三、其他更多配置<br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1、将tomcat配置为服务启动</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi /etc/init.d/tomcat</span></p><pre class=\"brush:xml;toolbar:false\">#!/bin/bash\n#set&nbsp;startup&nbsp;script&nbsp;for&nbsp;the&nbsp;Tomcat&nbsp;server\n#\n#&nbsp;chkconfig:&nbsp;345&nbsp;80&nbsp;20\n#&nbsp;description:&nbsp;start&nbsp;the&nbsp;tomcat&nbsp;deamon\n#\n#&nbsp;Source&nbsp;function&nbsp;library\n.&nbsp;/etc/rc.d/init.d/functions\n&nbsp;\nprog=tomcat\nJAVA_HOME=/usr/java/jre1.7.0_79\n&nbsp;export&nbsp;JAVA_HOME\nCATALANA_HOME=/data/apache-tomcat-7.0.67\n&nbsp;export&nbsp;CATALINA_HOME\n&nbsp;\ncase&nbsp;&quot;$1&quot;&nbsp;in&nbsp;start)\n&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Starting&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/startup.sh\n&nbsp;&nbsp;&nbsp;&nbsp;;;\n&nbsp;\nstop)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Stopping&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/shutdown.sh\n&nbsp;&nbsp;&nbsp;&nbsp;;;\n&nbsp;\nrestart)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Stopping&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/shutdown.sh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Starting&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/startup.sh\n&nbsp;&nbsp;&nbsp;&nbsp;;;\n&nbsp;*)\n&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Usage:&nbsp;$prog&nbsp;{start|stop|restart}&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;;;&nbsp;esac\nexit&nbsp;0</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"></span><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">为服务启动脚本执行授权</span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">chmod +x /etc/init.d/tomcat</span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><br/></span></p><p><span style=\"font-family:微软雅黑\"><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">检查是否配置成功</span></span></p><p><span style=\"font-family:微软雅黑\"><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">service tomcat start | stop | restart</span></span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><br/></span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">2、配置为开启自动启<br/></span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">chkconfig --add tomcat</span></p><p><br/></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">3、将tomcat目录和服务执行脚本的拥有者分配给非root用户</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">创建用户组tomcat：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">groupadd tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">添加用户并加入组：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">useradd tomcat -g tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">修改tomcat用户密码：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">passwd tomcat</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">给tomcat组用户tomcat分配</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown -R tomcat:tomcat /data/apache-tomcat-7.0.67</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown &nbsp;tomcat:tomcat&nbsp;/etc/init.d/tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod a+x /etc/init.d/tomcat</span></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2016/1/5 10:02:37",
      "updateAt": "2016/1/5 12:15:04"
    },
    {
      "title": "Linux chown命令使用说明",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown命令<br/></span></p><p><span style=\"font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">1、命令格式：</strong><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"></strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown&nbsp;[选项]...&nbsp;[所有者][:[组]]&nbsp;文件...</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><strong style=\"margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\">2、命令功能：</strong></strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;chown命令可以将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户ID；组可以是组名或者组ID；文件以空格分开要改变权限的文件列表，支持通配符。系统管理员经常使用chown命令，在将文件拷贝到另一个用户的名录下之后，让用户拥有使用该文件的权限。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">3、命令参数：</strong><strong style=\"margin: 0px; padding: 0px;\"></strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　<strong style=\"margin: 0px; padding: 0px;\">　必要参数:</strong><strong style=\"margin: 0px; padding: 0px;\"></strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-c&nbsp;显示更改的部分的信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-f&nbsp;忽略错误信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-h&nbsp;修复符号链接</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-R&nbsp;处理指定目录以及其子目录下的所有文件</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-v&nbsp;显示详细的处理信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　-deference&nbsp;作用于符号链接的指向，而不是链接文件本身</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　<strong style=\"margin: 0px; padding: 0px;\">选择参数:</strong><strong style=\"margin: 0px; padding: 0px;\"></strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--reference=&lt;目录或文件&gt;&nbsp;把指定的目录/文件作为参考，把操作的文件/目录设置成参考文件/目录相同拥有者和群组</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--from=&lt;当前用户：当前群组&gt;&nbsp;只有当前用户和群组跟指定的用户和群组相同时才进行改变</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--help&nbsp;显示帮助信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　--version&nbsp;显示版本信息</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">4．使用实例：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　<strong style=\"margin: 0px; padding: 0px;\">实例1：改变拥有者和群组</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown tomcat:tomcat /date/apache-tomcat-7.0.64-8180</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">实例2：改变文件拥有者</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>:&nbsp;log2015.log</span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">实例3：改变文件群组</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown&nbsp;:<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>&nbsp;log2015.log</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">实例4：改变指定目录以及其子目录下的所有文件的拥有者和群组&nbsp;</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"margin: 0px; padding: 0px;\">　　命令：</strong></span></p><p class=\"p0\" style=\"margin: 10px auto; padding: 0px; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">　　　　chown&nbsp;-R&nbsp;-v&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>:<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">tomcat</span>&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.3333px; line-height: 24px; background-color: rgb(255, 255, 255);\">/date/apache-tomcat-7.0.64-8180</span></span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">参考文档</span></p><p><a href=\"http://www.cnblogs.com/peida/archive/2012/12/04/2800684.html\" target=\"_blank\" style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">http://www.cnblogs.com/peida/archive/2012/12/04/2800684.html</span></a> </p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2015/12/31 16:18:06",
      "updateAt": "2016/1/5 12:16:06"
    },
    {
      "title": "Linux tar命令使用说明",
      "content": "<p>linux下最常用的打包程序就是tar了，使用tar程序打出来的包我们常称为tar包，tar包文件的命令通常都是以.tar结尾的。生成tar包后，就可以用其它的程序来进行压缩。</p><p><strong>1．命令格式：</strong></p><p>tar[必要参数][选择参数][文件]&nbsp;</p><p><br/></p><p><strong>2．命令功能：</strong></p><p>用来压缩和解压文件。tar本身不具有压缩功能。他是调用压缩功能实现的&nbsp;</p><p><br/></p><p><strong>3．命令参数</strong>：</p><p>必要参数有如下：</p><p>-A&nbsp;新增压缩文件到已存在的压缩</p><p>-B&nbsp;设置区块大小</p><p>-c&nbsp;建立新的压缩文件</p><p>-d&nbsp;记录文件的差别</p><p>-r&nbsp;添加文件到已经压缩的文件</p><p>-u&nbsp;添加改变了和现有的文件到已经存在的压缩文件</p><p>-x&nbsp;从压缩的文件中提取文件</p><p>-t&nbsp;显示压缩文件的内容</p><p>-z&nbsp;支持gzip解压文件</p><p>-j&nbsp;支持bzip2解压文件</p><p>-Z&nbsp;支持compress解压文件</p><p>-v&nbsp;显示操作过程</p><p>-l&nbsp;文件系统边界设置</p><p>-k&nbsp;保留原有文件不覆盖</p><p>-m&nbsp;保留文件不被覆盖</p><p>-W&nbsp;确认压缩文件的正确性</p><p><br/></p><p>可选参数如下：</p><p>-b&nbsp;设置区块数目</p><p>-C&nbsp;切换到指定目录</p><p>-f&nbsp;指定压缩文件</p><p>--help&nbsp;显示帮助信息</p><p>--version&nbsp;显示版本信息</p><p><br/></p><p><strong>4．常见解压/压缩命令</strong></p><p><strong>tar</strong>&nbsp;<br/></p><p>解包：tar&nbsp;xvf&nbsp;FileName.tar<br style=\"margin: 0px; padding: 0px;\"/>打包：tar&nbsp;cvf&nbsp;FileName.tar&nbsp;DirName<br style=\"margin: 0px; padding: 0px;\"/>（注：tar是打包，不是压缩！）</p><p><br style=\"margin: 0px; padding: 0px;\"/><strong>.gz</strong><br style=\"margin: 0px; padding: 0px;\"/>解压1：gunzip&nbsp;FileName.gz<br style=\"margin: 0px; padding: 0px;\"/>解压2：gzip&nbsp;-d&nbsp;FileName.gz<br style=\"margin: 0px; padding: 0px;\"/>压缩：gzip&nbsp;FileName<br style=\"margin: 0px; padding: 0px;\"/></p><p><br/></p><p><strong>.tar.gz&nbsp;和&nbsp;.tgz</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：tar&nbsp;zxvf&nbsp;FileName.tar.gz<br style=\"margin: 0px; padding: 0px;\"/>压缩：tar&nbsp;zcvf&nbsp;FileName.tar.gz&nbsp;DirName<br style=\"margin: 0px; padding: 0px;\"/><br style=\"margin: 0px; padding: 0px;\"/><strong>.bz2</strong><br style=\"margin: 0px; padding: 0px;\"/>解压1：bzip2&nbsp;-d&nbsp;FileName.bz2<br style=\"margin: 0px; padding: 0px;\"/>解压2：bunzip2&nbsp;FileName.bz2<br style=\"margin: 0px; padding: 0px;\"/>压缩：&nbsp;bzip2&nbsp;-z&nbsp;FileName<br style=\"margin: 0px; padding: 0px;\"/></p><p><br/></p><p><strong>.tar.bz2</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：tar&nbsp;jxvf&nbsp;FileName.tar.bz2<br style=\"margin: 0px; padding: 0px;\"/>压缩：tar&nbsp;jcvf&nbsp;FileName.tar.bz2&nbsp;DirName<br style=\"margin: 0px; padding: 0px;\"/><br style=\"margin: 0px; padding: 0px;\"/><strong>.bz</strong><br style=\"margin: 0px; padding: 0px;\"/>解压1：bzip2&nbsp;-d&nbsp;FileName.bz<br style=\"margin: 0px; padding: 0px;\"/>解压2：bunzip2&nbsp;FileName.bz<br style=\"margin: 0px; padding: 0px;\"/>压缩：未知<br style=\"margin: 0px; padding: 0px;\"/></p><p><br/></p><p><strong>.tar.bz</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：tar&nbsp;jxvf&nbsp;FileName.tar.bz<br style=\"margin: 0px; padding: 0px;\"/>压缩：未知<br style=\"margin: 0px; padding: 0px;\"/><br style=\"margin: 0px; padding: 0px;\"/><strong>.Z</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：uncompress&nbsp;FileName.Z<br style=\"margin: 0px; padding: 0px;\"/>压缩：compress&nbsp;FileName<br style=\"margin: 0px; padding: 0px;\"/></p><p><br/></p><p><strong>.tar.Z</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：tar&nbsp;Zxvf&nbsp;FileName.tar.Z<br style=\"margin: 0px; padding: 0px;\"/>压缩：tar&nbsp;Zcvf&nbsp;FileName.tar.Z&nbsp;DirName<br style=\"margin: 0px; padding: 0px;\"/></p><p><br/></p><p><strong>.zip</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：unzip&nbsp;FileName.zip<br style=\"margin: 0px; padding: 0px;\"/>压缩：zip&nbsp;FileName.zip&nbsp;DirName<br style=\"margin: 0px; padding: 0px;\"/><br style=\"margin: 0px; padding: 0px;\"/><strong>.rar</strong><br style=\"margin: 0px; padding: 0px;\"/>解压：rar&nbsp;x&nbsp;FileName.rar<br style=\"margin: 0px; padding: 0px;\"/>压缩：rar&nbsp;a&nbsp;FileName.rar&nbsp;DirName&nbsp;</p><p><span style=\"margin: 0px; padding: 0px; font-size: 10.5pt; font-family: &#39;Times New Roman&#39;;\"><br/></span></p><p>参考文档</p><p><a href=\"http://www.cnblogs.com/peida/archive/2012/11/30/2795656.html\" target=\"_blank\" textvalue=\"http://www.cnblogs.com/peida/archive/2012/11/30/2795656.html\">http://www.cnblogs.com/peida/archive/2012/11/30/2795656.html</a></p><p><a href=\"http://blog.csdn.net/imyang2007/article/details/7634470\" target=\"_blank\" textvalue=\"http://blog.csdn.net/imyang2007/article/details/7634470\">http://blog.csdn.net/imyang2007/article/details/7634470</a></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2016/1/5 12:23:50",
      "updateAt": "2016/1/5 12:30:36"
    },
    {
      "title": "org.quartz.SchedulerException: Couldn't get host name! [See nested exception: java.net.UnknownHostException:",
      "content": "<p>hostname没有指向IP地址，编辑/etc/hosts，将hostname指向127.0.0.1即可</p><p>vi /etc/hosts</p><pre class=\"brush:xml;toolbar:false\">127.0.0.1&nbsp;&nbsp;&nbsp;localhost&nbsp;localhost.localdomain&nbsp;localhost4&nbsp;localhost4.localdomain4\n::1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localhost&nbsp;localhost.localdomain&nbsp;localhost6&nbsp;localhost6.localdomain6\n127.0.0.1&nbsp;&nbsp;&nbsp;ticket.centerB</pre><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Linux",
      "createAt": "2016/1/12 13:30:28",
      "updateAt": "2016/1/17 23:09:47"
    },
    {
      "title": "nginx反向代理tomcat应用加载不了js问题处理",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>问题描述</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">在Linux上安装nginx进行反向代理至后端的Tomcat WEB应用，出现加载不了js问题，直接访问相关js也发现内容确实只加载了一半，强制刷新无用，依然只有一半。但是直接访问tomcat的80或者8080端口发现是没有问题的。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>问题原因</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Nginx代理之后会有相应的代理缓存区，缓存区默认只有几十K，某些版本的nginx默认设置中没有相关处理，导致部分文件代理是会出现加载不全的现象，其实不仅仅是JS文件。只是因为框架的JS文件略大，所以经常出现类似问题。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>问题解决</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">\t在Nginx.conf中添加 &nbsp; &nbsp; proxy_buffer_size 128k;<br/>\t&nbsp; 　　　　　　　　　 &nbsp; proxy_buffers&nbsp;&nbsp; 32 128k;<br/>\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　 &nbsp;proxy_busy_buffers_size 128k;</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">然后重启nginx，即可。Nginx在代理了相应服务后或根据我们配置的UpStream和location来获取相应的文件，首先文件会被解析到nginx的内存或者临时文件目录中，然后由nginx再来响应。那么当proxy_buffers和proxy_buffer_size以及proxy_busy_buffers_size 都太小时，会将内容根据nginx的配置生成到临时文件中，但是临时文件的大小也有默认值。所以当这四个值都过小时就会导致部分文件只加载一部分。所以要根据我们的服务器情况适当的调整proxy_buffers和proxy_buffer_size以及proxy_busy_buffers_size、proxy_temp_file_write_size。具体几个参数的详细如下</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">proxy_buffers&nbsp;&nbsp; 32 128k;&nbsp; 设置了32个缓存区，每个的大小是128k</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">\tproxy_buffer_size 128k; 每个缓存区的大小是128k，当两个值不一致时没有找到具体哪个有效，建议和上面的设置一致。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">proxy_busy_buffers_size 128k;设置使用中的缓存区的大小，控制传输至客户端的缓存的最大</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">proxy_temp_file_write_size 缓存文件的大小</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><strong><font face=\"微软雅黑, Microsoft YaHei\">参考文档</font></strong></p><p><a href=\"http://www.zving.com/dev/server/257610.shtml\" target=\"_blank\" title=\"http://www.zving.com/dev/server/257610.shtml\"><font face=\"微软雅黑, Microsoft YaHei\">http://www.zving.com/dev/server/257610.shtml</font></a></p><p><font face=\"微软雅黑, Microsoft YaHei\"><br/></font></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2016/3/15 16:13:53",
      "updateAt": "2016/3/15 16:17:48"
    },
    {
      "title": "nginx反向代理转发端口问题",
      "content": "<p>在使用nginx进行反向代理，转发指定的请求的时候没有配置端口转发，导致在程序里面获取不到端口<br/></p><p>没有端口转发的配置：</p><pre class=\"brush:xml;toolbar:false\">upstream&nbsp;server&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;ip_hash;\n&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;192.168.1.100:8080;\n}\n\nserver&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8080;\n&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;&nbsp;server&nbsp;;\n\n&nbsp;&nbsp;&nbsp;&nbsp;charset&nbsp;utf-8;\n\n&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;/&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;&nbsp;&nbsp;html;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;&nbsp;index.html&nbsp;index.htm;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;&nbsp;&nbsp;&nbsp;http://server&nbsp;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_redirect&nbsp;&nbsp;&nbsp;&nbsp;off;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;&nbsp;&nbsp;Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;&nbsp;&nbsp;X-Real-IP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$remote_addr;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;&nbsp;&nbsp;X-Forwarded-For&nbsp;&nbsp;$proxy_add_x_forwarded_for;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_connect_timeout&nbsp;1000;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_read_timeout&nbsp;1000;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_send_timeout&nbsp;1000;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_buffer_size&nbsp;16k;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_buffers&nbsp;4&nbsp;32k;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_busy_buffers_size&nbsp;64k;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;#error_page&nbsp;&nbsp;404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/404.html;\n\n&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;redirect&nbsp;server&nbsp;error&nbsp;pages&nbsp;to&nbsp;the&nbsp;static&nbsp;page&nbsp;/50x.html\n&nbsp;&nbsp;&nbsp;&nbsp;#\n&nbsp;&nbsp;&nbsp;&nbsp;error_page&nbsp;&nbsp;&nbsp;500&nbsp;502&nbsp;503&nbsp;504&nbsp;&nbsp;/50x.html;\n&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;=&nbsp;/50x.html&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;&nbsp;&nbsp;/usr/local/nginx/html;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n}</pre><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">使用该配置，在服务端通过JAVA代码“String uri = request.getRequestURL().toString();”获取URL地址如下，没有端口</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><a href=\"http://192.168.20.2/console/security_check\" _src=\"http://192.168.20.2/console/security_check\">http://192.168.20.2/console/security_check</a></p><p><br/></p><p>需要将配置</p><pre class=\"brush:xml;toolbar:false\">proxy_set_header&nbsp;&nbsp;&nbsp;Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host;</pre><p>改为<br/></p><pre class=\"brush:xml;toolbar:false\">proxy_set_header&nbsp;&nbsp;&nbsp;Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host:$server_port;;</pre><p><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">重新在服务端通过JAVA代码“String uri = request.getRequestURL().toString();”获取URL地址如下，有端口</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><a style=\"white-space: normal;\" href=\"http://192.168.20.2/console/security_check\" _src=\"http://192.168.20.2/console/security_check\">http://192.168.20.2:8080/console/security_check</a></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2016/1/12 11:23:52",
      "updateAt": "2016/3/15 16:19:18"
    },
    {
      "title": "Centos修改root密码 ",
      "content": "<p>[root@localhost ~]# passwd</p><p><span style=\"color:#333333;font-family:宋体, Verdana, sans-serif;font-size:16px\"><span style=\"line-height: 21px;\">Changing password for user root.</span></span></p><p><span style=\"color:#333333;font-family:宋体, Verdana, sans-serif;font-size:16px\"><span style=\"line-height: 21px;\">New password:</span></span></p><p>Retype new password:</p><p>passwd: all authentication tokens updated successfully.</p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Linux",
      "createAt": "2016/7/13 16:50:55",
      "updateAt": "2016/8/15 21:16:16"
    },
    {
      "title": "CentOS 6.7安装Mongodb并且配置用户权限",
      "content": "<p><strong>MongoDB安装</strong></p><p>//添加repo文件</p><p>vi&nbsp;/etc/yum.repos.d/mongodb-org-3.0.repo</p><p>[mongodb-org-3.0]</p><p>name=MongoDB Repository</p><p>baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.0/x86_64/</p><p>gpgcheck=0</p><p>enabled=1</p><p><br/></p><p>//yum安装，安装成功后的默认端口为27017</p><p>yum install -y mongodb-org</p><p><br/></p><p>//启动</p><p>/etc/rc.d/init.d/mongod start|stop|status|restart</p><p><br/></p><p><span style=\"line-height: 1.42857;\">//</span><span style=\"line-height: 22.8571px;\">mongo</span><span style=\"line-height: 1.42857;\">本地连接</span><br/></p><p>mongo</p><p><br/></p><p>//远程连接</p><p>mongo 127.0.0.1/admin -u username -p password</p><p><br/></p><p><strong>开启权限AUTH</strong></p><p>//默认安装启动的mongodb，没有设置auth，开启auth前，创建管理用户：siteUserAdmin、siteRootAdmin</p><p>use admin</p><p>db.createUser({user:&quot;siteUserAdmin&quot;,pwd:&quot;123456&quot;,roles:[{role:&quot;userAdminAnyDatabase&quot;,db:&quot;admin&quot;}]});</p><p>db.createUser({user:&quot;siteRootAdmin&quot;,pwd:&quot;123456&quot;,roles:[{role:&quot;root&quot;,db:&quot;admin&quot;}]});</p><p><br/></p><p>//编辑配置文件，开启auth，并且重启</p><p>vi /etc/mongod.conf</p><p>auth=true</p><p><span style=\"line-height: 22.8571px; white-space: normal;\"></span><span style=\"line-height: 22.8571px; white-space: normal;\">/etc/rc.d/init.d/mongod&nbsp;<span style=\"line-height: 22.8571px; white-space: normal;\">restart</span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><strong>用户权限管理</strong></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">//登录</span></span></p><p><span style=\"line-height: 22.8571px;\">mongo</span></p><p><span style=\"line-height: 22.8571px;\">use admin</span></p><p><span style=\"line-height: 22.8571px;\">useadmindb.auth(&quot;siteRootAdmin&quot;,&quot;123456&quot;);</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\"></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">//查看数据库</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">show dbs</span></p><p><br/></p><p><span style=\"line-height: 22.8571px;\">//创建collection</span></p><p><span style=\"line-height: 22.8571px;\">db.createCollection(&quot;log&quot;)</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\">//插入记录</span><br/></p><p><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">use log</span></span></p><p><span style=\"line-height: 22.8571px;\"></span></p><p>db.loginfo.insert(</p><p>&nbsp; &nbsp;{</p><p>&nbsp; &nbsp; &nbsp;item: &quot;ABC1&quot;,</p><p>&nbsp; &nbsp; &nbsp;details: {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; model: &quot;14Q3&quot;,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; manufacturer: &quot;XYZ Company&quot;</p><p>&nbsp; &nbsp; &nbsp;},</p><p>&nbsp; &nbsp; &nbsp;stock: [ { size: &quot;S&quot;, qty: 25 }, { size: &quot;M&quot;, qty: 50 } ],</p><p>&nbsp; &nbsp; &nbsp;category: &quot;clothing&quot;</p><p>&nbsp; &nbsp;}</p><p>)</p><p>//查看记录</p><p>show collections</p><p><br/></p><p>//查询记录</p><p>db.loginfo.find()</p><p><br/></p><p><span style=\"line-height: 22.8571px;\">//创建用户,mongodb在对应数据创建的用户，只能登录对应的数据库登录</span><span style=\"line-height: 22.8571px;\"></span></p><p><span style=\"line-height: 22.8571px;\">db.createUser({user:&quot;loguser&quot;,pwd:&quot;123456&quot;,roles:[{role:&quot;dbOwner&quot;,db:&quot;log&quot;}]})</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\">//查看用户</span></p><p><span style=\"line-height: 22.8571px;\">show users</span></p><p><span style=\"line-height: 22.8571px;\"><br/></span></p><p><span style=\"line-height: 22.8571px;\">//配置角色</span></p><p>db.grantRolesToUser( &quot;<span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span>&quot; , [ { role: &quot;readWrite&quot;, db: &quot;<span style=\"line-height: 22.8571px; white-space: normal;\">log</span>&quot; } ])&nbsp;</p><p><br/></p><p>//删除角色</p><p>db.revokeRolesFromUser( &quot;<span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span>&quot; , [ { role: &quot;readWrite&quot;, db: &quot;from_mysql&quot; } ]) &nbsp;</p><p><br/></p><p>//查看用户信息</p><p>db.getUser(&quot;loguser&quot;)</p><p><br/></p><p>//查看角色信息</p><p>db.getRole(&quot;readWrite&quot;,{showPrivileges:true})</p><p><span style=\"line-height: 22.8571px;\"><br/></span>//修改密码</p><p>db.changeUserPassword(&quot;<span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span>&quot;,&quot;1234567890&quot;)</p><p><br/></p><p>//删除用户</p><p><span style=\"line-height: 1.42857;\"></span><span style=\"line-height: 1.42857;\">db.dropUser(&quot;</span><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px; white-space: normal;\">loguser</span></span><span style=\"line-height: 1.42857;\">&quot;)</span><br/></p><p><span style=\"line-height: 1.42857;\"><br/></span></p><p><span style=\"line-height: 1.42857;\">//无限制角色用户创建</span></p><p><span style=\"line-height: 1.42857;\">useadmindb.createUser({user:&quot;root&quot;,pwd:&quot;123456&quot;,roles:[&quot;root&quot;]})</span></p><p><span style=\"line-height: 1.42857;\">useadmindb.createUser({user:&quot;system&quot;,pwd:&quot;123456&quot;,roles:[&quot;__system&quot;]})</span></p><p><span style=\"line-height: 1.42857;\"><br/></span></p><p><br/></p><p><span style=\"line-height: 22.8571px;\"><strong>参考</strong></span></p><p><span style=\"line-height: 22.8571px;\"><a href=\"http://docs.mongodb.org/manual/\" target=\"_blank\">http://docs.mongodb.org/manual/</a></span></p><p>//mongo内置角色</p><p><a href=\"http://docs.mongodb.org/manual/reference/built-in-roles/\" target=\"_blank\">http://docs.mongodb.org/manual/reference/built-in-roles/</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">//mongo shell命令参考</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><a href=\"http://docs.mongodb.org/manual/reference/method/\" target=\"_blank\">http://docs.mongodb.org/manual/reference/method/</a></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "MongoDB",
      "createAt": "2015/12/18 16:09:13",
      "updateAt": "2015/12/18 16:09:13"
    },
    {
      "title": "Spring Framework项目集成Spring Data MongoDB",
      "content": "<p><strong>以下简要记录Spring Framework项目集成Spring Data MongoDB的过程步骤</strong></p><p><strong>#首先引入依赖的类库，Spring Framework项目使用的是Gradle构建工具，所以依赖引入如下：</strong></p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;//Spring&nbsp;data&nbsp;mongodb&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;org.springframework.data:spring-data-mongodb:1.8.0.RELEASE&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;com.mysema.querydsl:querydsl-apt:3.6.7&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;com.mysema.querydsl:querydsl-mongodb:3.6.7&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;//Spring&nbsp;data&nbsp;mongodb&nbsp;end\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;//mongodb&nbsp;driver&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;compile&nbsp;&#39;org.mongodb:mongo-java-driver:2.12.3&#39;\n&nbsp;&nbsp;&nbsp;&nbsp;//mongodb&nbsp;driver&nbsp;end\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;//需要引入测试依赖包\n&nbsp;&nbsp;&nbsp;testCompile&nbsp;&#39;org.springframework:spring-test:4.2.1.RELEASE&#39;\n&nbsp;&nbsp;&nbsp;//引入junit依赖包\n&nbsp;&nbsp;&nbsp;testCompile&nbsp;group:&nbsp;&#39;junit&#39;,&nbsp;name:&nbsp;&#39;junit&#39;,&nbsp;version:&nbsp;&#39;4.+&#39;</pre><p><br/></p><p><strong>#添加mongodb配置文件applicationContext-mongodb.xml,配置文件内容如下：</strong></p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;beans&nbsp;xmlns=&quot;http://www.springframework.org/schema/beans&quot;\nxmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&nbsp;xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;\nxmlns:context=&quot;http://www.springframework.org/schema/context&quot;\nxmlns:mongo=&quot;http://www.springframework.org/schema/data/mongo&quot;\nxsi:schemaLocation=&quot;\nhttp://www.springframework.org/schema/beans&nbsp;http://www.springframework.org/schema/beans/spring-beans-4.1.xsd\nhttp://www.springframework.org/schema/aop&nbsp;http://www.springframework.org/schema/aop/spring-aop-4.0.xsd\nhttp://www.springframework.org/schema/context&nbsp;http://www.springframework.org/schema/context/spring-context-4.0.xsd\nhttp://www.springframework.org/schema/data/mongo&nbsp;http://www.springframework.org/schema/data/mongo/spring-mongo-1.8.xsd&quot;&nbsp;\ndefault-lazy-init=&quot;false&quot;&gt;\n&lt;description&gt;applicationContext&lt;/description&gt;\n\n&lt;mongo:mongo&nbsp;host=&quot;${mongo.host}&quot;&nbsp;port=&quot;${mongo.port}&quot;&gt;\n&lt;mongo:options&nbsp;connections-per-host=&quot;${mongo.connectionsPerHost}&quot;\nthreads-allowed-to-block-for-connection-multiplier=&quot;${mongo.threadsAllowedToBlockForConnectionMultiplier}&quot;\nconnect-timeout=&quot;${mongo.connectTimeout}&quot;&nbsp;max-wait-time=&quot;${mongo.maxWaitTime}&quot;\nauto-connect-retry=&quot;${mongo.autoConnectRetry}&quot;&nbsp;socket-keep-alive=&quot;${mongo.socketKeepAlive}&quot;\nsocket-timeout=&quot;${mongo.socketTimeout}&quot;&nbsp;slave-ok=&quot;${mongo.slaveOk}&quot;\nwrite-number=&quot;1&quot;&nbsp;write-timeout=&quot;0&quot;&nbsp;write-fsync=&quot;true&quot;&nbsp;/&gt;\n&lt;/mongo:mongo&gt;\n\n&lt;!--&nbsp;Factory&nbsp;bean&nbsp;that&nbsp;creates&nbsp;the&nbsp;Mongo&nbsp;instance&nbsp;--&gt;\n&lt;mongo:db-factory&nbsp;dbname=&quot;${mongo.databaseName}&quot;&nbsp;mongo-ref=&quot;mongo&quot;&nbsp;username=&quot;${mongo.username}&quot;&nbsp;password=&quot;${mongo.password}&quot;&nbsp;/&gt;\n\n&lt;bean&nbsp;id=&quot;mongoTemplate&quot;&nbsp;class=&quot;org.springframework.data.mongodb.core.MongoTemplate&quot;&gt;\n&lt;constructor-arg&nbsp;name=&quot;mongoDbFactory&quot;&nbsp;ref=&quot;mongoDbFactory&quot;&nbsp;/&gt;\n&lt;/bean&gt;\n\n&lt;mongo:repositories&nbsp;base-package=&quot;cn.imethan&quot;&nbsp;mongo-template-ref=&quot;mongoTemplate&quot;\nbase-class=&quot;cn.imethan.common.mongodb.BaseRepositoryImpl&quot;&nbsp;/&gt;\n\n&lt;!--&nbsp;Use&nbsp;this&nbsp;post&nbsp;processor&nbsp;to&nbsp;translate&nbsp;any&nbsp;MongoExceptions&nbsp;thrown&nbsp;in&nbsp;@Repository&nbsp;annotated&nbsp;classes&nbsp;--&gt;\n&lt;bean&nbsp;class=&quot;org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor&quot;&nbsp;/&gt;\n&lt;!--&nbsp;Enabling&nbsp;Spring&nbsp;Data&nbsp;web&nbsp;support&nbsp;in&nbsp;XML&nbsp;--&gt;\n&lt;bean&nbsp;class=&quot;org.springframework.data.web.config.SpringDataWebConfiguration&quot;&nbsp;/&gt;\n&lt;/beans&gt;</pre><p><br/></p><p><strong>#添加属性配置文件mongo.properties，配置文件内容如下：</strong></p><pre class=\"brush:xml;toolbar:false\">#local&nbsp;mongo&nbsp;db&nbsp;\nmongo.host=127.0.0.1\nmongo.port=27017\nmongo.username=\nmongo.password=\nmongo.databaseName=test\n\nmongo.connectionsPerHost=8\nmongo.threadsAllowedToBlockForConnectionMultiplier=4\nmongo.connectTimeout=1000\nmongo.maxWaitTime=1500\nmongo.autoConnectRetry=true\nmongo.socketKeepAlive=true\nmongo.socketTimeout=1500\nmongo.slaveOk=true</pre><p><br/></p><p><strong>#增加通用基础Repository接口BaseRepository和<span style=\"line-height: 22.8571px;\">Repository</span>接口实现类BaseRepositoryImpl</strong></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;BaseRepository.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年9月30日下午6:06:15\n&nbsp;*/\n@NoRepositoryBean\npublic&nbsp;interface&nbsp;BaseRepository&lt;T,&nbsp;ID&nbsp;extends&nbsp;Serializable&gt;&nbsp;extends&nbsp;MongoRepository&lt;T,&nbsp;ID&gt;&nbsp;{\n/**\n*&nbsp;Get&nbsp;{@link&nbsp;MongoOperations}.\n*&nbsp;@return\n*\n*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n*&nbsp;@datetime&nbsp;2015年10月1日上午5:38:14\n*/\npublic&nbsp;MongoOperations&nbsp;getMongoOperations();\n/**\n*&nbsp;Get&nbsp;{@link&nbsp;MongoEntityInformation}.\n*&nbsp;@return\n*\n*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n*&nbsp;@datetime&nbsp;2015年10月1日上午5:39:49\n*/\npublic&nbsp;MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;getMongoEntityInformation();\n}</pre><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;BaseRepositoryImpl.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年9月30日下午6:08:09\n&nbsp;*/\npublic&nbsp;class&nbsp;BaseRepositoryImpl&lt;T,&nbsp;ID&nbsp;extends&nbsp;Serializable&gt;&nbsp;extends&nbsp;SimpleMongoRepository&lt;T,&nbsp;ID&gt;implements&nbsp;BaseRepository&lt;T,&nbsp;ID&gt;&nbsp;{\n\nprivate&nbsp;MongoOperations&nbsp;mongoOperations;\nprivate&nbsp;MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;metadata;\n\npublic&nbsp;BaseRepositoryImpl(MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;metadata,&nbsp;MongoOperations&nbsp;mongoOperations)&nbsp;{\nsuper(metadata,&nbsp;mongoOperations);\nthis.mongoOperations&nbsp;=&nbsp;mongoOperations;\nthis.metadata&nbsp;=&nbsp;metadata;\n}\n\n@Override\npublic&nbsp;MongoOperations&nbsp;getMongoOperations()&nbsp;{\nreturn&nbsp;mongoOperations;\n}\n\n@Override\npublic&nbsp;MongoEntityInformation&lt;T,&nbsp;ID&gt;&nbsp;getMongoEntityInformation()&nbsp;{\nreturn&nbsp;metadata;\n}\n}</pre><p><br/></p><p><strong>#以上基础配置完成，以下开始测试</strong></p><p><strong>#添加自定义<span style=\"line-height: 22.8571px;\">Repository接口</span></strong><br/></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;ChannelRepository.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@time&nbsp;2014年3月2日下午4:44:45\n&nbsp;*/\n@Repository\npublic&nbsp;interface&nbsp;ChannelRepository&nbsp;extends&nbsp;MongoRepository&lt;Channel,&nbsp;String&gt;,\nChannelRepositoryCustom&lt;Channel,&nbsp;String&gt;,&nbsp;BaseRepository&lt;Channel,&nbsp;String&gt;&nbsp;{\n/**\n*&nbsp;@see&nbsp;http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/\n*\n*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n*&nbsp;@datetime&nbsp;2015年10月1日上午5:21:48\n*/\nLong&nbsp;countByTitle(String&nbsp;title);\nLong&nbsp;deleteByTitle(String&nbsp;title);\n\nList&lt;Channel&gt;&nbsp;removeByTitle(String&nbsp;title);\nList&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title);\nList&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Sort&nbsp;sort);\n\nPage&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\n//Slice&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\n//List&lt;Channel&gt;&nbsp;findByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\nList&lt;Channel&gt;&nbsp;findTop3ByTitle(String&nbsp;title,&nbsp;Pageable&nbsp;pageable);\nList&lt;Channel&gt;&nbsp;findFirst10ByTitle(String&nbsp;title,&nbsp;Sort&nbsp;sort);\n\n\nList&lt;Channel&gt;&nbsp;readAllByTitleNotNull();\n}</pre><p><br/></p><p><strong># Channel类：</strong></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;Channel.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@time&nbsp;2014年3月2日下午4:44:32\n&nbsp;*/\n@Document\npublic&nbsp;class&nbsp;Channel&nbsp;extends&nbsp;BaseDocument&nbsp;implements&nbsp;Serializable{\n\nprivate&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;-3919470868083141326L;\nprivate&nbsp;String&nbsp;title;//标题\nprivate&nbsp;String&nbsp;describe;//描述\n\npublic&nbsp;String&nbsp;getTitle()&nbsp;{\nreturn&nbsp;title;\n}\npublic&nbsp;void&nbsp;setTitle(String&nbsp;title)&nbsp;{\nthis.title&nbsp;=&nbsp;title;\n}\npublic&nbsp;String&nbsp;getDescribe()&nbsp;{\nreturn&nbsp;describe;\n}\npublic&nbsp;void&nbsp;setDescribe(String&nbsp;describe)&nbsp;{\nthis.describe&nbsp;=&nbsp;describe;\n}\n}</pre><p><br/></p><p><strong>#添加单元测试类ChannelRepositoryTest，其中<span style=\"line-height: 22.8571px;\">applicationContext.xml为<span style=\"font-weight: 700; line-height: 22.8571px;\">Spring Framework的配置文件</span></span></strong></p><pre class=\"brush:java;toolbar:false\">/**\n&nbsp;*&nbsp;ChannelRepositoryTest.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@time&nbsp;2014年3月12日下午2:39:27\n&nbsp;*/\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations&nbsp;=&nbsp;{&quot;classpath:/main/applicationContext.xml&quot;,\n&quot;classpath*:/mongodb/applicationContext-mongodb.xml&quot;\n})\npublic&nbsp;class&nbsp;ChannelRepositoryTest&nbsp;{\n@Autowired\nprivate&nbsp;ChannelRepository&nbsp;channelRepository;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Test\npublic&nbsp;void&nbsp;testQuery(){\nString&nbsp;name&nbsp;=&nbsp;channelRepository.getDbName();\nSystem.out.println(&quot;name:&quot;+name);\nPageable&nbsp;&nbsp;pageable&nbsp;&nbsp;=&nbsp;new&nbsp;PageRequest(0,10,Direction.DESC,&quot;createTime&quot;);\nString&nbsp;title&nbsp;=&nbsp;&quot;标题1&quot;;\nlong&nbsp;count&nbsp;=&nbsp;channelRepository.countByTitle(title);\nSystem.out.println(&quot;count:&quot;+count);\nList&lt;Channel&gt;&nbsp;list&nbsp;=&nbsp;channelRepository.findByTitle(title);\nSystem.out.println(&quot;list:&quot;+list);\nList&lt;Channel&gt;&nbsp;list1&nbsp;=&nbsp;channelRepository.findTop3ByTitle(title,&nbsp;pageable);\nSystem.out.println(&quot;list1:&quot;+list1);\nList&lt;Channel&gt;&nbsp;list2&nbsp;=&nbsp;channelRepository.readAllByTitleNotNull();\nSystem.out.println(&quot;list2:&quot;+list2);\nMongoTemplate&nbsp;mongoTemplate&nbsp;=&nbsp;(MongoTemplate)&nbsp;channelRepository.getMongoOperations();\nList&lt;Channel&gt;&nbsp;list3&nbsp;=&nbsp;mongoTemplate.findAll(channelRepository.getMongoEntityInformation().getJavaType());\nSystem.out.println(&quot;list3:&quot;+list3);\nQuery&nbsp;query&nbsp;=&nbsp;new&nbsp;Query(Criteria.where(&quot;title&quot;).is(title));\nUpdate&nbsp;update&nbsp;=&nbsp;new&nbsp;Update().set(&quot;describe&quot;,&nbsp;&quot;随便更新点什么&quot;);\nChannel&nbsp;channel&nbsp;=&nbsp;mongoTemplate.findAndModify(query,&nbsp;update,&nbsp;Channel.class);\nSystem.out.println(&quot;channel:&quot;+channel);\n}\n}</pre><p><br/></p><p><br/></p><p>#参考文档</p><p><a href=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/\" target=\"_blank\" title=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/\">http://docs.spring.io/spring-data/data-mongo/docs/1.8.0.RELEASE/reference/html/</a></p><p><a href=\"http://docs.spring.io/spring/docs/4.1.7.RELEASE/spring-framework-reference/htmlsingle/\" target=\"_blank\" title=\"http://docs.spring.io/spring/docs/4.1.7.RELEASE/spring-framework-reference/htmlsingle/\">http://docs.spring.io/spring/docs/4.1.7.RELEASE/spring-framework-reference/htmlsingle/</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "MongoDB",
      "createAt": "2015/12/18 16:09:32",
      "updateAt": "2016/1/18 16:10:42"
    },
    {
      "title": "通过Spring Data MongoDB向mongoDB GridFs 存储图片",
      "content": "<p><strong>开篇说明</strong><br/></p><p>&nbsp;&nbsp;GridFS会将大文件对象分割成多个小的chunk(文件片段),一般为256k/个,每个chunk将作为mongodb的一个文档(document)被存储在chunks集合中..gridfs模块会为每个文件创建chunks和files信息.每个文件的实际内容被存在chunks(二进制数据)中,和文件有关的meta数据(filename,content_type,还有用户自定义的属性)将会被存在files集合中.files集合中的文档就是BSON格式,可以使用mongodb的索引等等特性。</p><p><span style=\"font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;对于GridFS文件的web访问方式,大家可以搜索一下Gridfs + nginx,既可获取相应的信息..</span></p><p><span style=\"font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; background-color: rgb(255, 255, 255);\"><br/></span></p><p><strong>具体步骤</strong></p><p>1、在applicationContext-mongodb.xml配置文件中添加GridFsTemplate配置：</p><pre class=\"brush:xml;toolbar:false\">\t&lt;!--&nbsp;GridFsTemplate&nbsp;--&gt;\n\t&lt;mongo:mapping-converter&nbsp;id=&quot;converter&quot;&nbsp;/&gt;\n\t&lt;bean&nbsp;class=&quot;org.springframework.data.mongodb.gridfs.GridFsTemplate&quot;&gt;\n\t&nbsp;&nbsp;&nbsp;&nbsp;&lt;constructor-arg&nbsp;ref=&quot;mongoDbFactory&quot;&nbsp;/&gt;\n\t&nbsp;&nbsp;&nbsp;&nbsp;&lt;constructor-arg&nbsp;ref=&quot;converter&quot;&nbsp;/&gt;\n\t&nbsp;&nbsp;&nbsp;&nbsp;&lt;constructor-arg&nbsp;value=&quot;imethan_sys_fs&quot;&nbsp;/&gt;&lt;!--&nbsp;指定GridFS&nbsp;Collections名称&nbsp;--&gt;\n\t&lt;/bean&gt;</pre><p><br/></p><p>2、创建文件存取测试客户端，代码如下：</p><pre class=\"brush:java;toolbar:false\">package&nbsp;cn.imethan.mongodb;\n\nimport&nbsp;java.io.FileInputStream;\nimport&nbsp;java.io.FileNotFoundException;\nimport&nbsp;java.io.IOException;\nimport&nbsp;java.io.InputStream;\nimport&nbsp;java.util.List;\n\nimport&nbsp;org.junit.Test;\nimport&nbsp;org.junit.runner.RunWith;\nimport&nbsp;org.springframework.beans.factory.annotation.Autowired;\nimport&nbsp;org.springframework.data.mongodb.core.query.Criteria;\nimport&nbsp;org.springframework.data.mongodb.core.query.Query;\nimport&nbsp;org.springframework.data.mongodb.gridfs.GridFsOperations;\nimport&nbsp;org.springframework.test.context.ContextConfiguration;\nimport&nbsp;org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\n\nimport&nbsp;com.mongodb.BasicDBObject;\nimport&nbsp;com.mongodb.DBObject;\nimport&nbsp;com.mongodb.gridfs.GridFSDBFile;\nimport&nbsp;com.mongodb.gridfs.GridFSFile;\n\n/**\n&nbsp;*&nbsp;GridFsClient.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2016年1月18日下午3:03:02\n&nbsp;*/\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations&nbsp;=&nbsp;{&nbsp;&quot;classpath:/main/applicationContext.xml&quot;,&nbsp;&quot;classpath:/mongodb/applicationContext-mongodb.xml&quot;&nbsp;})\npublic&nbsp;class&nbsp;GridFsClient&nbsp;{\n\t\n\t@Autowired\n\tprivate&nbsp;GridFsOperations&nbsp;gridFsOperations;\n\t\n\t/**\n\t&nbsp;*&nbsp;保存测试\n\t&nbsp;*&nbsp;\n\t&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n\t&nbsp;*&nbsp;@datetime&nbsp;2016年1月18日下午3:51:28\n\t&nbsp;*/\n\t@Test\n\tpublic&nbsp;void&nbsp;storeFileToGridFs()&nbsp;{\n\t\tDBObject&nbsp;metaData&nbsp;=&nbsp;new&nbsp;BasicDBObject();\n\t\tmetaData.put(&quot;extra1&quot;,&nbsp;&quot;anything&nbsp;1&quot;);\n\t\tmetaData.put(&quot;extra2&quot;,&nbsp;&quot;anything&nbsp;2&quot;);\n\t\tInputStream&nbsp;inputStream&nbsp;=&nbsp;null;\n\t\ttry&nbsp;{\n\t\t\tinputStream&nbsp;=&nbsp;new&nbsp;FileInputStream(&quot;C:/Users/ETHAN/Pictures/e.png&quot;);\n\t\t\tGridFSFile&nbsp;gridFSFile&nbsp;=&nbsp;gridFsOperations.store(inputStream,&nbsp;&quot;e.png&quot;,&nbsp;&quot;image/png&quot;,&nbsp;metaData);\n\t\t\tSystem.out.println(&quot;gridFSFile:&quot;+gridFSFile.toString());\n\t\t}&nbsp;catch&nbsp;(FileNotFoundException&nbsp;e)&nbsp;{\n\t\t\te.printStackTrace();\n\t\t}&nbsp;finally&nbsp;{\n\t\t\tif&nbsp;(inputStream&nbsp;!=&nbsp;null)&nbsp;{\n\t\t\t\ttry&nbsp;{\n\t\t\t\t\tinputStream.close();\n\t\t\t\t}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(&quot;Done&quot;);\n\t}\n\t\n\t/**\n\t&nbsp;*&nbsp;读取测试\n\t&nbsp;*&nbsp;\n\t&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n\t&nbsp;*&nbsp;@datetime&nbsp;2016年1月18日下午3:51:28\n\t&nbsp;*/\n\t@Test\n\tpublic&nbsp;void&nbsp;findFilesInGridFs()&nbsp;{\n\t\tList&lt;GridFSDBFile&gt;&nbsp;result&nbsp;=&nbsp;gridFsOperations.find(new&nbsp;Query().addCriteria(Criteria.where(&quot;filename&quot;).is(&quot;e.png&quot;)));\n\t\tfor&nbsp;(GridFSDBFile&nbsp;file&nbsp;:&nbsp;result)&nbsp;{\n\t\t\ttry&nbsp;{\n\t\t\t\tSystem.out.println(file.getFilename());\n\t\t\t\tSystem.out.println(file.getContentType());\n\t\t\t\t//save&nbsp;as&nbsp;another&nbsp;image\n\t\t\t\tfile.writeTo(&quot;C:/Users/ETHAN/Pictures/e1.png&quot;);\n\t\t\t}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(&quot;Done&quot;);\n\t}\n}</pre><p><br/></p><p>3、登录mongoDB查看结果</p><p>db.getCollection(&#39;imethan_sys_file.files&#39;).find({})</p><pre class=\"brush:xml;toolbar:false\">/*&nbsp;1&nbsp;*/\n{\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;_id&quot;&nbsp;:&nbsp;ObjectId(&quot;569c9831c6a346b44944e6e8&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;chunkSize&quot;&nbsp;:&nbsp;NumberLong(261120),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;length&quot;&nbsp;:&nbsp;NumberLong(3327),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;md5&quot;&nbsp;:&nbsp;&quot;879a908fd59d7419b42d43e389886a0b&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;filename&quot;&nbsp;:&nbsp;&quot;e.png&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;contentType&quot;&nbsp;:&nbsp;&quot;image/png&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;uploadDate&quot;&nbsp;:&nbsp;ISODate(&quot;2016-01-18T07:45:53.828Z&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;aliases&quot;&nbsp;:&nbsp;null,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;metadata&quot;&nbsp;:&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;extra1&quot;&nbsp;:&nbsp;&quot;anything&nbsp;1&quot;,\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;extra2&quot;&nbsp;:&nbsp;&quot;anything&nbsp;2&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p><br/></p><p>db.getCollection(&#39;imethan_sys_file.chunks&#39;).find({})</p><pre class=\"brush:xml;toolbar:false\">/*&nbsp;1&nbsp;*/\n{\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;_id&quot;&nbsp;:&nbsp;ObjectId(&quot;569c9831c6a346b44944e6e9&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;files_id&quot;&nbsp;:&nbsp;ObjectId(&quot;569c9831c6a346b44944e6e8&quot;),\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;n&quot;&nbsp;:&nbsp;0,\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;data&quot;&nbsp;:&nbsp;{&nbsp;&quot;$binary&quot;&nbsp;:&nbsp;&quot;iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAipJREFUeNrs3T9LHEEcxvHnt3/ucmoai5CkFCGNYCH4BmySKm0qy7R5HemSMkWaEF9ASJE3IIiIyCFY2SmJQVAMMR53N7Np0gXB3dvxZve+T7+w87mZ3wwzw62tfShE7pYEArDAAgsssMCCACywwAILLLAgAAsssBqUrOwDg7Fcw7cLU9ODLDzWyGtzVcuLKhrrZabjC20dKk8CYzmvjSWtPWl2z9r/oU/9KlhJhWHY9FRuAgUeLLDAmkK6WcUHs9Bvdv5H/TOl0fwoienoXKlFidX/qddf1cvjWpR20iixUlMvVy9rw/ilwIMFFlhggUXAAgsssMACi4AFFlhgNSnBN+Wc1/UoihPsXi6LHOvxgl4+q7iNW2NGTrunGjqZRYy18kjvn0+/Ww2dXnzWzVjZBFizUrMGY01eCSjwYIEF1j2lluk4+Gx4PdLZ70kXODW8xlC+iH6dtfddb75N/0S6kJyf9MpF8Eb4QkNX8SJGzRXHoh+GJiVWw4tS4MECi4AFFlhggQUWAQsssMACCywCVrnM0E7p/0mt3EZzcKz5jpYXK/6PQtCYdDXQ5aDELm7wRqw/1ZdXkQ6rjwd6t6OH3WiwEpv+FZpbG1+yYs90gS97a4zZEKxIsNpxAvhvQizZltIFfuzlvIpWSDkfEqub6u225vJWdCvp4kbznWBYZjr5Jd+WbxNkoVfw+QxPCcyGYIEFFlhgEbDAAgsssMAiYIEFFlhNyt8BAPkOZG4vtuN7AAAAAElFTkSuQmCC&quot;,&nbsp;&quot;$type&quot;&nbsp;:&nbsp;&quot;00&quot;&nbsp;}\n}</pre><p><br/></p><p><strong>参考文档</strong><br/></p><p><a href=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.2.RELEASE/reference/html/#gridfs\" target=\"_blank\" textvalue=\"http://docs.spring.io/spring-data/data-mongo/docs/1.8.2.RELEASE/reference/html/#gridfs\"><strong>http://docs.spring.io/spring-data/data-mongo/docs/1.8.2.RELEASE/reference/html/#gridfs</strong></a></p><p><a href=\"http://www.mkyong.com/mongodb/spring-data-mongodb-save-binary-file-gridfs-example/\" target=\"_blank\" textvalue=\"http://www.mkyong.com/mongodb/spring-data-mongodb-save-binary-file-gridfs-example/\">http://www.mkyong.com/mongodb/spring-data-mongodb-save-binary-file-gridfs-example/</a><br/></p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "MongoDB",
      "createAt": "2016/1/18 15:27:46",
      "updateAt": "2016/1/18 16:28:38"
    },
    {
      "title": "关于mongoDB的一些常用查询语句",
      "content": "<p>模糊查询：</p><p>db.collectionsName.find({&quot;tname&quot;: {$regex: &#39;测试&#39;, $options:&#39;i&#39;}})&nbsp;</p><p>db.collectionsName.find({&quot;tname&quot;: {$regex:/测试.*/i}})&nbsp;</p><p><br/></p><p>降序排序：</p><p>db.collectionsName.find({}}).sort({&quot;createAt&quot;:-1})</p><p><br/></p><p style=\"white-space: normal;\">升序排序：</p><p style=\"white-space: normal;\">db.collectionsName.find({}}).sort({&quot;createAt&quot;:1})</p><p><br/></p>",
      "show": "1",
      "channel": "mongoDB笔记",
      "tag": "MongoDB",
      "createAt": "2017/8/31 10:57:44",
      "updateAt": "2017/8/31 13:55:03"
    },
    {
      "title": "CentOS 6.7上安装Redis 3.0.5",
      "content": "<p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">在CentOS 6.7上安装Redis 3.0.5</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#Redis是什么？</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">Redis是一个key-value存储系统。和Memcached类似，它支持存储的value类型相对更多，包括string(字符串)、list(链表)、set(集合)、zset(sorted set --有序集合)和hash（哈希类型）。这些数据类型都支持push/pop、add/remove及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。在此基础上，redis支持各种不同方式的排序。与memcached一样，为了保证效率，数据都是缓存在内存中。区别的是redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#wget获取安装包并且安装</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] wget http://download.redis.io/releases/redis-3.0.5.tar.gz</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] tar xzf redis-3.0.5.tar.gz</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 data] cd redis-3.0.5</p><p style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date] make</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#安装过程中遇到的问题</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">1、提示没有“<span style=\"line-height: 22.8571px;\">CC</span>”编译器，于是安装“GCC”编译器</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span>yum install gcc</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">make</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\">2、提示“<span style=\"color: rgb(0, 0, 0); font-family: Simsun; font-size: 14px; line-height: 20px;\">File `Makefile&#39; has modification time 1.8e+06 s in the future</span>”，<span style=\"line-height: 1.42857;\">将系统时间改为当前时间即可</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span>date -s &quot;2015-11-08 15:15:00&quot;</span><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">make</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">3、提示“Newer version of jemalloc required”，“Leaving directory `/data/redis-3.0.5/src&#39;”</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]&nbsp;</span><span style=\"line-height: 22.8571px;\">cd src</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">[root@centos1 src] &nbsp;make MALLOC=libc</span></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">#启动服务并且使用内置客户端测试</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]</span>&nbsp;src/redis-server</span></p><p style=\"white-space: normal;\"><span style=\"line-height: 22.8571px;\">......</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">359:M 08 Nov 15:28:30.429 * The server is now ready to accept connections on port 6379</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\">说明启动成功，默认端口是：<strong>6379</strong></span><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px;\">[root@centos1 date]</span>&nbsp;src/redis-cli</p><p style=\"line-height: 22.8571px; white-space: normal;\">redis&gt; set foo bar</p><p style=\"line-height: 22.8571px; white-space: normal;\">OK</p><p style=\"line-height: 22.8571px; white-space: normal;\">redis&gt; get foo</p><p style=\"line-height: 22.8571px; white-space: normal;\">&quot;bar&quot;</p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">#结语</span></p><p style=\"line-height: 22.8571px; white-space: normal;\">Redis的默认安装比较简单，默认安装启动没有在后台运行；指定配置文件启动可以配置为后台运行，IP、端口、主从配置、安全配置等等</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">#指定配置文件启动</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\">redis-3.0.5根目录有一个配置文件example,将后台运行打开</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date] vi&nbsp;/data/redis-3.0.5/redis.conf</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p># By default Redis does not run as a daemon. Use &#39;yes&#39; if you need it.</p><p># Note that Redis will write a pid file in /var/run/redis.pid when daemonized.</p><p><strong>daemonize yes</strong></p><p><br/></p><p>指定配置文件开启服务</p><p><span style=\"line-height: 22.8571px; white-space: normal;\">[root@centos1 date]&nbsp;</span>src/redis-server /data/redis-3.0.5/redis.conf</p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><span style=\"font-weight: 700;\"><br/></span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 1.42857;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700;\">参考文档</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"http://redis.io/\" target=\"_blank\" title=\"http://redis.io/\">http://redis.io/</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"https://github.com/cinience/RedisStudio/releases\" target=\"_blank\" title=\"https://github.com/cinience/RedisStudio/releases\">https://github.com/cinience/RedisStudio/releases</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><a href=\"http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html\" target=\"_blank\" title=\"http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html\">http://www.cnblogs.com/shanyou/archive/2012/01/28/2330451.html</a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p><br/></p>",
      "show": "1",
      "channel": "数据存储篇",
      "tag": "Redis",
      "createAt": "2015/12/18 16:10:27",
      "updateAt": "2015/12/18 16:10:27"
    },
    {
      "title": "Tomcat使用Redis缓存实现分布式Session共享",
      "content": "<p>前置场景描述</p><p>&nbsp;&nbsp;&nbsp; 在两台linux服务器上分别安装Tomcat，并且部署相同的WEB应用，通过前置服务器的nginx反向代理，达到这两个Tomcat的负载均衡的目的，实现分布式部署；当发生单点故障或者临时停机，nginx会将用户当前访问的WEB应用切换到其他正常服务器到应用上，这个时候如果session不同步，则会导致用户会话超时，提示再次登录的现象，会给用户产生非常不好的体验。</p><p>所以出现了Tocmat Session共享的课题，用于解决session不同步，应用切换时会话超时的问题。</p><p>&nbsp;&nbsp;&nbsp; Tomcat Session共享的实现方式有多种，例如使用memcache、mongodb、redis等，本文主要针对使用redis来实现Tomcat的Session共享。</p><p><br/></p><p>实际操作步骤</p><p>1、访问<a _src=\"https://github.com/jcoleman/tomcat-redis-session-manager/releases\" href=\"https://github.com/jcoleman/tomcat-redis-session-manager/releases\">https://github.com/jcoleman/tomcat-redis-session-manager/releases</a> ，下载&quot;1.2-tomcat-7-java-7.zip&quot;并解压后将项目导入Eclipse，构建成功，并且导出“tomcat-redis-session-manager-1.2-tomcat-7.jar”</p><p><br/></p><p>2、将如下jar包放到tomcat的lib目录下</p><p>tomcat-redis-session-manager-1.2-tomcat-7.jar</p><p>commons-pool2-2.2.jar</p><p>jedis-2.5.2.jar</p><p>tomcat-juli-7.0.27.jar</p><p><br/></p><p>3、编辑tomcat配置文件context.xml，加入如下内容</p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;Valve&nbsp;className=&quot;com.radiadesign.catalina.session.RedisSessionHandlerValve&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;Manager&nbsp;className=&quot;com.radiadesign.catalina.session.RedisSessionManager&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host=&quot;localhost&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=&quot;6379&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;database=&quot;0&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxInactiveInterval=&quot;60&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&gt;</pre><p><br/></p><p>这里使用的是本机默认安装的redis</p><p><br/></p><p>4、启动tomcat并且访问应用，查看redis缓存内容如下</p><p>127.0.0.1:6379&gt; get 33B32CE273EE4375C78B75CD8BE684DA<br/>&quot;\\xac\\xed\\x00\\x05sr\\x00Ncn.zblink.framework.redis.session.manager.tomcat7.SessionSerializationMetadata\\xdea\\xb1\\n\\x9a\\xcdn\\xff\\x03\\x00\\x01[\\x00\\x15sessionAttributesHasht\\x00\\x02[Bxpw\\x14\\x00\\x00\\x00\\x10V\\x1b\\x96:\\xe1r\\x97_m&#39;k\\xbb\\xca\\xeb\\x0e\\x1axsr\\x00\\x0ejava.lang.Long;\\x8b\\xe4\\x90\\xcc\\x8f#\\xdf\\x02\\x00\\x01J\\x00\\x05valuexr\\x00\\x10java.lang.Number\\x86\\xac\\x95\\x1d\\x0b\\x94\\xe0\\x8b\\x02\\x00\\x00xp\\x00\\x00\\x01RDC\\&quot;\\x02sq\\x00~\\x00\\x03\\x00\\x00\\x01RDC\\&quot;\\x02sr\\x00\\x11java.lang.Integer\\x12\\xe2\\xa0\\xa4\\xf7\\x81\\x878\\x02\\x00\\x01I\\x00\\x05valuexq\\x00~\\x00\\x04\\x00\\x00\\a\\bsr\\x00\\x11java.lang.Boolean\\xcd r\\x80\\xd5\\x9c\\xfa\\xee\\x02\\x00\\x01Z\\x00\\x05valuexp\\x01q\\x00~\\x00\\nsq\\x00~\\x00\\x03\\x00\\x00\\x01RDC\\&quot;\\x03t\\x00 33B32CE273EE4375C78B75CD8BE684DAsq\\x00~\\x00\\a\\x00\\x00\\x00\\x01t\\x00\\x15justForSessionTestKeyq\\x00~\\x00\\x0ew\\b\\x00\\x00\\x01RDC\\&quot;\\x02&quot;<br/>127.0.0.1:6379&gt;</p><p><br/></p><p>参考文档：</p><p>https://github.com/jcoleman/tomcat-redis-session-manager</p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Redis",
      "createAt": "2016/1/15 15:23:42",
      "updateAt": "2016/1/15 15:52:57"
    },
    {
      "title": "Redis常用命令速查",
      "content": "<p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">参考文档</span></p><p style=\"white-space: normal;\"><a href=\"http://redis.io/commands\" target=\"_blank\" style=\"text-decoration: underline; font-family: 微软雅黑,&quot;Microsoft YaHei&quot;;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">http://redis.io/commands</span></a></p><p><a style=\"text-decoration: none;\" href=\"http://redis.io/commands\" target=\"_blank\"><span style=\"text-decoration: none; color: rgb(0, 0, 0);\"><span style=\"color: rgb(0, 0, 0); text-decoration: none; font-family: 微软雅黑,&quot;Microsoft YaHei&quot;;\">Redi</span>s应用场景</span><br/></a></p><p style=\"white-space: normal;\"><a textvalue=\"http://www.cnblogs.com/shanyou/archive/2012/09/04/2670972.html\" target=\"_blank\" href=\"http://redis.io/commands\">http://www.cnblogs.com/shanyou/archive/2012/09/04/2670972.html</a></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Redis",
      "createAt": "2016/1/6 10:10:04",
      "updateAt": "2016/1/29 23:06:53"
    },
    {
      "title": "Hibernate hql 查询语句",
      "content": "<p><strong style=\"line-height: 1.42857;\">#many to many&nbsp;</strong><br/></p><p>实体:User(List&lt;Application&gt;&nbsp;<span style=\"line-height: 22.8571px;\">applicationList</span>),<span style=\"line-height: 22.8571px;\">Application</span></p><p>select u from User u inner join u.applicationList a where a.id=:applicationId;</p><p><br/></p><p><strong>#like</strong></p><p>from User u where u.username like &#39;%param%&#39;;</p><p><br/></p><p>未完待续~</p><p><br/></p><p><strong>参考文档</strong></p><p><a href=\"http://www.cnblogs.com/bobomail/archive/2005/09/20/240352.html\" target=\"_self\" title=\"http://www.cnblogs.com/bobomail/archive/2005/09/20/240352.html\">http://www.cnblogs.com/bobomail/archive/2005/09/20/240352.html</a></p><p><br/></p>",
      "show": "1",
      "channel": "Hibernate专题",
      "tag": "Hibernate",
      "createAt": "2015/12/18 16:13:10",
      "updateAt": "2015/12/29 22:03:52"
    },
    {
      "title": "Hibernate基础知识汇总",
      "content": "<p><span style=\"color:#7f7f7f;font-family:微软雅黑, Microsoft YaHei\"><strong>一、Hibernate缓存机制</strong></span></p><p><span style=\"color:#7f7f7f;font-family:微软雅黑, Microsoft YaHei\">hibernate缓存分为会话缓存（session）和工厂缓存(sessionFactory)，即一级缓存和二级缓存；一级缓存是session级别的，是私有缓存，在session里面根据ID获取实体；二级缓存是<span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">sessionFactory级别的，即服务应用级别，是共享缓存，也是根据ID来获取实体；如果想将list也缓存至二级缓存，则需要开启查询缓存，查询缓存是缓存相同sql语句的list信息，即只有sql语句相同的才会去读取查询缓存，如果查询信息多变的话，缓存命中率比较低，所以一般不开启查询缓存。</span></span></p><p><span style=\"color:#7f7f7f;font-family:微软雅黑, Microsoft YaHei\">参考文档如下：</span></p><p><span style=\"color:#7f7f7f;font-family:微软雅黑, Microsoft YaHei\"><a href=\"http://blog.csdn.net/dongnan591172113/article/details/7943652\" target=\"_blank\">http://blog.csdn.net/dongnan591172113/article/details/7943652</a></span></p><p><a href=\"http://www.blogjava.net/tbwshc/articles/380013.html\" target=\"_blank\">http://www.blogjava.net/tbwshc/articles/380013.html</a> </p><p><br/></p><p><span style=\"color: rgb(127, 127, 127);\"><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">二、Hibernate get和load区别</span></strong></span></p><p><span style=\"color: rgb(127, 127, 127);\"><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;\">get和load的根本区别：</span></span></p><p><span style=\"color: rgb(127, 127, 127);\"><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;\">hibernate对于load方法认为该数据在数据库中一定存在，可以放心的使用代理来延迟加载，如果在使用过程中发现了问题，只能抛org.hibernate.ObjectNotFoundException异常；</span></span></p><p><span style=\"color: rgb(127, 127, 127);\"><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;\">而对于get方法，hibernate一定要获取到真实的数据，否则返回null。</span></span><br/></p><p><a href=\"http://www.cnblogs.com/binjoo/articles/1621254.html\" target=\"_blank\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\">http://www.cnblogs.com/binjoo/articles/1621254.html</span></a></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\">&nbsp;</span></p><p><span style=\"color: rgb(127, 127, 127);\"><strong><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">三、Hibernate 级联cascade和关系维持inverse</span></strong></span></p><p><a href=\"http://418684644-qq-com.iteye.com/blog/1199068\" target=\"_blank\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\">http://418684644-qq-com.iteye.com/blog/1199068</span></a></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\"><br/></span></p><p><br/></p>",
      "show": "1",
      "channel": "Hibernate专题",
      "tag": "Hibernate",
      "createAt": "2015/12/29 22:04:07",
      "updateAt": "2016/1/7 11:21:06"
    },
    {
      "title": "Hibernate Search 教程",
      "content": "<p>参考文档</p><p><a _src=\"http://hibernate.org/search/\" href=\"http://hibernate.org/search/\">http://hibernate.org/search/</a><br/></p><p><a _src=\"http://isoloist.iteye.com/blog/856888\" href=\"http://isoloist.iteye.com/blog/856888\">http://isoloist.iteye.com/blog/856888</a></p><p><a _src=\"http://isoloist.iteye.com/blog/856888\" href=\"http://isoloist.iteye.com/blog/856888\">http://fehly.iteye.com/blog/650523</a></p><p><a _src=\"http://isoloist.iteye.com/blog/856888\" href=\"http://isoloist.iteye.com/blog/856888\"></a><br/></p><p><br/></p>",
      "show": "0",
      "channel": "Hibernate专题",
      "tag": "Hibernate",
      "createAt": "2016/1/29 22:02:51",
      "updateAt": "2016/1/29 22:41:46"
    },
    {
      "title": "JAVA实现Base64编码和解码以及遇到的问题",
      "content": "<p><strong>Java实现BASE64编解码</strong></p><p>BASE64和其他相似的编码算法通常用于转换二进制数据为文本数据，其目的是为了简化存储或传输。更具体地说，BASE64算法主要用于转换二进制数据为ASCII字符串格式。Java语言提供了一个非常好的BASE64算法的实现，即Apache Commons Codec工具包。本文将简要地讲述怎样使用BASE64以及它是怎样工作的。</p><p>下面我们用BASE64对字符串进行编码：</p><p><span style=\"white-space: nowrap;\">import java.io.UnsupportedEncodingException;</span></p><p><span style=\"white-space: nowrap;\">import org.apache.commons.codec.binary.Base64;</span></p><p><span style=\"white-space: nowrap;\">public class Base64Test {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static void main(String[] args){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String str = &quot;Hello World&quot;;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>byte[] encodeBase64 = Base64.encodeBase64(str.getBytes(&quot;UTF-8&quot;));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>System.out.println(&quot;RESULT: &quot; + new String(encodeBase64));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch(UnsupportedEncodingException e){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">输出结果为：<span style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 0, 0); font-family: Consolas, &#39;Courier New&#39;, Courier, mono, serif; font-size: 12px; line-height: 18px; white-space: normal;\"><span id=\"_baidu_bookmark_start_6\" style=\"display: none; line-height: 0px;\">‍</span></span></span><span id=\"_baidu_bookmark_start_8\" style=\"display: none; line-height: 0px;\">‍</span>RESULT:&nbsp;SGVsbG8gV29ybGQ=<span id=\"_baidu_bookmark_end_9\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"white-space: nowrap;\"><span style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 0, 0); font-family: Consolas, &#39;Courier New&#39;, Courier, mono, serif; font-size: 12px; line-height: 18px; white-space: normal;\"><span id=\"_baidu_bookmark_end_7\" style=\"display: none; line-height: 0px;\">‍</span></span></span></p><p><br/></p><p>上面输出的字符串是“Hello world”字符串的8位二进制值被连接在一起，然后以6位分组。随后每个组都被转换成一个单独的数字并映射到Base64的索引。</p><p><br/></p><p><span style=\"color: rgb(102, 102, 102); font-family: Georgia; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_3\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_5\" style=\"display: none; line-height: 0px;\">‍</span>一个英文字符占8bit（二进位制信息单位），占1Byte（&nbsp;字节；8位元组）。<br style=\"color: rgb(102, 102, 102); font-family: Georgia; font-size: 14px; line-height: 24px; white-space: normal;\"/>一个汉字用ASCII编码占16bit，占2Byte。<span id=\"_baidu_bookmark_end_6\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(102, 102, 102); font-family: Georgia; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_4\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><br/></p><p><span style=\"white-space: nowrap;\">binary<span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>dec Base64</span></p><p><span style=\"white-space: nowrap;\">010010 &nbsp;18 &nbsp;S</span></p><p><span style=\"white-space: nowrap;\">000110 &nbsp;6 &nbsp; G</span></p><p><span style=\"white-space: nowrap;\">010101 &nbsp;21 &nbsp;V</span></p><p><span style=\"white-space: nowrap;\">101100 &nbsp;44 &nbsp;s</span></p><p><span style=\"white-space: nowrap;\">011011 &nbsp;27 &nbsp;b</span></p><p><span style=\"white-space: nowrap;\">000110 &nbsp;6 &nbsp; G</span></p><p><span style=\"white-space: nowrap;\">111100 &nbsp;60 &nbsp;8</span></p><p><span style=\"white-space: nowrap;\">100000 &nbsp;32 &nbsp;g</span></p><p><span style=\"white-space: nowrap;\">010101 &nbsp;29 &nbsp;d</span></p><p><span style=\"white-space: nowrap;\">110110 &nbsp;54 &nbsp;2</span></p><p><span style=\"white-space: nowrap;\">111101 &nbsp;61 &nbsp;9</span></p><p><span style=\"white-space: nowrap;\">110010 &nbsp;50 &nbsp;y</span></p><p><span style=\"white-space: nowrap;\">011011 &nbsp;27 &nbsp;b</span></p><p><span style=\"white-space: nowrap;\">000110 &nbsp;6 &nbsp; G</span></p><p><span style=\"white-space: nowrap;\">010000 &nbsp;16 &nbsp;Q</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p>注意：字符串最后加上了“=”，其意思表示字符串编码的结束。</p><p><br/></p><p><strong>网络传输中遇到的问题</strong></p><p><span id=\"_baidu_bookmark_start_23\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_25\" style=\"display: none; line-height: 0px;\">‍</span>webservice数据交互采用base64编码进行数据传输，在UrlEncode过程中会将“+”转码为“%2b”、“=”转码为“%3d”，webservice接收端如果没对转码后的数据再次处理，而是直接进行base64位解码会导致解码失败，出现乱码。</p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><br/></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_48\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_50\" style=\"display: none; line-height: 0px;\">‍</span>#源字符串</p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_52\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_54\" style=\"display: none; line-height: 0px;\">‍</span>String string = {&quot;username&quot;:&quot;ethan001&quot;,&quot;roleid&quot;:&quot;14&quot;,&quot;extend&quot;:&quot;{\\&quot;sex\\&quot;:\\&quot;1\\&quot;,\\&quot;age\\&quot;:\\&quot;23\\&quot;}&quot;,&quot;secret&quot;:&quot;6e681327fc9745bbab1be80d5deee9da&quot;,&quot;realname&quot;:&quot;中文测试&quot;,&quot;password&quot;:&quot;123456&quot;}<span id=\"_baidu_bookmark_end_55\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_53\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_end_51\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_49\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><br/></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_60\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_62\" style=\"display: none; line-height: 0px;\">‍</span>#经过Base64编码的字符串<span id=\"_baidu_bookmark_end_63\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_61\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_56\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_58\" style=\"display: none; line-height: 0px;\">‍</span>String base64String = eyJ1c2VybmFtZSI6ImV0aGFuMDAxIiwicm9sZWlkIjoiMTQiLCJleHRlbmQiOiJ7XCJzZXhcIjpcIjFcIixcImFnZVwiOlwiMjNcIn0iLCJzZWNyZXQiOiI2ZTY4MTMyN2ZjOTc0NWJiYWIxYmU4MGQ1ZGVlZTlkYSIsInJlYWxuYW1lIjoi5Lit5paH5rWL6K<span style=\"color:#ff0000\">+</span>VIiwicGFzc3dvcmQiOiIxMjM0NTYifQ<span id=\"_baidu_bookmark_end_59\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_57\" style=\"display: none; line-height: 0px;\">‍</span></span><span style=\"font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;color:#ff0000\">==</span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><br/></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_64\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_66\" style=\"display: none; line-height: 0px;\">‍</span>#经过UrlEncode编码后的字符串<span id=\"_baidu_bookmark_end_67\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_65\" style=\"display: none; line-height: 0px;\">‍</span></span></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_70\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_72\" style=\"display: none; line-height: 0px;\">‍</span>String base64StringUriEncode = eyJ1c2VybmFtZSI6ImV0aGFuMDAxIiwicm9sZWlkIjoiMTQiLCJleHRlbmQiOiJ7XCJzZXhcIjpcIjFcIixcImFnZVwiOlwiMjNcIn0iLCJzZWNyZXQiOiI2ZTY4MTMyN2ZjOTc0NWJiYWIxYmU4MGQ1ZGVlZTlkYSIsInJlYWxuYW1lIjoi5Lit5paH5rWL6K<span style=\"color:#ff0000\">%2b</span>VIiwicGFzc3dvcmQiOiIxMjM0NTYifQ<span style=\"color:#ff0000\">%3d%3d</span><span id=\"_baidu_bookmark_end_73\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;color:#ff0000\"><span id=\"_baidu_bookmark_end_71\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_end_26\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_end_24\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><span style=\"font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;color:#ff0000\"><br/></span></p><p><span style=\"font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;color:#ff0000\"><span id=\"_baidu_bookmark_start_78\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_80\" style=\"display: none; line-height: 0px;\">‍</span>#将“+”，“=”的编码替换为正常<span id=\"_baidu_bookmark_end_81\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;color:#ff0000\"><span id=\"_baidu_bookmark_end_79\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_82\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_84\" style=\"display: none; line-height: 0px;\">‍</span>String result = &quot;&quot;;</p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"></span></p><p><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"></span><span style=\"color: rgb(0, 128, 0); font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 24px; white-space: normal;\"><span id=\"_baidu_bookmark_start_86\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_88\" style=\"display: none; line-height: 0px;\">‍</span>result&nbsp;= base64StringUriEncode&nbsp;.replace(&quot;%3D&quot;, &quot;=&quot;);</p><p><span id=\"_baidu_bookmark_start_90\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_92\" style=\"display: none; line-height: 0px;\">‍</span>result&nbsp;= result.replace(&quot;%2B&quot;, &quot;+&quot;);<span id=\"_baidu_bookmark_end_93\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_91\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_89\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_87\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_85\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_83\" style=\"display: none; line-height: 0px;\">‍</span></p><p><br/></p><p>#Base64位解码</p><p>......</p><p><br/></p><p><span style=\"color:#ff0000\">在实际开发过程中，还是会遇到一些未知的字符变编码和转换，终级解决办法是将URI编码的字符串，进行解码：</span></p><p><span style=\"color:#ff0000\">String date = &quot;&quot;;<br/></span></p><p><span style=\"color:#ff0000\">data = URIUtil.decode(data);</span></p><p><br/></p><p><br/></p><p><strong>参考文档</strong></p><p><a href=\"http://blog.csdn.net/chszs/article/details/17027535\" target=\"_blank\" title=\"http://blog.csdn.net/chszs/article/details/17027535\">http://blog.csdn.net/chszs/article/details/17027535</a></p><p>在线进行Base64编码和解码：<a href=\"http://www1.tc711.com/tool/BASE64.htm\" target=\"_blank\" title=\"http://www1.tc711.com/tool/BASE64.htm\">http://www1.tc711.com/tool/BASE64.htm</a></p><p>在线进行UriEncode编码和解码：<a href=\"http://tool.chinaz.com/Tools/URLEncode.aspx\" target=\"_blank\" title=\"http://tool.chinaz.com/Tools/URLEncode.aspx\">http://tool.chinaz.com/Tools/URLEncode.aspx</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "数据编码",
      "createAt": "2015/12/18 16:12:46",
      "updateAt": "2015/12/25 09:29:00"
    },
    {
      "title": "MySQL 开启 binlog日志记录",
      "content": "<p>由于没有及时开启binlog记录，一个数据库误操作导致数据丢失不可恢复，现在肠子都悔青了了，丢失了好多数据。</p><p><br/></p><p>下面将MySql怎么开启binlog日志记录以及怎样恢复的操作记录如下：</p><p><br/></p><p><span style=\"line-height: 1.42857143;\">&nbsp; 1、查看mysql是否有binlog日志来判断是否有开启，或者通过<span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal;\"></span></span>show variables like &#39;log_%&#39;;查看<span style=\"line-height: 1.42857143;\"><span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal;\"></span></span></p><p><span style=\"line-height: 1.42857143;\">&nbsp; &nbsp; &nbsp;show binlog events;</span></p><p>&nbsp; &nbsp; &nbsp;<img src=\"../../../../upload/images/20141230/59711419903812258.png\"/></p><p>&nbsp; &nbsp; &nbsp;<span style=\"line-height: 22.8571434020996px;\">说明没有开启</span></p><p>&nbsp; 2、开启binlog</p><p>&nbsp; &nbsp; 在D:\\Program Files\\MySQL\\MySQL Server 5.5\\my.ini(我的Window下路径，<span style=\"line-height: 22.8571434020996px;\">Linux下是</span><span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; line-height: 26px;\"></span><span style=\"line-height: 22.8571434020996px;\">/etc/my.cnf</span>)配置文件里面的<span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal;\"></span></p><p>&nbsp; &nbsp;&nbsp;<span style=\"line-height: 22.8571434020996px;\">[mysqld]</span></p><p>&nbsp; &nbsp; 新增加如下一行</p><p>&nbsp; &nbsp;&nbsp;<span style=\"line-height: 1.42857143;\">log-bin=D:\\ProgramData\\MySQL\\mysql-bin(名字可以随便起)<br/><br/></span></p><p>&nbsp; 3、检查是否开启</p><p>&nbsp; &nbsp; show binlog events;</p><p>&nbsp; &nbsp;&nbsp;<img src=\"../../../../upload/images/20141230/94001419904720246.png\"/></p><p>&nbsp; &nbsp; 说明已经开启</p><p><br/></p><p>&nbsp; &nbsp;4、查看binlog的名称</p><p>&nbsp; &nbsp; show binary logs;</p><p>&nbsp; &nbsp;&nbsp;<img src=\"../../../../upload/images/20141230/74561419905475621.png\"/></p><p><br/></p><p>&nbsp; &nbsp;5、用mysqlbinlog 工具来显示记录的二进制结果，然后导入到文本文件，为了以后的恢复<strong style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal;\"></strong></p><p>&nbsp; &nbsp; &nbsp;导出全部：</p><p><span style=\"line-height: 22.8571434020996px;\">&nbsp; &nbsp; &nbsp;mysqlbinlog &nbsp;D:\\ProgramData\\MySQL\\mysql-bin.000001 &gt; D:/binlog.txt;</span></p><p><span style=\"line-height: 1.42857143;\">&nbsp; &nbsp; &nbsp;导出部分：</span></p><p><span style=\"line-height: 1.42857143;\">&nbsp; &nbsp; &nbsp;mysqlbinlog --start-position=4 --stop-position=791 D:\\ProgramData\\MySQL\\mysql-bin.000001 &gt; D:/binlog.txt;</span></p><p><br/></p><p>&nbsp; &nbsp;6、导入结果到MYSQL中进行数据恢复</p><p>&nbsp; &nbsp; &nbsp;mysqlbinlog --start-position=134 --stop-position=330 <span style=\"line-height: 22.8571434020996px;\">D:\\ProgramData\\MySQL\\mysql-bin.000001</span> | mysql -uroot -p</p><p><br/></p><p><span style=\"line-height: 1.42857143;\">&nbsp; &nbsp; &nbsp;或者</span></p><p>&nbsp; &nbsp; &nbsp;mysqlbinlog --start-position=759 --stop-position=1173&nbsp;<span style=\"line-height: 22.8571434020996px;\">D:\\ProgramData\\MySQL\\mysql-bin.000001</span> &gt;<span style=\"line-height: 22.8571434020996px;\"><span style=\"line-height: 22.8571434020996px;\">D:/binlog1.txt;</span></span></p><p><br/></p><p>&nbsp; &nbsp; &nbsp;进入MYSQL导入</p><p>&nbsp; &nbsp; &nbsp;mysql&gt; source <span style=\"line-height: 22.8571434020996px;\">D:/binlog1.txt;</span></p><p><br/></p><p>&nbsp; &nbsp; &nbsp;还有一种办法是根据日期来恢复</p><p>&nbsp; &nbsp;&nbsp;mysqlbinlog --start-datetime=&quot;2014-12-30 11:49:39&quot; --stop-datetim=&quot;<span style=\"line-height: 22.8571434020996px;\">20</span><span style=\"line-height: 22.8571434020996px;\">14-12-30 11:49:56</span>&quot; <span style=\"line-height: 22.8571434020996px;\">D:\\ProgramData\\MySQL\\</span></p><p><span style=\"line-height: 22.8571434020996px;\">&nbsp; &nbsp; mysql-bin.000001</span> | mysql -u root -p</p><p><br/></p><p><br/></p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp;</p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "MySQL",
      "createAt": "2015/3/30 06:48:14",
      "updateAt": "2015/12/29 14:41:41"
    },
    {
      "title": "Mysql 会导致锁表的语法",
      "content": "<p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-size: 15.4545px; text-indent: 99.0909px;\">测试环境：</span><span style=\"font-size: 15.4545px; text-indent: 99.0909px;\">Mysql 5.5 基于innodb 引擎</span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-size: 15.4545px; text-indent: 99.0909px;\"><br/></span></p><p><span id=\"internal-source-marker_0.9371932952199131\" style=\"color: rgb(51, 51, 51); font-family: Arial; line-height: 26px; font-size: 15.4545px; text-indent: 99.0909px; background-color: rgb(255, 255, 255);\"></span></p><p><strong>[sql]</strong><a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_plain.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">&nbsp;plain</a><span data-mod=\"popu_168\">&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_copy.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">copy</a></span><span data-mod=\"popu_169\"></span></p><ol start=\"1\" class=\"dp-sql list-paddingleft-2\" style=\"padding: 0px; border: none; color: rgb(92, 92, 92); margin-bottom: 1px !important; margin-left: 45px !important; background-color: rgb(255, 255, 255);\"><li><p><span style=\"margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">insert</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">into</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;&nbsp;table1&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">values</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">select</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;&nbsp;…&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">from</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table2&nbsp;….&nbsp;</span></span></p></li></ol><p><span style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;&nbsp;此种方法，会锁table2</span><br style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/></p><p><strong>[sql]</strong>&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_plain.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">view plain</a><span data-mod=\"popu_168\">&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_copy.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">copy</a></span><span data-mod=\"popu_169\"></span></p><ol start=\"1\" class=\"dp-sql list-paddingleft-2\" style=\"padding: 0px; border: none; color: rgb(92, 92, 92); margin-bottom: 1px !important; margin-left: 45px !important; background-color: rgb(255, 255, 255);\"><li><p><span style=\"margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">delete</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1&nbsp;&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">from</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">inner</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;</span><span class=\"op\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(128, 128, 128); background-color: inherit;\">join</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table2&nbsp;&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">on</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1.id=table2.id&nbsp;&nbsp;…&nbsp;&nbsp;</span></span></p></li></ol><p><span style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此种方法，会锁table2</span><br style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/></p><p><strong>[sql]</strong>&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_plain.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">view plain</a><span data-mod=\"popu_168\">&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_copy.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">copy</a></span><span data-mod=\"popu_169\"></span></p><ol start=\"1\" class=\"dp-sql list-paddingleft-2\" style=\"padding: 0px; border: none; color: rgb(92, 92, 92); margin-bottom: 1px !important; margin-left: 45px !important; background-color: rgb(255, 255, 255);\"><li><p><span style=\"margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">update</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;tabel1,table2&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">set</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1.</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">name</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">=’feie’&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">where</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1.id=table2.id&nbsp;&nbsp;</span></span></p></li></ol><p><span style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;&nbsp;此种方法，会锁table2</span><br style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/></p><p><strong>[sql]</strong>&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_plain.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">view plain</a><span data-mod=\"popu_168\">&nbsp;<a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 1px; margin: 0px 10px 0px 0px; font-size: 9px; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-image: url(&quot;images/default/ico_copy.gif&quot;); background-attachment: initial; background-color: inherit; background-size: initial; background-origin: initial; background-clip: initial; background-position: 0% 0%; background-repeat: no-repeat;\">copy</a></span><span data-mod=\"popu_169\"></span></p><ol start=\"1\" class=\"dp-sql list-paddingleft-2\" style=\"padding: 0px; border: none; color: rgb(92, 92, 92); margin-bottom: 1px !important; margin-left: 45px !important; background-color: rgb(255, 255, 255);\"><li><p><span style=\"margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">update</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;tabel1,table2&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">set</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1.</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">name</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">=’feie’&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;\">where</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1.id=table2.id&nbsp;</span><span class=\"op\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(128, 128, 128); background-color: inherit;\">and</span><span style=\"margin: 0px; padding: 0px; border: none; background-color: inherit;\">&nbsp;table1.id=1;&nbsp;&nbsp;</span></span></p></li></ol><p><span style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;&nbsp;此种方法，会锁table2.id=1的记录</span><br style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap;\">-----------------------------------------第二次编辑分割线--------------------------------------</span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"><span id=\"internal-source-marker_0.9371932952199131\" style=\"font-size: 15.4545px; text-indent: 355.091px;\"><span style=\"vertical-align: baseline; background-color: transparent;\">假设kid\n 是表table 的 一个索引字段 </span><span style=\"color: rgb(255, 0, 0); vertical-align: baseline; background-color: transparent;\">且值不唯一</span><span style=\"vertical-align: baseline; background-color: transparent;\"></span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">1.如果kid 有多个值为12的记录那么：</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">update table &nbsp;set name=’feie’ where kid=12; &nbsp;</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">会锁表</span></span></span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"><span style=\"font-size: 15.4545px; text-indent: 355.091px;\"><br/><span style=\"vertical-align: baseline; background-color: transparent;\">2.如果kid有唯一的值为1的记录那么：</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">update table &nbsp;set name=’<span style=\"font-size: 15px; text-indent: 355.091px;\">feie</span>’ where kid=1; &nbsp;</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">不会锁</span></span></span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"><span style=\"font-size: 15.4545px; text-indent: 355.091px;\"><br/><span style=\"vertical-align: baseline; background-color: transparent;\"><span style=\"color: rgb(255, 0, 0);\">总结：用索引字段做为条件进行修改时， 是否表锁的取决于这个索引字段能否确定记录唯一，当索引值对应记录不唯一，会进行锁表，相反则行锁。</span></span></span></span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap; background-color: transparent;\"><span style=\"font-size: 15.4545px; text-indent: 355.091px;\"><span style=\"vertical-align: baseline; background-color: transparent;\"><span style=\"color: rgb(255, 0, 0);\"><br/></span></span></span></span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-size: 15.4545px; text-indent: 355.091px; white-space: pre-wrap; background-color: transparent;\">如果有两个delete</span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap;\"><span style=\"font-size: 15.4545px; text-indent: 355.091px;\"><span style=\"vertical-align: baseline;\">kid1 与 kid2是索引字段</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">语句1 delete from table where &nbsp;kid1=1 and kid2=2;</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">语句2 delete from table where &nbsp;kid1=1 and kid2=3;</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">这样的两个delete 是不会锁表的</span></span></span></p><p style=\"color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"vertical-align: baseline; white-space: pre-wrap;\"><span style=\"font-size: 15.4545px; text-indent: 355.091px;\"><br/><span style=\"vertical-align: baseline; background-color: transparent;\">语句1 delete from table where &nbsp;kid1=1 and kid2=2;</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">语句2 delete from table where &nbsp;kid1=1 ;</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\">这样的两个delete 会锁表</span><br/><span style=\"vertical-align: baseline; background-color: transparent;\"><span style=\"color: rgb(255, 0, 0);\">总结：同一个表，如果进行删除操作时，尽量让删除条件统一，否则会相互影响造成锁表</span></span></span></span></p><p><br/></p><p><strong>参考文档</strong></p><p><a href=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795\" _src=\"http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795\">http://blog.csdn.net/yonghumingbuzhidao/article/details/8330795</a> </p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "MySQL",
      "createAt": "2016/9/13 10:12:04",
      "updateAt": "2016/9/13 10:16:03"
    },
    {
      "title": "MySQL存储引擎中的MyISAM和InnoDB区别详解",
      "content": "<p>MyISAM是MySQL的默认数据库引擎（5.5版之前），由早期的ISAM（Indexed Sequential Access Method：有索引的顺序访问方法）所改良。虽然性能极佳，但却有一个缺点：不支持事务处理（transaction）。不过，在这几年的发展下，MySQL也导入了InnoDB（另一种数据库引擎），以强化参考完整性与并发违规处理机制，后来就逐渐取代MyISAM。</p><p>InnoDB，是MySQL的数据库引擎之一，为MySQL AB发布binary的标准之一。InnoDB由Innobase Oy公司所开发，2006年五月时由甲骨文公司并购。与传统的ISAM与MyISAM相比，InnoDB的最大特色就是支持了ACID兼容的事务（Transaction）功能，类似于PostgreSQL。目前InnoDB采用双轨制授权，一是GPL授权，另一是专有软件授权。</p><p><strong>MyISAM与InnoDB的区别是什么？</strong></p><p><strong>1、 存储结构</strong></p><p>MyISAM：每个MyISAM在磁盘上存储成三个文件。第一个文件的名字以表的名字开始，扩展名指出文件类型。.frm文件存储表定义。数据文件的扩展名为.MYD (MYData)。索引文件的扩展名是.MYI (MYIndex)。<br/>InnoDB：所有的表都保存在同一个数据文件中（也可能是多个文件，或者是独立的表空间文件），InnoDB表的大小只受限于操作系统文件的大小，一般为2GB。</p><p><strong>2、 存储空间</strong></p><p>MyISAM：可被压缩，存储空间较小。支持三种不同的存储格式：静态表(默认，但是注意数据末尾不能有空格，会被去掉)、动态表、压缩表。<br/>InnoDB：需要更多的内存和存储，它会在主内存中建立其专用的缓冲池用于高速缓冲数据和索引。</p><p><strong>3、 可移植性、备份及恢复</strong></p><p>MyISAM：数据是以文件的形式存储，所以在跨平台的数据转移中会很方便。在备份和恢复时可单独针对某个表进行操作。<br/>InnoDB：免费的方案可以是拷贝数据文件、备份 binlog，或者用 mysqldump，在数据量达到几十G的时候就相对痛苦了。</p><p><strong>4、 事务支持</strong></p><p>MyISAM：强调的是性能，每次查询具有原子性,其执行数度比InnoDB类型更快，但是不提供事务支持。<br/>InnoDB：提供事务支持事务，外部键等高级数据库功能。 具有事务(commit)、回滚(rollback)和崩溃修复能力(crash recovery capabilities)的事务安全(transaction-safe (ACID compliant))型表。</p><p><strong>5、 AUTO_INCREMENT</strong></p><p>MyISAM：可以和其他字段一起建立联合索引。引擎的自动增长列必须是索引，如果是组合索引，自动增长可以不是第一列，他可以根据前面几列进行排序后递增。<br/>InnoDB：InnoDB中必须包含只有该字段的索引。引擎的自动增长列必须是索引，如果是组合索引也必须是组合索引的第一列。</p><p><strong>6、 表锁差异</strong></p><p>MyISAM：只支持表级锁，用户在操作myisam表时，select，update，delete，insert语句都会给表自动加锁，如果加锁以后的表满足insert并发的情况下，可以在表的尾部插入新的数据。<br/>InnoDB：支持事务和行级锁，是innodb的最大特色。行锁大幅度提高了多用户并发操作的新能。但是InnoDB的行锁，只是在WHERE的主键是有效的，非主键的WHERE都会锁全表的。</p><p><strong>7、 全文索引</strong></p><p>MyISAM：支持 FULLTEXT类型的全文索引<br/>InnoDB：不支持FULLTEXT类型的全文索引，但是innodb可以使用sphinx插件支持全文索引，并且效果更好。</p><p><strong>8、 表主键</strong></p><p>MyISAM：允许没有任何索引和主键的表存在，索引都是保存行的地址。<br/>InnoDB：如果没有设定主键或者非空唯一索引，就会自动生成一个6字节的主键(用户不可见)，数据是主索引的一部分，附加索引保存的是主索引的值。</p><p><strong>9、 表的具体行数</strong></p><p>MyISAM：保存有表的总行数，如果select count(*) from table;会直接取出出该值。<br/>InnoDB：没有保存表的总行数，如果使用select count(*) from table；就会遍历整个表，消耗相当大，但是在加了wehre条件后，myisam和innodb处理的方式都一样。</p><p><strong>10、 CURD操作</strong></p><p>MyISAM：如果执行大量的SELECT，MyISAM是更好的选择。<br/>InnoDB：如果你的数据执行大量的INSERT或UPDATE，出于性能方面的考虑，应该使用InnoDB表。DELETE 从性能上InnoDB更优，但DELETE FROM table时，InnoDB不会重新建立表，而是一行一行的删除，在innodb上如果要清空保存有大量数据的表，最好使用truncate table这个命令。</p><p><strong>11、 外键</strong></p><p>MyISAM：不支持<br/>InnoDB：支持<br/> 通过上述的分析，基本上可以考虑使用InnoDB来替代MyISAM引擎了，原因是InnoDB自身很多良好的特点，比如事务支持、存储 过程、视图、行级锁定等等，在并发很多的情况下，相信InnoDB的表现肯定要比MyISAM强很多。另外，任何一种表都不是万能的，只用恰当的针对业务类型来选择合适的表类型，才能最大的发挥MySQL的性能优势。如果不是很复杂的Web应用，非关键应用，还是可以继续考虑MyISAM的，这个具体情况可以自己斟酌。</p><p><br/></p><p>文章来自：</p><p>http://www.jb51.net/article/62457.htm</p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "MySQL",
      "createAt": "2017/3/6 17:20:02",
      "updateAt": "2017/8/29 10:28:30"
    },
    {
      "title": "Spring MVC项目添加Spring mobile支持",
      "content": "<p></p><p>1、添加jar包支持</p><p>//Spring mobile</p><p>compile &#39;org.springframework.mobile:spring-mobile-device:1.1.3.RELEASE&#39;</p><p><br/>2、Spring MVC配置文件添加如下内容&nbsp; <br/>&lt;mvc:interceptors&gt;<br/>&nbsp;&lt;!-- On pre-handle, resolve the device that originated the web request --&gt;<br/>&nbsp;&lt;mvc:interceptor&gt;<br/>&nbsp;&nbsp;&lt;mvc:mapping path=&quot;/mobile/**&quot;/&gt;<br/>&nbsp; &nbsp;&nbsp;&lt;bean class=&quot;org.springframework.mobile.device.DeviceResolverHandlerInterceptor&quot; /&gt;<br/>&nbsp; &nbsp;&lt;/mvc:interceptor&gt;&nbsp; <br/>&lt;/mvc:interceptors&gt;&nbsp;</p><p>&lt;mvc:annotation-driven&gt;<br/>&nbsp;&lt;mvc:argument-resolvers&gt;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&lt;bean class=&quot;org.springframework.mobile.device.DeviceWebArgumentResolver&quot; /&gt;<br/>&nbsp;&lt;/mvc:argument-resolvers&gt;<br/>&lt;/mvc:annotation-driven&gt;</p><p><br/>3、控制器代码</p><p>@Controller</p><p>@RequestMapping(&quot;/mobile&quot;)</p><p>public class MobileController {</p><p>&nbsp;</p><p>&nbsp;&nbsp;&nbsp; @RequestMapping(&quot;&quot;)</p><p>&nbsp;&nbsp;&nbsp; public String mobile(Device device,Model model) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String message = &quot;&quot;;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (device.isMobile()) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(message = &quot;Hello mobile user!&quot;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (device.isTablet()) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(message = &quot;Hello tablet user!&quot;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(message = &quot;Hello desktop user!&quot;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.addAttribute(&quot;message&quot;, message);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return &quot;mobile/mobile&quot;;</p><p>&nbsp;&nbsp;&nbsp; }</p><p>}</p><p>&nbsp;</p><p><br/>更多详细配置请看：<a href=\"http://projects.spring.io/spring-mobile/\">http://projects.spring.io/spring-mobile/</a></p><p></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Spring MVC",
      "createAt": "2015/12/18 17:38:37",
      "updateAt": "2015/12/18 17:38:37"
    },
    {
      "title": "Apache Shiro配置shiroFilter过滤url鉴权引起错误问题的处理",
      "content": "<p>Apache Shiro配置shiroFilter拦截url登录于鉴权引起的错误问题处理</p><pre class=\"brush:xml;toolbar:false\">&lt;!--&nbsp;Shiro&nbsp;Filter&nbsp;--&gt;\n&lt;bean&nbsp;id=&quot;shiroFilter&quot;&nbsp;class=&quot;org.apache.shiro.spring.web.ShiroFilterFactoryBean&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;securityManager&quot;&nbsp;ref=&quot;securityManager&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;loginUrl&quot;&nbsp;value=&quot;/login&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;successUrl&quot;&nbsp;value=&quot;/system/main&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;unauthorizedUrl&quot;&nbsp;value=&quot;/login&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;filterChainDefinitions&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;value&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/toSignin&nbsp;=&nbsp;anon\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/signin&nbsp;=&nbsp;anon\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/validateCode&nbsp;=&nbsp;anon\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/blog/article/input**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/blog/tag**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/blog/channel**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/todo/input**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/todo/edit**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/todoitem/input**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/value&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/property&gt;\n&lt;/bean&gt;</pre><p>在上述配置中加authc的url，如果用户没登陆，便会跳转到loginUrl进行登陆。</p><p><span style=\"line-height: 1.5;\">如果通过在方法上加注解@RequiresAuthentication去实现url的鉴权，则存在如下问题：</span></p><p>1. 如果用户没登陆系统，系统给出如下异常：</p><p>org.apache.shiro.authz.UnauthenticatedException: The current Subject is not authenticated. &nbsp;Access denied.</p><p><span style=\"line-height: 1.5;\">而不会跳转到loginUrl登陆。</span></p><p>2.如果是用户已经登陆，但是没某个url操作的权限，则需要在方法上加注解@RequiresPermissions(value=&quot;user:create&quot;)让其具有权限才能执行，否则抛出如下异常：</p><p><span style=\"line-height: 1.5;\">org.apache.shiro.authz.UnauthorizedException:&nbsp;</span><span style=\"line-height: 1.5;\">Subject does not have permission [user:create]</span></p><p>而不会跳转到loginUrl登陆。</p><p><br/></p><p>为了对这些异常进行拦截处理，可以通过如下方法</p><p>1、编写Spring MVC拦截器进行拦截</p><p><span style=\"line-height: 1.5;\">2、配置Spring MVC全局错误拦截</span></p><p><span style=\"line-height: 1.5;\"><br/></span></p><p><span style=\"line-height: 1.5;\">这里进行Spring MVC全局错误拦截：</span></p><p><span style=\"line-height: 1.5;\"></span></p><p>&lt;!-- 全局错误拦截配置 --&gt;</p><pre class=\"brush:xml;toolbar:false\">&lt;bean&nbsp;class=&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;exceptionMappings&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;props&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;登录错误&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;prop&nbsp;key=&quot;org.apache.shiro.authz.UnauthenticatedException&quot;&gt;redirect:/login&lt;/prop&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;授权错误&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;prop&nbsp;key=&quot;org.apache.shiro.authz.UnauthorizedException&quot;&gt;/base/error/403&lt;/prop&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/props&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/property&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;默认错误&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;defaultErrorView&quot;&nbsp;value=&quot;/base/error/500&quot;/&gt;\n&lt;/bean&gt;</pre><p><br/></p><p><strong>参考文档</strong></p><p><a title=\"http://wenku.baidu.com/view/97f5868b76eeaeaad1f33065.html\" href=\"http://wenku.baidu.com/view/97f5868b76eeaeaad1f33065.html\" target=\"_blank\">http://wenku.baidu.com/view/97f5868b76eeaeaad1f33065.html</a></p><p><br/></p>",
      "show": "1",
      "channel": "Apache框架笔记",
      "tag": "Spring MVC",
      "createAt": "2015/12/27 22:25:41",
      "updateAt": "2015/12/28 22:51:40"
    },
    {
      "title": "Spring集成分布式Quartz框架之一：常规整合",
      "content": "<p><strong>该配置为了解决WEB项目分布式部署时定时任务的并发冲突问题。</strong></p><p>配置环境如下：</p><p>JDK 1.7</p><p>Spring 4.0.2</p><p>Quartz 2.2.1</p><p><strong>首先要导入quartz涉及到11张表</strong></p><p>从官网http://www.quartz-scheduler.org<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span>下载“<a href=\"http://d2zwv9pap9ylyd.cloudfront.net/quartz-2.2.1-distribution.tar.gz\" target=\"_blank\">quartz-2.2.1-distribution.tar.gz</a>”，解压，从“quartz-2.2.1-distribution\\quartz-2.2.1\\docs\\dbTables”目录下找到合适的您项目的脚本<span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span></p><p><br/></p><p><strong>两个主要配置文件：<span style=\"line-height: 22.8571px; white-space: normal;\">quartz.properties和<span style=\"line-height: 22.8571px; white-space: normal;\">applicationContext-quartz.xml，文件内容</span></span>如下：</strong></p><p>quartz.properties文件内容：</p><p><span style=\"white-space: nowrap;\"># Using Spring datasource in quartzJobsConfig.xml</span></p><p><span style=\"white-space: nowrap;\"># Spring uses LocalDataSourceJobStore extension of JobStoreCMT</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.useProperties=true</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.tablePrefix=QRTZ_</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.isClustered=true</span></p><p><span style=\"white-space: nowrap;\"># 1 mins</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.clusterCheckinInterval=15000</span></p><p><span style=\"white-space: nowrap;\">org.quartz.scheduler.skipUpdateCheck=true</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"># Change this to match your DB vendor</span></p><p><span style=\"white-space: nowrap;\">org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span></p><p><span style=\"white-space: nowrap;\"># Needed to manage cluster instances</span></p><p><span style=\"white-space: nowrap;\">org.quartz.scheduler.instanceId=AUTO</span></p><p><span style=\"white-space: nowrap;\">org.quartz.scheduler.instanceName=quartzInstanceName</span></p><p><span style=\"white-space: nowrap;\">&nbsp;</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.threadCount=10</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.threadPriority=5</span></p><p><span style=\"white-space: nowrap;\">org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread=true</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"># Configure Plugins</span></p><p><span style=\"white-space: nowrap;\">org.quartz.plugin.triggHistory.class=org.quartz.plugins.history.LoggingJobHistoryPlugin</span></p><p><span style=\"white-space: nowrap;\">#org.quartz.plugin.triggHistory.class=org.quartz.plugins.history.LoggingTriggerHistoryPlugin</span></p><p><span style=\"white-space: nowrap;\">#org.quartz.plugin.triggHistory.triggerFiredMessage=Trigger \\{1\\}.\\{0\\} fired job \\{6\\}.\\{5\\} at: \\{4, date, HH:mm:ss MM/dd/yyyy}</span></p><p><span style=\"white-space: nowrap;\">#org.quartz.plugin.triggHistory.triggerCompleteMessage=Trigger \\{1\\}.\\{0\\} completed firing job \\{6\\}.\\{5\\} at \\{4, date, HH:mm:ss MM/dd/yyyy\\}</span></p><p><br/></p><p>applicationContext-quartz.xml文件内容：</p><p><span style=\"white-space: nowrap;\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></p><p><span style=\"white-space: nowrap;\">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xmlns:task=&quot;http://www.springframework.org/schema/task&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/context</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/context/spring-context-3.2.xsd</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/task</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t\t\t</span>http://www.springframework.org/schema/task/spring-task-3.2.xsd&quot;&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;description&gt;quartz分布式配置文件&lt;/description&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;context:annotation-config /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 任务配置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;jobDetail&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>class=&quot;org.springframework.scheduling.quartz.JobDetailFactoryBean&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobClass&quot; value=&quot;cn.imethan.admin.quartz.job.TestJob&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;durability&quot; value=&quot;true&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- &lt;property name=&quot;requestsRecovery&quot; value=&quot;true&quot; /&gt; --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 触发器 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;jobDetailTrigger&quot; class=&quot;org.springframework.scheduling.quartz.CronTriggerFactoryBean&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobDetail&quot; ref=&quot;jobDetail&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;cronExpression&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;value&gt;0/5 * * * * ?&lt;/value&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;timeZone&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;value&gt;GMT+8:00&lt;/value&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;!-- 任务调度配置 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;bean id=&quot;quartzScheduler&quot; class=&quot;org.springframework.scheduling.quartz.SchedulerFactoryBean&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;configLocation&quot; value=&quot;classpath:/quartz/quartz.properties&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;dataSource&quot; ref=&quot;myDataSource&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;transactionManager&quot; ref=&quot;myTxManager&quot; /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- This name is persisted as SCHED_NAME in db. for local testing could&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>change to unique name to avoid collision with dev server --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;schedulerName&quot; value=&quot;quartzScheduler&quot; /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;startupDelay&quot; value=&quot;5&quot; /&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- Will update database cron triggers to what is in this jobs file on&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>each deploy. Replaces all previous trigger and job data that was in the database.&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>YMMV --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;overwriteExistingJobs&quot; value=&quot;true&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;autoStartup&quot; value=&quot;true&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;applicationContextSchedulerContextKey&quot; value=&quot;applicationContext&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobFactory&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;bean class=&quot;cn.imethan.admin.quartz.common.AutowiringSpringBeanJobFactory&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;!-- NOTE: Must add both the jobDetail and trigger to the scheduler! --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;triggers&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;ref bean=&quot;jobDetailTrigger&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;/list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;property name=&quot;jobDetails&quot;&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>&lt;ref bean=&quot;jobDetail&quot; /&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>&lt;/list&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>&lt;/property&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>&lt;/bean&gt;</p><p><span style=\"white-space: nowrap;\">&lt;/beans&gt;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><strong>两个主要的类，AutowiringSpringBeanJobFactory和TestJob，类内容如下：</strong></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\">AutowiringSpringBeanJobFactory类内容：</span></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"></span></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.common;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.quartz.spi.TriggerFiredBundle;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.beans.factory.config.AutowireCapableBeanFactory;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.context.ApplicationContext;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.context.ApplicationContextAware;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.scheduling.quartz.SpringBeanJobFactory;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* AutowiringSpringBeanJobFactory.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @time 2015年9月19日下午3:33:22</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public final class AutowiringSpringBeanJobFactory extends SpringBeanJobFactory implements ApplicationContextAware {</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private transient AutowireCapableBeanFactory beanFactory;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setApplicationContext(final ApplicationContext context) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>beanFactory = context.getAutowireCapableBeanFactory();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>protected Object createJobInstance(final TriggerFiredBundle bundle) throws Exception {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>final Object job = super.createJobInstance(bundle);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>beanFactory.autowireBean(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return job;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">TestJob类内容如下：</span></span></span><br/></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"></span></span></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.job;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.DisallowConcurrentExecution;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionContext;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionException;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.scheduling.quartz.QuartzJobBean;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import cn.imethan.common.utils.DateUtil;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* TestJob.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @time 2015年9月19日下午3:36:40</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">@DisallowConcurrentExecution</span></p><p><span style=\"white-space: nowrap;\">public class TestJob extends QuartzJobBean {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; protected void executeInternal(JobExecutionContext arg0) throws JobExecutionException {</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>System.out.println(&quot;[TestJob]Sleep 10s begin date:&quot;+DateUtil.getDatetimeStr(DateUtil.DATE_PATTERN_01));</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>try {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>Thread.sleep(4000);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (InterruptedException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>System.out.println(&quot;[TestJob]Sleep 10s end &nbsp; date:&quot;+DateUtil.getDatetimeStr(DateUtil.DATE_PATTERN_01));</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; }</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></span><br/></p><p><span style=\"white-space: nowrap;\"><span style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><br/></span></span></span></p><p>参考文档</p><p><a title=\"http://www.cnblogs.com/skyblue/p/3296350.html\" target=\"_blank\" href=\"http://www.cnblogs.com/skyblue/p/3296350.html\">http://www.cnblogs.com/skyblue/p/3296350.html</a></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Quartz",
      "createAt": "2015/12/18 17:38:10",
      "updateAt": "2015/12/23 11:28:51"
    },
    {
      "title": "Spring集成分布式Quartz框架之二：动态添加、修改、删除任务",
      "content": "<p>在上一篇关于<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span><a title=\"http://www.imethan.cn/blog/article/72\" href=\"http://www.imethan.cn/blog/article/72\" target=\"_blank\">《Spring集成配置分布式Quartz框架之一：常规整合》</a><span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"line-height: 1.42857;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span>的基础之上实现动态添加、修改、删除任务</span></span></p><p><br/></p><p>通常我们将Quartz整合到Spring是通过配置文件的方式配置任务Job和触发器Trigger，每次更改或者添加配置，都需要重新启动项目，为了解决该问题，在网络上翻阅了一些资料后，整理了动态添加、修改和删除任务的功能。<span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span></p><p>主要封装了三个类:QuartzJob（任务信息类）、QuartzJobFactory（任务执行类）、<span style=\"line-height: 22.8571px; white-space: normal;\">DynamicQuartzJobFactory（动态执行任务工厂类）。</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\">废话少说，上菜~~</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><strong><span style=\"line-height: 22.8571px; white-space: normal;\">1、任务信息类：</span>QuartzJob</strong></span></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; white-space: normal;\"><strong></strong></span></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.dynamic;</span></p><p><span style=\"white-space: nowrap;\">import java.io.Serializable;</span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* ScheduleJob.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @since JDK 1.7</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2015年12月22日下午3:42:38</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public class QuartzJob implements Serializable {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p>&nbsp; &nbsp; //需要实现序列化接口，否则没办法持久化到数据库</p><p>&nbsp; &nbsp; private static final long serialVersionUID = -1800494926172862932L;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobId;//任务id</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobName;//任务名称</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobGroup;//任务分组</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String jobStatus;//任务状态 0禁用 1启用 2删除</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String cronExpression;//任务运行时间表达式</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; private String description;//任务描述</span><span style=\"white-space: nowrap; line-height: 1.42857;\">&nbsp; &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobId() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobId;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobId(String jobId) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobId = jobId;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobName() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobName;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobName(String jobName) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobName = jobName;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobGroup() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobGroup;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobGroup(String jobGroup) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobGroup = jobGroup;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getJobStatus() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobStatus;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setJobStatus(String jobStatus) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.jobStatus = jobStatus;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getCronExpression() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return cronExpression;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setCronExpression(String cronExpression) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.cronExpression = cronExpression;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public String getDescription() {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return description;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void setDescription(String description) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>this.description = description;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\">}</span></p><p><strong style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\"><br/></span></strong></p><p><strong style=\"line-height: 22.8571px;\"><span style=\"line-height: 22.8571px;\">2、任务执行工厂类：</span>QuartzJobFactory</strong><br/></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong></strong></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.dynamic;</span></p><p><span style=\"white-space: nowrap;\">import java.io.Serializable;</span></p><p><span style=\"white-space: nowrap;\">import java.text.SimpleDateFormat;</span></p><p><span style=\"white-space: nowrap;\">import java.util.Date;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.quartz.DisallowConcurrentExecution;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.Job;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionContext;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionException;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* QuartzJobFactory.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @since JDK 1.7</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2015年12月21日下午5:36:08</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">@DisallowConcurrentExecution</span></p><p><span style=\"white-space: nowrap;\">public class QuartzJobFactory &nbsp;implements Job,Serializable{</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static final long serialVersionUID = 3352853281096701664L;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Override</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void execute(JobExecutionContext context) throws JobExecutionException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>// TODO Auto-generated method stub</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(&quot;★★★★★★★★★★★QuartzJob★★★★★★★★★★★:&quot;+new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date())); &nbsp; &nbsp;</p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(&quot;QuartzJob Name = [&quot; + context.getJobDetail().getKey() + &quot;]&quot;);</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>Thread.sleep(5000);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (InterruptedException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><br/></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong><span style=\"line-height: 22.8571px; white-space: normal;\">3、动态执行任务工厂类：</span>DynamicQuartzJobFactory</strong></span></p><p><span style=\"line-height: 22.8571px; white-space: normal;\"><strong></strong></span></p><p><span style=\"white-space: nowrap;\">package cn.imethan.admin.quartz.dynamic;</span></p><p><span style=\"white-space: nowrap;\">import java.util.ArrayList;</span></p><p><span style=\"white-space: nowrap;\">import java.util.List;</span></p><p><span style=\"white-space: nowrap;\">import java.util.Set;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import javax.transaction.Transactional;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.quartz.CronScheduleBuilder;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.CronTrigger;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobBuilder;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobDetail;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobExecutionContext;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.JobKey;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.Scheduler;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.SchedulerException;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.Trigger;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.TriggerBuilder;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.TriggerKey;</span></p><p><span style=\"white-space: nowrap;\">import org.quartz.impl.matchers.GroupMatcher;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.beans.factory.annotation.Autowired;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.scheduling.quartz.SchedulerFactoryBean;</span></p><p><span style=\"white-space: nowrap;\">import org.springframework.stereotype.Component;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* DynamicQuartzJobFactory.java</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Ethan Wong</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @since JDK 1.7</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2015年12月21日下午5:32:50</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">@Component</span></p><p><span style=\"white-space: nowrap;\">@Transactional//必须添加事务注释，否则任务没办法持久化到数据库</span></p><p><span style=\"white-space: nowrap;\">public class DynamicQuartzJobFactory {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Autowired</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private SchedulerFactoryBean quartzScheduler;//将配置文件的注册的bean注入</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 获取任务调度</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午11:23:49</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private Scheduler getScheduler(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return quartzScheduler.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 准备任务数据</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午11:23:41</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private List&lt;QuartzJob&gt; getAllJob(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;QuartzJob&gt; list = new ArrayList&lt;QuartzJob&gt;();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (int i = 0; i &lt; 5; i++) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>QuartzJob job = new QuartzJob();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobId(&quot;10001&quot; + i);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobName(&quot;TESTJOB&quot; + i);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobGroup(&quot;DEFAULT&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setJobStatus(&quot;1&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setCronExpression(&quot;0/5 * * * * ?&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>job.setDescription(&quot;测试任务&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>list.add(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return list;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 测试入口</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午11:24:11</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void testOne(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>List&lt;QuartzJob&gt; jobList = getAllJob();//这里获取任务信息数据</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>for (QuartzJob job : jobList) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>this.addJob(job.getJobName(), job.getJobGroup(), job.getCronExpression());</p><p><span style=\"white-space: nowrap;\">//<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>this.deleteJob(job.getJobName(), job.getJobGroup());</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (SchedulerException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 获取计划中的任务列表</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:55:44</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public List&lt;QuartzJob&gt; getTriggersOfJob() throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>GroupMatcher&lt;JobKey&gt; matcher = GroupMatcher.anyJobGroup();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Set&lt;JobKey&gt; jobKeys = scheduler.getJobKeys(matcher);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;QuartzJob&gt; jobList = new ArrayList&lt;QuartzJob&gt;();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (JobKey jobKey : jobKeys) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;List&lt;? extends Trigger&gt; triggers = scheduler.getTriggersOfJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;for (Trigger trigger : triggers) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>QuartzJob job = new QuartzJob();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setJobName(jobKey.getName());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setJobGroup(jobKey.getGroup());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setDescription(&quot;触发器:&quot; + trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;Trigger.TriggerState triggerState = scheduler.getTriggerState(trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setJobStatus(triggerState.name());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;if (trigger instanceof CronTrigger) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CronTrigger cronTrigger = (CronTrigger) trigger;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String cronExpression = cronTrigger.getCronExpression();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;job.setCronExpression(cronExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;jobList.add(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobList;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 获取正在执行的任务列表</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:56:02</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public List&lt;QuartzJob&gt; getCurrentlyExecutingJobs() throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;JobExecutionContext&gt; executingJobs = scheduler.getCurrentlyExecutingJobs();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>List&lt;QuartzJob&gt; jobList = new ArrayList&lt;QuartzJob&gt;(executingJobs.size());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (JobExecutionContext executingJob : executingJobs) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>QuartzJob job = new QuartzJob();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;JobDetail jobDetail = executingJob.getJobDetail();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;JobKey jobKey = jobDetail.getKey();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;Trigger trigger = executingJob.getTrigger();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setJobName(jobKey.getName());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setJobGroup(jobKey.getGroup());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setDescription(&quot;触发器:&quot; + trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;Trigger.TriggerState triggerState = scheduler.getTriggerState(trigger.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;job.setJobStatus(triggerState.name());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;if (trigger instanceof CronTrigger) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;CronTrigger cronTrigger = (CronTrigger) trigger;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;String cronExpression = cronTrigger.getCronExpression();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp; &nbsp; &nbsp;job.setCronExpression(cronExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span> &nbsp; &nbsp;jobList.add(job);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return jobList;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 添加任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param timeExpression</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:03:02</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public boolean addJob(String jobName,String jobGroup,String timeExpression) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//获取trigger，即在spring配置文件中定义的 bean id=&quot;myTrigger&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>TriggerKey triggerKey = TriggerKey.triggerKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>if (trigger == null) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//不存在，创建一个</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>JobDetail jobDetail = JobBuilder.newJob(QuartzJobFactory.class).withIdentity(jobName, jobGroup).storeDurably().build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>jobDetail.getJobDataMap().put(&quot;scheduleJob&quot;, &quot;job&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>scheduler.addJob(jobDetail, true);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//表达式调度构建器</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(timeExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//按新的cronExpression表达式构建一个新的trigger</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>trigger = TriggerBuilder.newTrigger().withIdentity(jobName, jobGroup).forJob(jobDetail).withSchedule(scheduleBuilder).build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>boolean isExists = scheduler.checkExists(jobDetail.getKey());</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>if(!isExists){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>scheduler.scheduleJob(jobDetail, trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}else{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>scheduler.scheduleJob(trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} else {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>// Trigger已存在，那么更新相应的定时设置</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//表达式调度构建器</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(timeExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//按新的cronExpression表达式重新构建trigger</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>trigger = trigger.getTriggerBuilder().withIdentity(triggerKey).withSchedule(scheduleBuilder).build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>//按新的trigger重新设置job执行</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>scheduler.rescheduleJob(triggerKey, trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return false;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 暂停任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:17:00</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void pauseJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobName);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.pauseJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 恢复任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:17:41</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void resumeJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.resumeJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 删除任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:18:38</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void &nbsp;deleteJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.deleteJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 触发任务</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:19:49</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void &nbsp;triggerJob(String jobName,String jobGroup) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>JobKey jobKey = JobKey.jobKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.triggerJob(jobKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 更新任务触发器时间</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobName</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param jobGroup</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param timeExpression</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @throws SchedulerException</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @author Ethan Wong</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @datetime 2015年12月23日上午10:21:55</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void modifyTimeExpression(String jobName,String jobGroup,String timeExpression) throws SchedulerException{</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Scheduler scheduler = this.getScheduler();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>TriggerKey triggerKey = TriggerKey.triggerKey(jobName, jobGroup);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//获取trigger，即在spring配置文件中定义的 bean id=&quot;myTrigger&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//表达式调度构建器</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(timeExpression);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//按新的cronExpression表达式重新构建trigger</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>trigger = trigger.getTriggerBuilder().withIdentity(triggerKey).withSchedule(scheduleBuilder).build();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>//按新的trigger重新设置job执行</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>scheduler.rescheduleJob(triggerKey, trigger);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><br/></p><p><br/></p><p><strong>参考文档</strong></p><p><strong><a title=\"http://www.quartz-scheduler.org/\" href=\"http://www.quartz-scheduler.org/\" target=\"_blank\">http://www.quartz-scheduler.org/</a></strong></p><p><a title=\"http://www.dexcoder.com/selfly/article/308\" href=\"http://www.dexcoder.com/selfly/article/308\" target=\"_blank\">http://www.dexcoder.com/selfly/article/308</a></p>",
      "show": "1",
      "channel": "Spring专题",
      "tag": "Quartz",
      "createAt": "2015/12/23 11:11:20",
      "updateAt": "2015/12/23 14:14:49"
    },
    {
      "title": "org.quartz.SchedulerException: Couldn't get host name! [See nested exception: java.net.UnknownHostException:",
      "content": "<p>hostname没有指向IP地址，编辑/etc/hosts，将hostname指向127.0.0.1即可</p><p>vi /etc/hosts</p><pre class=\"brush:xml;toolbar:false\">127.0.0.1&nbsp;&nbsp;&nbsp;localhost&nbsp;localhost.localdomain&nbsp;localhost4&nbsp;localhost4.localdomain4\n::1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localhost&nbsp;localhost.localdomain&nbsp;localhost6&nbsp;localhost6.localdomain6\n127.0.0.1&nbsp;&nbsp;&nbsp;ticket.centerB</pre><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Quartz",
      "createAt": "2016/1/12 13:30:28",
      "updateAt": "2016/1/17 23:09:47"
    },
    {
      "title": "JAVA中list,set,数组之间的转换",
      "content": "<p><span style=\"white-space: nowrap;\">JAVA的list,set,数组之间的转换，主要是使用Apache Jakarta Commons Collections，具体的方法如下：</span></p><p><span style=\"white-space: nowrap;\">import org.apache.commons.collections.CollectionUtils; &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">String[] strArray = {&quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;}; &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\">List strList = new ArrayList(); &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\">Set strSet = new HashSet(); &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\">CollectionUtils.addAll(strList, strArray); &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\">CollectionUtils.addAll(strSet, strArray); &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">CollectionUtils.addAll()方法的实现很简单，只是循环使用了Collection的add()方法而已。</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">如果只是想将数组转换成List，可以用JDK中的java.util.Arrays类：</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import java.util.Arrays; &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">String[] strArray = {&quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;}; &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\">List strList = Arrays.asList(strArray); &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\">不过Arrays.asList()方法返回的List不能add对象，因为该方法的实现是使用参数引用的数组的大小来new的一个ArrayList。</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">★ Collection转数组</span></p><p><span style=\"white-space: nowrap;\">直接使用Collection的toArray()方法，该方法有两个重载版本：</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">Object[] toArray(); &nbsp; &nbsp;</span></p><p><span style=\"white-space: nowrap;\">T[] toArray(T[] a); &nbsp;&nbsp;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">★ Map转Collection</span></p><p><span style=\"white-space: nowrap;\">直接使用Map的values()方法。</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">★ List和Set转换</span></p><p><span style=\"white-space: nowrap;\">List list = new ArrayList(new Hashset());// Fixed-size list&nbsp;</span></p><p><span style=\"white-space: nowrap;\">List list = Arrays.asList(array);// Growable&nbsp;</span></p><p><span style=\"white-space: nowrap;\">list list = new LinkedList(Arrays.asList(array));// Duplicate elements are discarded&nbsp;</span></p><p><span style=\"white-space: nowrap;\">Set set = new HashSet(Arrays.asList(array));</span></p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/18 17:39:37",
      "updateAt": "2015/12/18 17:39:37"
    },
    {
      "title": "常用加密算法的Java实现",
      "content": "<p><strong style=\"line-height: 1.42857;\">参考文档</strong><br/></p><p><a href=\"http://www.blogjava.net/amigoxie/archive/2014/06/01/414299.html\" target=\"_blank\" title=\"http://www.blogjava.net/amigoxie/archive/2014/06/01/414299.html\">http://www.blogjava.net/amigoxie/archive/2014/06/01/414299.html</a></p><p><a href=\"http://www.blogjava.net/amigoxie/archive/2014/07/06/415503.html\" target=\"_blank\" title=\"http://www.blogjava.net/amigoxie/archive/2014/07/06/415503.html\">http://www.blogjava.net/amigoxie/archive/2014/07/06/415503.html</a></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/18 17:39:51",
      "updateAt": "2015/12/18 17:39:51"
    },
    {
      "title": "java InputStream读取数据问题",
      "content": "<p><span style=\"white-space: nowrap;\">转载自：<a href=\"http://www.cnblogs.com/MyFavorite/archive/2010/10/19/1855758.html\" target=\"_blank\" title=\"http://www.cnblogs.com/MyFavorite/archive/2010/10/19/1855758.html\">http://www.cnblogs.com/MyFavorite/archive/2010/10/19/1855758.html</a></span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">1. 关于InputStream.read()</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp;在从数据流里读取数据时，为图简单，经常用InputStream.read()方法。这个方法是从流里每次只读取读取一个字节，效率会非常低。 &nbsp; &nbsp; 更好的方法是用InputStream.read(byte[] b)或者InputStream.read(byte[] b,int off,int len)方法，一次读取多个字节。</span></p><p><br/></p><p><span style=\"white-space: nowrap;\">2. 关于InputStream类的available()方法</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; 要一次读取多个字节时，经常用到InputStream.available()方法，这个方法可以在读写操作前先得知数据流里有多少个字节可以读取。需要注意的是，如果这个方法用在从本</span></p><p><span style=\"white-space: nowrap;\">地文件读取数据时，一般不会遇到问题，但如果是用于网络操作，就经常会遇到一些麻烦。比如，Socket通讯时，对方明明发来了1000个字节，但是自己的程序调用available()方法却只得到900，或者100，甚至是0，感觉有点莫名其妙，怎么也找不到原因。其实，这是因为网络通讯往往是间断性的，一串字节往往分几批进行发送。本地程序调用available()方法有时得到0，这可能是对方还没有响应，也可能是对方已经响应了，但是数据还没有送达本地。对方发送了1000个字节给你，也许分成3批到达，这你就要调用3次available()方法才能将数据总数全部得到。</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; 如果这样写代码：</span></p><p><span style=\"white-space: nowrap;\">&nbsp; int count = in.available();</span></p><p><span style=\"white-space: nowrap;\">&nbsp; byte[] b = new byte[count];</span></p><p><span style=\"white-space: nowrap;\">&nbsp; in.read(b);</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; 在进行网络操作时往往出错，因为你调用available()方法时，对发发送的数据可能还没有到达，你得到的count是0。</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;需要改成这样：</span></p><p><span style=\"white-space: nowrap;\">&nbsp; int count = 0;</span></p><p><span style=\"white-space: nowrap;\">&nbsp; while (count == 0) {</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp;count = in.available();</span></p><p><span style=\"white-space: nowrap;\">&nbsp; }</span></p><p><span style=\"white-space: nowrap;\">&nbsp; byte[] b = new byte[count];</span></p><p><span style=\"white-space: nowrap;\">&nbsp; in.read(b);</span></p><p><span style=\"white-space: nowrap;\">3. 关于InputStream.read(byte[] b)和InputStream.read(byte[] b,int off,int len)这两个方法都是用来从流里读取多个字节的，有经验的程序员就会发现，这两个方法经常 读取不到自己想要读取的个数的字节。比如第一个方法，程序员往往希望程序能读取到b.length个字节，而实际情况是，系统往往读取不了这么多。仔细阅读Java的API说明就发现了，这个方法 并不保证能读取这么多个字节，它只能保证最多读取这么多个字节(最少1个)。因此，如果要让程序读取count个字节，最好用以下代码：</span></p><p><span style=\"white-space: nowrap;\">&nbsp; byte[] b = new byte[count];</span></p><p><span style=\"white-space: nowrap;\">&nbsp; int readCount = 0; // 已经成功读取的字节的个数</span></p><p><span style=\"white-space: nowrap;\">&nbsp; while (readCount &lt; count) {</span></p><p><span style=\"white-space: nowrap;\">&nbsp; &nbsp;readCount += in.read(bytes, readCount, count - readCount);</span></p><p><span style=\"white-space: nowrap;\">&nbsp; }</span></p><p><span style=\"white-space: nowrap;\">&nbsp;用这段代码可以保证读取count个字节，除非中途遇到IO异常或者到了数据流的结尾(EOFException)</span></p><p><br/></p><p><br/></p><p><br/></p><p><strong>#参考文档：</strong></p><p><a href=\"http://www.cnblogs.com/MyFavorite/archive/2010/10/19/1855758.html\" target=\"_blank\" title=\"http://www.cnblogs.com/MyFavorite/archive/2010/10/19/1855758.html\">http://www.cnblogs.com/MyFavorite/archive/2010/10/19/1855758.html</a></p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/18 17:40:40",
      "updateAt": "2015/12/18 17:40:40"
    },
    {
      "title": "全面解析 Java 注解  ",
      "content": "<p>参考文档：</p><p><a title=\"http://blog.csdn.net/cighao/article/details/50295751\" href=\"http://blog.csdn.net/cighao/article/details/50295751\" target=\"_blank\">http://blog.csdn.net/cighao/article/details/50295751</a></p>",
      "show": "0",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/22 09:21:08",
      "updateAt": "2015/12/22 09:21:17"
    },
    {
      "title": "JAVA 7 新特性",
      "content": "<p>参考文档<br/></p><p><a href=\"http://blog.sina.com.cn/s/blog_670c5a4001017bua.html\" title=\"http://blog.sina.com.cn/s/blog_670c5a4001017bua.html\" target=\"_blank\">http://blog.sina.com.cn/s/blog_670c5a4001017bua.html</a></p><p><a href=\"http://www.cnblogs.com/loveis/articles/2013311.html\" title=\"http://www.cnblogs.com/loveis/articles/2013311.html\" target=\"_blank\">http://www.cnblogs.com/loveis/articles/2013311.html</a></p>",
      "show": "0",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/25 11:21:45",
      "updateAt": "2015/12/25 11:22:30"
    },
    {
      "title": "常用辅助工具包学习笔记",
      "content": "<p><strong>Google Guava</strong></p><p><a title=\"http://ifeve.com/google-guava/\" target=\"_blank\" href=\"http://ifeve.com/google-guava/\">http://ifeve.com/google-guava/</a></p><p><a title=\"http://www.cnblogs.com/snidget/archive/2013/02/05/2893344.html\" target=\"_blank\" href=\"http://www.cnblogs.com/snidget/archive/2013/02/05/2893344.html\">http://www.cnblogs.com/snidget/archive/2013/02/05/2893344.html</a></p><p><a title=\"http://www.cnblogs.com/snidget/archive/2013/02/05/2893344.html\" target=\"_blank\" href=\"http://www.cnblogs.com/snidget/archive/2013/02/05/2893344.html\"><br/></a></p><p><strong>Apache Commons</strong></p><p><a title=\"http://zhoualine.iteye.com/blog/1770014\" target=\"_blank\" href=\"http://zhoualine.iteye.com/blog/1770014\">http://zhoualine.iteye.com/blog/1770014</a></p><p><a title=\"http://www.chinaitlab.com/Java/base/859067.html\" target=\"_blank\" href=\"http://www.chinaitlab.com/Java/base/859067.html\">http://www.chinaitlab.com/Java/base/859067.html</a></p><p><a href=\"http://www.cnblogs.com/yangy608/archive/2011/11/26/2264460.html\" title=\"http://www.cnblogs.com/yangy608/archive/2011/11/26/2264460.html\" target=\"_blank\">http://www.cnblogs.com/yangy608/archive/2011/11/26/2264460.html</a></p><p><a href=\"http://commons.apache.org/\" title=\"http://commons.apache.org/\" target=\"_blank\"><a title=\"http://commons.apache.org/\" target=\"_blank\" href=\"http://commons.apache.org/\">http://commons.apache.org/</a></a></p>",
      "show": "0",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/25 10:01:17",
      "updateAt": "2015/12/25 13:48:03"
    },
    {
      "title": "JAVA基础知识汇总",
      "content": "<p><strong>1、clone方法使用详解</strong></p><p><a title=\"http://lovelace.iteye.com/blog/182772\" href=\"http://lovelace.iteye.com/blog/182772\" target=\"_blank\">http://lovelace.iteye.com/blog/182772</a></p><p><strong>2、JAVA集合类</strong></p><p><a title=\"http://www.jianshu.com/p/4e13fcdf9ab5\" href=\"http://www.jianshu.com/p/4e13fcdf9ab5\" target=\"_blank\">http://www.jianshu.com/p/4e13fcdf9ab5</a></p><p><br/></p><p><a title=\"http://lovelace.iteye.com/blog/182772\" href=\"http://lovelace.iteye.com/blog/182772\" target=\"_blank\">未完待续~<br/></a></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2015/12/25 11:32:12",
      "updateAt": "2015/12/27 13:24:26"
    },
    {
      "title": "Windows下使用jdk工具keytool生成证书",
      "content": "<p>打开控制台进入JDK安装目录下的bin目录：这里是“D:\\Program Files\\Java\\jdk1.7.0_51\\bin”</p><p><strong>基本操作</strong><br/></p><p>1、创建一个证书 <br/>指定证书库为 D:/keystore，创建别名为 tomcat70 的一条证书，它指定用 RSA 算法生成，且指定密钥长度为 1024，证书有效期为 1 年： <br/></p><pre class=\"brush:ps;toolbar:false\">keytool&nbsp;-genkey&nbsp;-alias&nbsp;tomcat70&nbsp;-keyalg&nbsp;RSA&nbsp;-keysize&nbsp;1024&nbsp;-keystore&nbsp;D:/keystore&nbsp;-validity&nbsp;365</pre><p><br/>2、显示证书库中的证书使用如下命令：&nbsp; 将显示 D:/keystore 证书库的的所有证书列表 <br/></p><pre class=\"brush:ps;toolbar:false\">keytool&nbsp;-list&nbsp;-keystore&nbsp;D:/keystore</pre><p><br/>3、导出到证书文件 <br/>使用命令：keytool -export -alias tomcat70 -file D:/tomcat70.cer -keystore D:/keystore 将把证书库D:/keystore 中的别名为 tomcat70 的证书导出到 tomcat70.cer 证书文件中，它包含证书主体的信息及证书的公钥，不包括私钥，可以公开。 <br/>导出的证书文件是以二进制编码文件，无法用文本编辑器正确显示，可以加上 -rfc参数以一种可打印的编者编码输出。 如：</p><pre class=\"brush:ps;toolbar:false\">keytool&nbsp;-export&nbsp;-alias&nbsp;tomcat70&nbsp;-file&nbsp;D:/tomcat70.cer&nbsp;-keystore&nbsp;D:/keystore&nbsp;–rfc</pre><p><br/>4、查看证书的信息 <br/>通过命令: keytool -printcert -file D:/tomcat70.cer 可以查看证书文件的信息。 也可以在 Windows 资源管理器中双击产生的证书文件直接查看。</p><pre class=\"brush:ps;toolbar:false\">keytool&nbsp;-printcert&nbsp;-file&nbsp;D:/tomcat70.cer</pre><p><br/></p><p>5、删除密钥库中的条目 <br/>keytool -delete -alias tomcat70 -keystore D:/keystore <br/>这条命令将 D:/keystore 库中的 tomcat70 这一条证书删除了。 <br/></p><pre class=\"brush:ps;toolbar:false\">keytool&nbsp;-delete&nbsp;-alias&nbsp;tomcat70&nbsp;-keystore&nbsp;D:/keystore</pre><p><br/>6、修改证书条目口令 <br/>keytool -keypasswd -alias tomcat70 -keystore D:/keystore，可以以交互的方式修改 D:/keystore 证书库中的条目为 tomcat70 的证书。 <br/>Keytool -keypasswd -alias tomcat70 -keypass oldpasswd -new newpasswd -storepass storepasswd -keystore D:/keystore 这一行命令以非交互式的方式修改库中别名为 tomcat70 的证书的密码为新密码 newpasswd，行中的 oldpasswd 是指该条证书的原密码， storepasswd 是指证书库的密码。</p><pre class=\"brush:ps;toolbar:false\">Keytool&nbsp;-keypasswd&nbsp;-alias&nbsp;tomcat70&nbsp;-keypass&nbsp;oldpasswd&nbsp;-new&nbsp;newpasswd&nbsp;-storepass&nbsp;storepasswd&nbsp;-keystore&nbsp;D:/keystore</pre><p><br/></p><p><strong>基础知识</strong><br/></p><p style=\"margin-top: 5px; margin-right: auto; margin-bottom: 5px; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 19px; background-color: #f9fce9;\">-genkey&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在用户主目录中创建一个默认文件&quot;.keystore&quot;,还会产生一个mykey的别名，mykey中包含用户的公钥、私钥和证书&nbsp;<br/>-alias&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 产生别名<br/>-keystore&nbsp;&nbsp;&nbsp; 指定密钥库的名称(产生的各类信息将不在.keystore文件中<br/>-keyalg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定密钥的算法&nbsp;&nbsp;&nbsp;&nbsp;<br/>-validity&nbsp;&nbsp;&nbsp; 指定创建的证书有效期多少天<br/>-keysize&nbsp;&nbsp;&nbsp;&nbsp; 指定密钥长度<br/>-storepass&nbsp;&nbsp; 指定密钥库的密码<br/>-keypass&nbsp;&nbsp;&nbsp;&nbsp; 指定别名条目的密码<br/>-dname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定证书拥有者信息 例如：&nbsp; &quot;CN=sagely,OU=atr,O=szu,L=sz,ST=gd,C=cn&quot;<br/>-list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 显示密钥库中的证书信息&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; keytool -list -v -keystore sage -storepass ....<br/>-v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 显示密钥库中的证书详细信息<br/>-export&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 将别名指定的证书导出到文件&nbsp; keytool -export -alias caroot -file caroot.crt<br/>-file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 参数指定导出到文件的文件名<br/>-delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 删除密钥库中某条目&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; keytool -delete -alias sage -keystore sage<br/>-keypasswd&nbsp;&nbsp; 修改密钥库中指定条目口令&nbsp;&nbsp;&nbsp; keytool -keypasswd -alias sage -keypass .... -new .... -storepass ... -keystore sage<br/>-import&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 将已签名数字证书导入密钥库&nbsp; keytool -import -alias sage -keystore sagely -file sagely.crt&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 导入已签名数字证书用keytool -list -v 以后可以明显发现多了认证链长度，并且把整个CA链全部打印出来。</p><p style=\"margin-top: 5px; margin-right: auto; margin-bottom: 5px; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 19px; background-color: #f9fce9;\">------------------------------------------------------------------------------------------------</p><p>keytool\n \nJAVA是个密钥和证书管理工具。它使用户能够管理自己的公钥/私钥对及相关证书，用于（通过数字签名）自我认证（用户向别的用户/服务认证自己）或数据\n完整性以及认证服务。它还允许用户储存他们的通信对等者的公钥（以证书形式）。通过keytool –help查看其用法，详细信息可以参考http: \n//java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html&nbsp;<br/><br/>Java中的 keytool.exe （位于 JDK/Bin \n目录下）可以用来创建数字证书，所有的数字证书是以一条一条(采用别名区别)的形式存入证书库的中，证书库中的一条证书包含该条证书的私钥，公钥和对应的\n数字证书的信息。证书库中的一条证书可以导出数字证书文件，数字证书文件只包括主体信息和对应的公钥。&nbsp;<br/>每一个证书库是一个文件组成，它有访问密码，在首次创建时，它会自动生成证书库，并要求指定访问证书库的密码。&nbsp;<br/>在创建证书的的时候，需要填写证书的一些信息和证书对应的私钥密码。这些信息包括 CN=xx,OU=xx,O=xx,L=xx,ST=xx,C=xx，它们的意思是：&nbsp;<br/>?\n CN（Common Name - \n名字与姓氏）：其实这个“名字与姓氏”应该是域名，比如说localhost或是blog.devep.net之类的。输成了姓名，和真正运行的时候域名\n不符，会出问题。浏览器访问时，弹出一个对话框，提示“安全证书上的名称无效，或者与站点名称不匹配”，用户选择继续还是可以浏览网页。但是用http \nclient写程序访问的时候，会抛出类似于“javax.servlet.ServletException: HTTPS hostname \nwrong: should be ”的异常。&nbsp;<br/>? OU（Organization Unit - 组织单位名称）&nbsp;<br/>? O（Organization - 组织名称）&nbsp;<br/>? L（Locality - 城市或区域名称）&nbsp;<br/>? ST（State - 州或省份名称）&nbsp;<br/>? C（Country - 国家名称）&nbsp;<br/>可以采用交互式让工具提示输入以上信息，也可以采用参数，如：-dname “CN=xx,OU=xx,O=xx,L=xx,ST=xx,C=xx”来自动创建。 <br/></p><p><br/></p><p><strong>参考文档</strong></p><p><a textvalue=\"http://deanandbai-gmail-com.iteye.com/blog/1538749\" target=\"_blank\" href=\"http://deanandbai-gmail-com.iteye.com/blog/1538749\">http://deanandbai-gmail-com.iteye.com/blog/1538749</a><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2016/1/30 16:31:40",
      "updateAt": "2016/1/30 18:25:22"
    },
    {
      "title": "java InputStream读取数据问题",
      "content": "<p><a href=\"http://cuisuqiang.iteye.com/blog/1434416\" _src=\"http://cuisuqiang.iteye.com/blog/1434416\">http://cuisuqiang.iteye.com/blog/1434416</a></p><pre class=\"brush:java;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;long&nbsp;makeLocalFile(InputStream&nbsp;stream,&nbsp;String&nbsp;filePath)&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;file&nbsp;=&nbsp;new&nbsp;File(filePath);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file.exists())&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;file.length();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file.getParentFile().exists())&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file.getParentFile().mkdirs())&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(logger.isErrorEnabled())&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logger.error(&quot;create&nbsp;folder&nbsp;failed!&nbsp;file=&quot;&nbsp;+&nbsp;file.getParentFile().getPath());\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//写文件\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;inputStream&nbsp;=&nbsp;stream;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;buffer&nbsp;&nbsp;=&nbsp;new&nbsp;byte[1024];\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;len&nbsp;=&nbsp;-1;\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutputStream&nbsp;os&nbsp;=&nbsp;new&nbsp;FileOutputStream(filePath);\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;((len&nbsp;=&nbsp;inputStream.read(buffer))&nbsp;!=&nbsp;-1)&nbsp;{\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.write(buffer&nbsp;,&nbsp;0,&nbsp;len);\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;len&nbsp;=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;count&nbsp;=&nbsp;1024;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;buffer&nbsp;&nbsp;=&nbsp;new&nbsp;byte[count];\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;readCount&nbsp;=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutputStream&nbsp;os&nbsp;=&nbsp;new&nbsp;FileOutputStream(filePath);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(readCount&nbsp;&lt;&nbsp;count){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;inputStream.read(buffer,readCount,count&nbsp;-&nbsp;readCount);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readCount&nbsp;+=&nbsp;len;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.write(buffer&nbsp;,&nbsp;0,&nbsp;len);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(FileNotFoundException&nbsp;e)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(logger.isErrorEnabled())&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logger.error(&quot;OutputStream&nbsp;write&nbsp;failed!&nbsp;&quot;&nbsp;+e.getMessage()&nbsp;,e);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;CsException(&quot;OutputStream&nbsp;write&nbsp;failed!&nbsp;&quot;&nbsp;+e.getMessage()&nbsp;,e);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(logger.isErrorEnabled())&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logger.error(&quot;OutputStream&nbsp;write&nbsp;failed!&nbsp;&quot;&nbsp;+e.getMessage()&nbsp;,e);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;CsException(&quot;OutputStream&nbsp;write&nbsp;failed!&nbsp;&quot;&nbsp;+e.getMessage()&nbsp;,e);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}finally&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOUtils.closeQuietly(stream);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOUtils.closeQuietly(inputStream);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;file.length();\n&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p><br/></p><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:&#39;宋体&#39;;font-size:12.0pt;\">while&nbsp;((len&nbsp;=&nbsp;inputStream.read(buffer))&nbsp;!=&nbsp;-1)</pre><p>上述方式读取输入流会报错：socket closed<br/></p>",
      "show": "0",
      "channel": "程序员笔记",
      "tag": "JAVA基础",
      "createAt": "2018/1/18 21:20:58",
      "updateAt": "2018/1/18 21:23:49"
    },
    {
      "title": "Learn more 关于ImEthan这个网站",
      "content": "<p><span style=\"color:#548dd4;font-family:微软雅黑, Microsoft YaHei;font-size:24px\">写在前面的话</span></p><p><span style=\"font-size:16px\"><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span></span><span id=\"_baidu_bookmark_start_6\" style=\"display: none; line-height: 0px;\">‍</span>&nbsp; &nbsp; 2006年开始学习计算机知识，2011年开始参加工作实践，时至今日，已经累计了5年的基础知识，以及将近4年的实际生产经验；在移动互联盛行的今天，大数据时代已经早早到来了，看看自身外部环境和内部环境的变化，在2014的这个年度里面，我都特别的希望去拥抱变化；古人说:“工欲善其事，必先利其器”，为了更好去面对接下来遇到的机遇和挑战，急需对过去的知识进行一次整理以及管理，所以就有了这个小站的开发，以此作为一个新的起点，展望下未来。<span id=\"_baidu_bookmark_end_7\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"font-size:16px\"><span id=\"_baidu_bookmark_end_5\" style=\"display: none; line-height: 0px;\">‍</span></span></p><p><br/></p><p><span style=\"color:#548dd4;font-family:微软雅黑, Microsoft YaHei;font-size:24px\">开源说明</span></p><p>&nbsp; &nbsp; 本小站项目开放源代码，代码托管在GitHub上，欢迎下载。<span style=\"line-height: 1.42857143;\">GitHub访问地址：</span><a href=\"https://github.com/ethanwong/imethan-blog\" target=\"_blank\" title=\"https://github.com/ethanwong/imethan-blog\"><span style=\"line-height: 1.42857; background-color: rgb(255, 255, 255);\">https://github.com/ethanwong/imethan</span>-blog</a></p><p><br/></p><p><span style=\"color:#548dd4;font-family:微软雅黑, Microsoft YaHei;font-size:24px\">开发环境</span></p><ol><li><p>IDE使用Spring tool suite,简称“<span style=\"line-height: 22.8571434020996px; white-space: normal;\">STS</span>”，是Spring自行定制的Eclispe，好用，为它点个赞。</p></li><li><p>使用自动化工具Gradle作为项目的构建工具，Gradle为类似Maven类的构建工具，比Maven简洁。</p></li><li><p>本地开发调试使用的是Jetty 6，生产环境使用的是Tomcat 7。</p></li><li><p>在Windows NT环境下开发，部署于Linux环境。</p></li><li><p>数据库使用的是MySQL 5。</p></li><li><p>JDK版本为1.7。</p></li></ol><p><br/></p><p><span style=\"color:#548dd4;font-family:微软雅黑, Microsoft YaHei;font-size:24px\">技术架构</span></p><ol><li><p>使用Spring作为IOC容器，实现AOP功能，并且整合项目中用到的其他开源框架，例如:Apache shiro,Hibernate等。<br/></p></li><li><p>使用Spring data jpa作为数据库持久层规范，底层实现采用的是Hibernate框架，Hibernate是一个轻量级的ORM框架。</p></li><li><p>使用Spring MVC框架，开始使用了Spring MVC后才发现，Struts2是那么的“厚重”。</p></li><li><p>使用Apache shiro作为权限框架，Apache shiro相对会比Spring Security简单,<span style=\"line-height: 22.8571434020996px; white-space: normal;\">Spring Security功能更加强大</span>。</p></li><li><p>为了减少页面开发代码的冗余，还引入了SiteMesh装饰框架，简单易用，提高开发效率。</p></li><li><p>前端页面展现使用了Bootstrap开源框架，做出来效果简洁大方，节省了大量的时间。</p></li><li><p>页面交互使用了较多的Ajax交互，页面渲染性能不是很高，后期学习了NodeJs后再来完善。</p></li><li><p>Jquery插件是使用如下：</p></li></ol><ul><li>富文本编辑器，即此刻编写这边文章在用的编辑器使用的百度前端开发团队的UEditor。</li><li>图片上传插件，使用的也是百度前端开发团队的webuploader。</li><li>“Blog”模块的下拉滚动插件使<span id=\"_baidu_bookmark_start_1\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_3\" style=\"display: none; line-height: 0px;\">‍</span>用的是<a href=\"https://github.com/ethanxm/imethan/blob/master/WebContent/theme/js/jquery.infinitescroll.js\" id=\"5634f3947cec655e21a22d0307717713-88633e12e2164348e56f1bd96d515a7747a83eca\" title=\"jquery.infinitescroll.js\">jquery.infinitescroll.js<span id=\"_baidu_bookmark_end_2\" style=\"display: none; line-height: 0px;\">‍</span></a>。<span id=\"_baidu_bookmark_end_4\" style=\"display: none; line-height: 0px;\">‍</span></li><li>文章阅读更多使<span id=\"_baidu_bookmark_start_6\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_8\" style=\"display: none; line-height: 0px;\">‍</span>用的插件是<a href=\"https://github.com/ethanxm/imethan/blob/master/WebContent/theme/js/readmore.js\" id=\"f02c54a9a80a30ed724a772e1be05715-3296b45ef8bd194f1e06c9c0e37dcb49fd4ab44e\" title=\"readmore.js\">readmore.js<span id=\"_baidu_bookmark_end_7\" style=\"display: none; line-height: 0px;\">‍</span></a>。<span id=\"_baidu_bookmark_end_9\" style=\"display: none; line-height: 0px;\">‍</span></li><li>树形展现插件使用的是国产的Ztree。</li></ul><p><br/></p><p><span style=\"color:#548dd4;font-family:微软雅黑, Microsoft YaHei;font-size:24px\">其他说明</span></p><p>&nbsp; &nbsp;本人的英文水平仅限于阅读开源社区的英文文档，小站的大多数地方使用了英文，仅仅是因为英文的排版比中文好看，如果有错误，或者错别字，欢迎指正，谢谢。</p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "ImEthan项目",
      "tag": "ImEthan",
      "createAt": "2014/12/25 22:16:49",
      "updateAt": "2015/12/18 22:16:49"
    },
    {
      "title": "加密代码片段",
      "content": "<p><br/></p><p><span style=\"white-space: nowrap;\">import org.junit.Test;</span></p><p><span style=\"white-space: nowrap;\">import org.suncco.framework.commons.core.encode.DigestUtils;</span></p><p><span style=\"white-space: nowrap;\">import org.suncco.framework.commons.core.encode.EncryptUtils;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author ETHAN</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @email huangyf@suncco.com</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @datetime 2013-4-8下午4:44:48</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @copyright 2011-2015</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @version 1.0</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public class PasswordTest {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Test</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void t1(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;//sk 6332733d</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;//sk@2014 633274414d6a41784e413d3d</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String encode = DigestUtils.encode(&quot;smasjm123456&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(encode);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String decode = DigestUtils.decode(encode);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>System.out.println(decode);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>@Test</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public void t2(){</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; String MD5Password = EncryptUtils.Encrypt(&quot;sunccosmas@password123456&quot;, &quot;MD5&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> &nbsp; &nbsp;System.out.println(EncryptUtils.Encrypt(MD5Password, &quot;SHA-256&quot;));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span style=\"white-space: nowrap;\">package org.suncco.framework.commons.core.encode;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import java.io.IOException;</span></p><p><span style=\"white-space: nowrap;\">import java.io.InputStream;</span></p><p><span style=\"white-space: nowrap;\">import java.security.GeneralSecurityException;</span></p><p><span style=\"white-space: nowrap;\">import java.security.MessageDigest;</span></p><p><span style=\"white-space: nowrap;\">import java.security.SecureRandom;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import org.apache.commons.codec.DecoderException;</span></p><p><span style=\"white-space: nowrap;\">import org.apache.commons.codec.binary.Hex;</span></p><p><span style=\"white-space: nowrap;\">import org.apache.commons.lang.Validate;</span></p><p><span style=\"white-space: nowrap;\">import org.suncco.framework.commons.core.exception.ExceptionUtils;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* 自定义类型的数值摘要的加密和解密处理类.</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* 支持SHA-1/MD5消息摘要的工具类.</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* 返回ByteSource，可进一步被编码为Hex, Base64或UrlSafeBase64</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Qing</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @e-mail lhq@suncco.com</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @version v1.0</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @copyright 2010-2015</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @create-time 2013-1-5 下午5:26:40</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public class DigestUtils {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static final String SHA1 = &quot;SHA-1&quot;;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static final String MD5 = &quot;MD5&quot;;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static SecureRandom random = new SecureRandom();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 加密.先进行64位的加密 再继续16进制的加密</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param encode 要加密的字符串</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return 双重加密后的字符串</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static String encode(String encode) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>encode = new String(EncodeUtils.encodeBase64(encode.getBytes()));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>encode = new String(Hex.encodeHex(encode.getBytes()));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return encode;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 解密.先进行16进制的解密，再进行64位的解密</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param decode 要解密的字符串</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return 双重解密后的字符串</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static String decode(String decode) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>decode = new String(Hex.decodeHex(decode.toCharArray()));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>decode = new String(EncodeUtils.decodeBase64String(decode));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (DecoderException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>e.printStackTrace();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return decode;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 对输入字符串进行sha1散列.</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static byte[] sha1(byte[] input) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return digest(input, SHA1, null, 1);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static byte[] sha1(byte[] input, byte[] salt) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return digest(input, SHA1, salt, 1);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static byte[] sha1(byte[] input, byte[] salt, int iterations) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return digest(input, SHA1, salt, iterations);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 对字符串进行散列, 支持md5与sha1算法.</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static byte[] digest(byte[] input, String algorithm, byte[] salt, int iterations) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>MessageDigest digest = MessageDigest.getInstance(algorithm);</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>if (salt != null) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>digest.update(salt);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>byte[] result = digest.digest(input);</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>for (int i = 1; i &lt; iterations; i++) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>digest.reset();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>result = digest.digest(result);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>return result;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (GeneralSecurityException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>throw ExceptionUtils.unchecked(e);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 生成随机的Byte[]作为salt.</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> *&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param numBytes byte数组的大小</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static byte[] generateSalt(int numBytes) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>Validate.isTrue(numBytes &gt; 0, &quot;numBytes argument must be a positive integer (1 or larger)&quot;, numBytes);</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>byte[] bytes = new byte[numBytes];</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>random.nextBytes(bytes);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return bytes;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 对文件进行md5散列.</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static byte[] md5(InputStream input) throws IOException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return digest(input, MD5);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 对文件进行sha1散列.</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static byte[] sha1(InputStream input) throws IOException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return digest(input, SHA1);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>private static byte[] digest(InputStream input, String algorithm) throws IOException {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>MessageDigest messageDigest = MessageDigest.getInstance(algorithm);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>int bufferLength = 8 * 1024;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>byte[] buffer = new byte[bufferLength];</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>int read = input.read(buffer, 0, bufferLength);</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>while (read &gt; -1) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>messageDigest.update(buffer, 0, read);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>read = input.read(buffer, 0, bufferLength);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>return messageDigest.digest();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (GeneralSecurityException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>throw ExceptionUtils.unchecked(e);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\"></span></p><p><span style=\"white-space: nowrap;\">package org.suncco.framework.commons.core.encode;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">import java.security.MessageDigest;</span></p><p><span style=\"white-space: nowrap;\">import java.security.NoSuchAlgorithmException;</span></p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">/**</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* 字符串加密工具</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @author Qing</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @e-mail lhq@suncco.com</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @version v1.0</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @copyright 2010-2015</span></p><p><span style=\"white-space: nowrap;\">&nbsp;* @create-time 2013-1-24 下午1:55:15</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*&nbsp;</span></p><p><span style=\"white-space: nowrap;\">&nbsp;*/</span></p><p><span style=\"white-space: nowrap;\">public class EncryptUtils {</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>/**</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * 对字符串加密,加密算法使用MD5,SHA-1,SHA-256,默认使用SHA-256</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param strSrc 要加密的字符串</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @param encName 加密类型</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> * @return</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span> */</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static String Encrypt(String strSrc, String encName) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>MessageDigest md = null;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String strDes = null;</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>byte[] bt = strSrc.getBytes();</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>try {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>if (encName == null || encName.equals(&quot;&quot;)) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>encName = &quot;SHA-256&quot;;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>md = MessageDigest.getInstance(encName);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>md.update(bt);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>strDes = bytes2Hex(md.digest()); // to HexString</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>} catch (NoSuchAlgorithmException e) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>return null;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return strDes;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>public static String bytes2Hex(byte[] bts) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String des = &quot;&quot;;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>String tmp = null;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>for (int i = 0; i &lt; bts.length; i++) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>tmp = (Integer.toHexString(bts[i] &amp; 0xFF));</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>if (tmp.length() == 1) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t\t</span>des += &quot;0&quot;;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t\t</span>des += tmp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>}</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t\t</span>return des;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span>}</p><p><span style=\"white-space: nowrap;\"><br/></span></p><p><span style=\"white-space: nowrap;\">}</span></p><p><span style=\"white-space: nowrap;\"><br/></span><br/></p><p><span style=\"white-space: nowrap;\"><br/></span><br/></p><p><br/></p>",
      "show": "1",
      "channel": "test article",
      "tag": "ImEthan",
      "createAt": "",
      "updateAt": "2015/12/19 18:50:04"
    },
    {
      "title": "ImEthanAdmin项目后台模板选型",
      "content": "<p>\n    晚上开始调研后台模板的使用选型，最终选中“AdminLte”&nbsp;<a href=\"https://www.almsaeedstudio.com/\" target=\"_self\" title=\"https://www.almsaeedstudio.com/\">https://www.almsaeedstudio.com/</a>\n</p>\n<p>\n    <img class=\"imgwh\" src=\"https://www.almsaeedstudio.com/img/AdminLTE2.1.png\" _src=\"https://www.almsaeedstudio.com/img/AdminLTE2.1.png\"/>\n</p>",
      "show": "1",
      "channel": "ImEthan项目",
      "tag": "ImEthan",
      "createAt": "2015/12/18 22:17:06",
      "updateAt": "2015/12/19 22:08:01"
    },
    {
      "title": "ImEthanAdmin权限系统介绍",
      "content": "<p>基于JAVA开发的企业级项目通用权限框架</p><p>1、使用Spring作为项目基础框架，使用Spring MVC实现视图控制，整合Spring security权限框架</p><p>依据IOC容器，实现bean类的依赖注入；实现用户登录、授权、记住我、会话并发等功能</p><p>2、数据持久层使用Hibernate ORM框架</p><p>实现快速分页、检索、更新、删除等功能</p><p>3、使用sitemesh2作为页面装饰框架</p><p>4、该项目还整合了如下开源架构</p><p>Spring data mongo、Spring data jpa、log4j2、quartz、ehcache等</p><p><br/></p><p>主要功能</p><p>用户管理、角色管理、菜单管理、授权管理</p><p><br/></p><p>其他说明</p><p>使用gradle构建项目、基于JDK1.7、Servlet 3.0</p><p><br/></p><p>GitHub开放源代码地址：<a title=\"https://github.com/ethanwong/imethan-admin\" href=\"https://github.com/ethanwong/imethan-admin\" target=\"_blank\">https://github.com/ethanwong/imethan-admin</a></p>",
      "show": "1",
      "channel": "ImEthan项目",
      "tag": "ImEthan",
      "createAt": "2015/12/25 18:14:02",
      "updateAt": "2015/12/25 18:15:09"
    },
    {
      "title": "ImEthan独立博客介绍",
      "content": "<p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">ImEthan独立博客介绍开篇</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">&nbsp;&nbsp;&nbsp;&nbsp;我的大学时代，那时国内的微博和轻博客都还没出生，博客还是一个非常时髦的东西，很多人都有；我也有在各种网站注册了各种的博客，但是无一一个有认真维护的；原因是我想自己开发一个博客，理由是自己开发的博客想要怎样的功能都可以自己开发定制，而且不带各种让人厌烦的广告,但是由于当时的云服务技术并没有<span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">像</span>现在这样<span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">发展的</span>这么好，所以昂贵的服务器一直是阻碍我架设自己独立博客的绊脚石；有了这个绊脚石存在，我就没有开始着手独立博客的开发，但是心里还是默默的惦记的建立自己独立博客的这件事情。</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;到了2014年，是我大学毕业的第三个年头，开始考虑自己的职业生涯和技能沉淀，重新萌生了经营自己“品牌”的念想，也对自己这些年的职业技能做一个梳理和整理，所以开始注册域名“imethan.cn”,开始开发“ImEthan”独立博客，开始的时候域名没有备案，服务托管在亚马逊的AWS服务器，到2015年才正式备案了域名，于是将服务迁移至百度BAE云服务至今，“ImEthan”博客的内容以及功能也持续在更新和升级。</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-weight: 700; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">首先来说下我的英文名“Ethan Wong”</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;这个英文名字是2009年夏天在大学宿舍自己取的，“Ethan”和中文名发音相似，也有顶天立地男子汉的意思，“Wong”是中文姓黄的意思；因为大学毕业了以后就确定自己以后将投入到无限的IT事业中了，而从事IT是免不了和英文打交道的，在编程、设计甚至于文件夹的命名都需要有一个合适的命名，再者在编程界，有一个问题是摧残了一代又一代的IT人，那就是中文乱码问题，再有一个应该是当时已经有了一些品牌意识，想塑造自己的品牌，当时Adobe Photoshop技术学习的还不赖，还设计了如下logo:</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><img width=\"100\" src=\"http://7xp43b.com1.z0.glb.clouddn.com/20131110%E5%A4%B4%E5%83%8F.jpg\"/><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp;</span><img width=\"100\" src=\"http://7xp43b.com1.z0.glb.clouddn.com/Ethan-Design-mouse.jpg\"/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">备注:图片文件存在的七牛云存储上：</span><a title=\"http://www.qiniu.com/\" href=\"http://www.qiniu.com/\" target=\"_blank\" style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">http://www.qiniu.com/</span></a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-weight: 700; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">再来说说域名“imethan.cn”</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;ImEthanBlog的域名是“imethan.cn<span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">”</span>，意思是“I am ethan ”，“ethan”是我的英文名称，上个段落已经有做说明了；该域名于2014年3月在原万网，现在是阿里巴巴通信技术（北京）有限公司注册的，<span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">也不是</span>一开始就把注册名称定为“imethan.cn”,而是考虑了很多，翻阅了一些域名注册的资料，甚至考虑键盘输入的便捷性等。域名注册之初，当时的域名备案还仍然比较麻烦，一直到今年的下半年，借助百度的域名备案系统成功了将域名备案，至此，“imethan.cn”可以合法指向国内服务器。</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><br/></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>LOGO图标说明</strong></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">ImEthanBlog使用的logo图标是一个大写的英文字符“E”，Ethan的第一个字母，背景为简约蓝，字体为白色，简约是我一直追求的设计的风格，制作的LOGO图标如下:</span></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><img width=\"100\" src=\"http://www.imethan.cn/theme/images/e-rgb(76,%20142,%20250).png\"/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong style=\"line-height: 22.8571px;\">功能模块<span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">介绍</span></strong><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong>说到博客的功能，最早要从学生时代的课程设计说起，学生时代的课程设计我总共做过2个博客，一个是单用户博客，一个多用户博客，也算了有一定的需求调研基础，博客系统其实是一个CMS系统，但是ImEthan我并没有把它单纯的做成是一个博客，而是做成我个人的知识管理门户，包括的职业技能积累、我的TODO事项以及我个人简历的维护。</span></p><ol class=\" list-paddingleft-2\"><li><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">Home:首页或者引导页，设置了几个快捷访问的入口和云标签的展现<br/></span></p></li><li><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">Blog:博客文章模块，ImEthan的所有干货都在这里<br/></span></p></li><li><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">Todo:我的TODO列表，记录我的待办事项，包括技能学习等等的事项都记录在上面<br/></span></p></li><li><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">Contact:联系我模块，该模块和我邮件连接，留言后消息可自动发送至我的邮箱<br/></span></p></li><li><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">GitHub:这里是我GitHub主页的链接，我的开放源代码都发布在上面<br/></span></p></li><li><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">About:个人简历展示模块，正常情况下，我会将简历详情隐藏，待到派上用场的时候再设置公开<br/></span></p></li></ol><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"></span></p><p style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>开发时间说明</strong></span></p><p style=\"white-space: normal; line-height: 22.8571px;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong>博客从2014年3月份开始着手准备开发的，是从UI选型、项目架构开始的，然后中间因为工作很忙的原因，中断过好几次，所有的功能都是陆陆续续开发完成的。</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 22.8571px;\">&nbsp; &nbsp;</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>技术架构和开源介绍</strong></span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;在ImEthan上线之初就写过一篇类似的文章，该篇文章的编写算是补充吧，关于技术和开源说明请看这篇文章：</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;</span><a style=\"color: rgb(65, 131, 196); white-space: normal; font-size: 24px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline; background-color: rgb(255, 255, 255);\" href=\"http://www.imethan.cn/blog/article/25\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Learn more 关于ImEthan这个网站</span></a></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp;&nbsp;</span></p><p style=\"line-height: 22.8571px; white-space: normal;\"><span style=\"line-height: 22.8571px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp;&nbsp;<img src=\"http://img.baidu.com/hi/tsj/t_0003.gif\"/>&nbsp;发个表情，再接再厉</span></p>",
      "show": "1",
      "channel": "ImEthan项目",
      "tag": "ImEthan",
      "createAt": "2015/12/18 22:26:58",
      "updateAt": "2016/1/5 12:18:13"
    },
    {
      "title": "imethan-blog使用的开源技术汇总",
      "content": "<p>编写这篇文章对imethan-blog使用的开源技术进行汇总，包括前端和后端。</p><p><strong>前端使用的框架</strong></p><p><br/></p><p><strong>后端使用的框架</strong></p>",
      "show": "0",
      "channel": "ImEthan项目",
      "tag": "ImEthan",
      "createAt": "2016/1/17 23:07:39",
      "updateAt": "2016/1/17 23:08:12"
    },
    {
      "title": "JSTL标签使用说明",
      "content": "<h2>1.EL语言介绍</h2><p>EL语言是JSTL输出（输入）一个JAVA表达式的表示形式。</p><p>在JSTL中，EL语言只能在属性值中使用。EL语言只能通过建立表达式${exp1}来进行调用。在属性值中使用表达式有三种方式。</p><p>1、 value属性包含一个表达式</p><p>在这种情况下，表达式值被计算出来并根据类型转换规则赋值给value属性。比如：中的${username}就是一个EL，它相当于JSP语\n句&lt;%=request.getAttribute(“username”)%&gt;或&amp;\nlt;%=session.getAttribute(“username”)%&gt;</p><p>2、 value属性包含一个或多个属性，这些属性被文本分割或围绕</p><p>在这种情况下，表达式从左到右进行计算，并将结果转换为字符串型（根据类型转换规则），并将结果赋值给value属性</p><p>3、 value属性仅仅包含文本</p><p>在这种情况下，字符串型属性value将根据类型转换规则转换为标签所希望的类型。</p><h2>2.EL语言的操作符</h2><p>取得某个对象或集合中的属性值</p><p>为了获得集合中的属性，EL支持以下两种操作</p><p>1． 使用.操作符来获得有名字的属性。例如表达式${user.username}表明对象user的username属性</p><p>2． 使用[]操作符来获得有名字或按数字排列的属性。</p><p>表达式${user[&quot;username&quot;]}和表达式${user. username }含义相同</p><p>表达式${row[0]} 表明row集合的第一个条目。</p><p>在这里user是一个类的对象，它的属性username必须符合标准JavaBean的规范，即必须为username属性定义相应的getter、setter方法。</p><h2>3.Empty操作符(空值检查)</h2><p>使用empty操作符来决定对象、集合或字符串变量是否为空或null。例如</p><p>${empty param.username}</p><p>如果request的参数列表中的username值为null，则表达式的值为true。</p><p>EL也可以直接使用比较操作符与null进行比较。如${param.firstname == null}。</p><p class=\"h3\"></p><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">比较操作符</th><th class=\"box\">描述</th></tr><tr><td class=\"box\">== 或 eq</td><td class=\"box\">相等检查</td></tr><tr><td class=\"box\">!= 或 ne</td><td class=\"box\">不等检查</td></tr><tr><td class=\"box\">&lt; 或 lt</td><td class=\"box\">小于检查</td></tr><tr><td class=\"box\">&gt; 或 gt</td><td class=\"box\">大于检查</td></tr><tr><td class=\"box\">&lt;= 或 le</td><td class=\"box\">小于等于检查</td></tr><tr><td>&gt;= 或 ge</td><td>大于等于检查</td></tr></tbody></table><h2>4.Core通用标签</h2><p><span style=\"color:blue\">c:out</span>&nbsp;标签用于在JSP中显示数据，它有如下属性</p><p class=\"h3\"></p><table class=\"box\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">属 性</th><th class=\"box\">描 述</th><th class=\"box\">是否必须</th><th class=\"box\">缺省值</th></tr><tr><td class=\"box\">value</td><td class=\"box\">输出的信息，可以是EL表达式或常量</td><td class=\"box\">是</td><td class=\"box\">无</td></tr><tr><td class=\"box\">default</td><td class=\"box\">value为空时显示信息</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td>escapeXml</td><td>为true则避开特殊的xml字符集</td><td class=\"box\">否</td><td>true</td></tr></tbody></table><p>例子: 您的用户名是:</p><p>显示用户的用户名，如为空则显示guest，指定从session中获取username的值显示；</p><p>显示username的值，默认是从request(page)中取，如果request中没有名为username的对象则从session中取，session中没有则从application(servletContext)中取，如果没有取到任何值则不显示。</p><p>&lt;c:out value=&quot;${session.username}&quot; default=&quot;guest&quot; escapeXml=&quot;false&quot;/&gt;</p><p><span style=\"color:blue\">c:set</span>&nbsp;标签用于保存数据，它有如下属性</p><p class=\"h3\"></p><table class=\"box\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">属 性</th><th class=\"box\">描 述</th><th class=\"box\">是否必须</th><th class=\"box\">缺省值</th></tr><tr><td class=\"box\">value</td><td class=\"box\">要保存的信息，可以是EL表达式或常量</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td class=\"box\">target</td><td class=\"box\">需要修改属性的变量名，一般为javabean的实例</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td class=\"box\">property</td><td class=\"box\">需要修改的javabean属性</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td class=\"box\">var</td><td class=\"box\">需要保存信息的变量</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td class=\"box\">scope</td><td class=\"box\">保存信息的变量的范围</td><td class=\"box\">否</td><td class=\"box\">page</td></tr></tbody></table><p>如果指定了target属性, 那么property属性也必须指定。</p><p>例子：</p><p>将test.testinfo的值保存到session的test2中，其中test是一个javabean的实例，testinfo是test对象的属性。</p><p>&lt;c:set var=&quot;test2&quot; scope=&quot;session&quot; target=&quot;test&quot; property=&quot;testinfo&quot;/&gt;, 或者：</p><p>&lt;c:set var=&quot;test2&quot; scope=&quot;session&quot; value=&quot;${test.testinfo}&quot;/&gt;</p><p>将对象cust.address的city属性值保存到变量city中</p><p>&lt;c:set var=&quot;city&quot; value=&quot;${cust.address.city}&quot;/&gt;</p><p><span style=\"color:blue\">c:remove</span>&nbsp;标签用于删除数据，它有如下属性</p><p class=\"h3\"></p><table class=\"box\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">属 性</th><th class=\"box\">描 述</th><th class=\"box\">是否必须</th><th class=\"box\">缺省值</th></tr><tr><td class=\"box\">var</td><td class=\"box\">要删除的变量</td><td class=\"box\">是</td><td class=\"box\">无</td></tr><tr><td>scope</td><td>被删除变量的范围</td><td>否</td><td>所有范围，包括page、request、session、application等</td></tr></tbody></table><p>例子:</p><p>从session中删除test2变量。</p><p>&lt;c:remove var=&quot;city&quot; scope=&quot;request&quot;/&gt;</p><h2>5.流控制标签</h2><p><span style=\"color:blue\">c:if</span>&nbsp;标签有如下属性</p><p class=\"h3\"></p><table class=\"box\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">属 性</th><th class=\"box\">描 述</th><th class=\"box\">是否必须</th><th class=\"box\">缺省值</th></tr><tr><td class=\"box\">test</td><td class=\"box\">需要评价的条件，相当于if (...){}语句中的条件</td><td class=\"box\">是</td><td class=\"box\">无</td></tr><tr><td class=\"box\">var</td><td class=\"box\">要求保存条件结果的变量名</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td>scope</td><td>保存条件结果的变量范围</td><td>否</td><td>page</td></tr></tbody></table><p>c:choose,c:when,c:otherwise 组合（如果...如果...如果...其他...）标签</p><p><span style=\"color:blue\">c:choose</span>&nbsp;这个标签不接受任何属性</p><p><span style=\"color:blue\">c:when</span>&nbsp;标签有以下属性</p><p class=\"h3\"></p><table class=\"box\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">属 性</th><th class=\"box\">描 述</th><th class=\"box\">是否必须</th><th class=\"box\">缺省值</th></tr><tr><td>test</td><td>需要评价的条件</td><td>是</td><td>无</td></tr></tbody></table><p><span style=\"color:blue\">c:otherwise</span>&nbsp;这个标签同样不接受任何属性</p><p>例子：</p><p>只有当条件user.generous返回值是true时，才显示user.generous</p><p>只有当条件user.stingy返回值是true时，才显示user.stingy</p><p>其它所有的情况（即user.generous和user.stingy的值都不为true）全部显示user.generous and user.stingy.</p><p>&lt;c:choose&gt;</p><p>&lt;c:when test=&quot;${user.generous}&quot;&gt;&lt;c:out value=&quot;${user.generous}&quot;/&gt;&lt;/c:when&gt;</p><p>&lt;c:when test=&quot;${user.stingy}&quot;&gt;&lt;c:out value=&quot;${user.stingy}&quot;/&gt;&lt;/c:when&gt;</p><p>&lt;c:otherwise&gt;&lt;c:out value=&quot;${user.generous} and {user.stingy}&quot;/&gt;&lt;/otherwise&gt;</p><p>&lt;/c:choose&gt;</p><p>由于JSTL没有形如if (){…} else {…}的条件语句，所以这种形式的语句只能用、和标签共同来完成了。</p><h2>6.循环控制标签</h2><p><span style=\"color:blue\">c:forEach</span>&nbsp;标签用于通用数据，它有以下属性</p><p class=\"h3\"></p><table class=\"box\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><th class=\"box\">属 性</th><th class=\"box\">描 述</th><th class=\"box\">是否必须</th><th class=\"box\">缺省值</th></tr><tr><td class=\"box\">items</td><td class=\"box\">进行循环的项目(是一个集合)</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td class=\"box\">begin</td><td class=\"box\">开始条件</td><td class=\"box\">否</td><td class=\"box\">0</td></tr><tr><td class=\"box\">end</td><td class=\"box\">结束条件</td><td class=\"box\">否</td><td class=\"box\">集合中的最后一个项目</td></tr><tr><td class=\"box\">step</td><td class=\"box\">步长</td><td class=\"box\">否</td><td class=\"box\">1</td></tr><tr><td class=\"box\">var</td><td class=\"box\">代表当前项目的变量名</td><td class=\"box\">否</td><td class=\"box\">无</td></tr><tr><td class=\"box\">varStatus</td><td>显示循环状态的变量</td><td class=\"box\">否</td><td class=\"box\">无</td></tr></tbody></table><p>varStatus 变量的其他属性：</p><p>.index 索引号，从 0 开始计算</p><p>.count 量值，从 1 开始计算</p><p>.first 判断当前对象是不是集合中第一个对象</p><p>.last 判断当前对象是不是集合中最后一个对象</p><p><br/></p><p>参考文档</p><p><a title=\"http://ecourse.gdqy.edu.cn/2009/wlkc/shouye/coreTag.html\" target=\"_blank\" href=\"http://ecourse.gdqy.edu.cn/2009/wlkc/shouye/coreTag.html\">http://ecourse.gdqy.edu.cn/2009/wlkc/shouye/coreTag.html</a></p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "JSP",
      "createAt": "2015/12/25 17:51:24",
      "updateAt": "2015/12/25 17:56:18"
    },
    {
      "title": "Apache Shiro配置shiroFilter过滤url鉴权引起错误问题的处理",
      "content": "<p>Apache Shiro配置shiroFilter拦截url登录于鉴权引起的错误问题处理</p><pre class=\"brush:xml;toolbar:false\">&lt;!--&nbsp;Shiro&nbsp;Filter&nbsp;--&gt;\n&lt;bean&nbsp;id=&quot;shiroFilter&quot;&nbsp;class=&quot;org.apache.shiro.spring.web.ShiroFilterFactoryBean&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;securityManager&quot;&nbsp;ref=&quot;securityManager&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;loginUrl&quot;&nbsp;value=&quot;/login&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;successUrl&quot;&nbsp;value=&quot;/system/main&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;unauthorizedUrl&quot;&nbsp;value=&quot;/login&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;filterChainDefinitions&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;value&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/toSignin&nbsp;=&nbsp;anon\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/signin&nbsp;=&nbsp;anon\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/validateCode&nbsp;=&nbsp;anon\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/console/**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/blog/article/input**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/blog/tag**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/blog/channel**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/todo/input**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/todo/edit**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/todoitem/input**&nbsp;=&nbsp;authc\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/value&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/property&gt;\n&lt;/bean&gt;</pre><p>在上述配置中加authc的url，如果用户没登陆，便会跳转到loginUrl进行登陆。</p><p><span style=\"line-height: 1.5;\">如果通过在方法上加注解@RequiresAuthentication去实现url的鉴权，则存在如下问题：</span></p><p>1. 如果用户没登陆系统，系统给出如下异常：</p><p>org.apache.shiro.authz.UnauthenticatedException: The current Subject is not authenticated. &nbsp;Access denied.</p><p><span style=\"line-height: 1.5;\">而不会跳转到loginUrl登陆。</span></p><p>2.如果是用户已经登陆，但是没某个url操作的权限，则需要在方法上加注解@RequiresPermissions(value=&quot;user:create&quot;)让其具有权限才能执行，否则抛出如下异常：</p><p><span style=\"line-height: 1.5;\">org.apache.shiro.authz.UnauthorizedException:&nbsp;</span><span style=\"line-height: 1.5;\">Subject does not have permission [user:create]</span></p><p>而不会跳转到loginUrl登陆。</p><p><br/></p><p>为了对这些异常进行拦截处理，可以通过如下方法</p><p>1、编写Spring MVC拦截器进行拦截</p><p><span style=\"line-height: 1.5;\">2、配置Spring MVC全局错误拦截</span></p><p><span style=\"line-height: 1.5;\"><br/></span></p><p><span style=\"line-height: 1.5;\">这里进行Spring MVC全局错误拦截：</span></p><p><span style=\"line-height: 1.5;\"></span></p><p>&lt;!-- 全局错误拦截配置 --&gt;</p><pre class=\"brush:xml;toolbar:false\">&lt;bean&nbsp;class=&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;exceptionMappings&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;props&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;登录错误&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;prop&nbsp;key=&quot;org.apache.shiro.authz.UnauthenticatedException&quot;&gt;redirect:/login&lt;/prop&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;授权错误&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;prop&nbsp;key=&quot;org.apache.shiro.authz.UnauthorizedException&quot;&gt;/base/error/403&lt;/prop&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/props&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/property&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;默认错误&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;defaultErrorView&quot;&nbsp;value=&quot;/base/error/500&quot;/&gt;\n&lt;/bean&gt;</pre><p><br/></p><p><strong>参考文档</strong></p><p><a title=\"http://wenku.baidu.com/view/97f5868b76eeaeaad1f33065.html\" href=\"http://wenku.baidu.com/view/97f5868b76eeaeaad1f33065.html\" target=\"_blank\">http://wenku.baidu.com/view/97f5868b76eeaeaad1f33065.html</a></p><p><br/></p>",
      "show": "1",
      "channel": "Apache框架笔记",
      "tag": "Apache Shiro",
      "createAt": "2015/12/27 22:25:41",
      "updateAt": "2015/12/28 22:51:40"
    },
    {
      "title": "Struts2专题之一：创建一个简单Struts2 WEB应用",
      "content": "<p>1、创建一个java&nbsp;maven web项目<br/></p><p>pom.xml文件内容如下：<br/></p><pre class=\"brush:xml;toolbar:false\">&lt;project&nbsp;xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;&nbsp;xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\t&lt;groupId&gt;cn.imethan.web.struts2&lt;/groupId&gt;\n\t&lt;artifactId&gt;imethan-struts2&lt;/artifactId&gt;\n\t&lt;packaging&gt;war&lt;/packaging&gt;\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n\t&lt;name&gt;imethan-struts2&nbsp;Maven&nbsp;Webapp&lt;/name&gt;\n\t&lt;url&gt;http://maven.apache.org&lt;/url&gt;\t\n\n\t&lt;dependencies&gt;\t\t\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;junit&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;junit&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;3.8.1&lt;/version&gt;\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\n\t\t&lt;/dependency&gt;\n\t&lt;/dependencies&gt;\n\n\t&lt;build&gt;\n\t\t&lt;finalName&gt;imethan-struts2&lt;/finalName&gt;\n\t\t&lt;plugins&gt;\n\t\t\t&lt;plugin&gt;\n\t\t\t\t&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n\t\t\t\t&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n\t\t\t\t&lt;version&gt;3.1&lt;/version&gt;\n\t\t\t\t&lt;configuration&gt;\n\t\t\t\t\t&lt;source&gt;1.8&lt;/source&gt;\n\t\t\t\t\t&lt;target&gt;1.8&lt;/target&gt;\n\t\t\t\t\t&lt;encoding&gt;UTF-8&lt;/encoding&gt;\n\t\t\t\t&lt;/configuration&gt;\n\t\t\t&lt;/plugin&gt;\n\t\t&lt;/plugins&gt;\n\t&lt;/build&gt;\n&lt;/project&gt;</pre><p><br/></p><p>2、往pom.xml中添加Struts2和log4j2的 maven依赖</p><pre class=\"brush:xml;toolbar:false\">&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;struts2-core&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.3.24.1&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t\n\t\t&lt;!--&nbsp;log4j2&nbsp;begin&nbsp;--&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.4&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.4&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.4&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;log4j-jcl&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.4&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;log4j-web&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.4&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;!--&nbsp;log4j2&nbsp;end&nbsp;--&gt;</pre><p><br/></p><p>3、将log4j2.xml配置文件放到“WEB-INF”目录下</p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;!--&nbsp;status表示log4j事件输出控制台级别，分别有&quot;trace&quot;,&nbsp;&quot;debug&quot;,&nbsp;&quot;info&quot;,&nbsp;&quot;warn&quot;,&nbsp;&quot;error&quot;,&quot;fatal&quot;&nbsp;--&gt;\n&lt;!--&nbsp;monitorInterval表示log4j会自动监听配置文件的变动，最小监听时间为5秒&nbsp;--&gt;\n&lt;Configuration&nbsp;status=&quot;WARN&quot;&nbsp;monitorInterval=&quot;5&quot;&gt;\n\n&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;通用属性配置&nbsp;--&gt;\n&nbsp;&nbsp;&lt;Properties&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;Property&nbsp;name=&quot;appname&quot;&gt;imethan-web&lt;/Property&gt;\n&nbsp;&nbsp;&lt;/Properties&gt;\n&nbsp;&nbsp;\n&nbsp;&nbsp;&lt;!--&nbsp;默认过滤等级&nbsp;--&gt;\n&nbsp;&nbsp;&lt;ThresholdFilter&nbsp;level=&quot;trace&quot;/&gt;\n&nbsp;&nbsp;\n&nbsp;&nbsp;&lt;Appenders&gt;\n&nbsp;&nbsp;\t&lt;!--&nbsp;控制台输出&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;Console&nbsp;name=&quot;Console&quot;&nbsp;target=&quot;SYSTEM_OUT&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&nbsp;pattern=&quot;%d{HH:mm:ss.SSS}&nbsp;[%t]&nbsp;%-5level&nbsp;%logger{36}&nbsp;-&nbsp;%msg%n&quot;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Console&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;每日文件记录&nbsp;--&gt;\n\t&lt;RollingFile&nbsp;name=&quot;RollingFile&quot;&nbsp;fileName=&quot;logs/${appname}.log&quot;&nbsp;filePattern=&quot;logs/${appname}-%d{MM-dd-yyyy}.log.gz&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;BurstFilter&nbsp;level=&quot;warn&quot;&nbsp;rate=&quot;16&quot;&nbsp;maxBurst=&quot;100&quot;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pattern&gt;%d&nbsp;%p&nbsp;%c{1.}&nbsp;[%t]&nbsp;%m%n&lt;/pattern&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TimeBasedTriggeringPolicy&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;\n\t&lt;RollingFile&nbsp;name=&quot;RollingFileError&quot;&nbsp;fileName=&quot;logs/${appname}-error.log&quot;&nbsp;filePattern=&quot;logs/${appname}-error-%d{MM-dd-yyyy}.log.gz&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ThresholdFilter&nbsp;level=&quot;error&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PatternLayout&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pattern&gt;%d&nbsp;%p&nbsp;%c{1.}&nbsp;[%t]&nbsp;%m%n&lt;/pattern&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/PatternLayout&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TimeBasedTriggeringPolicy&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/RollingFile&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;NoSql数据库记录&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;NoSql&nbsp;name=&quot;databaseAppender&quot;&nbsp;ignoreExceptions=&quot;false&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;MongoDb&nbsp;databaseName=&quot;database&quot;&nbsp;collectionName=&quot;applicationLog&quot;&nbsp;server=&quot;127.0.0.1&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username=&quot;&quot;&nbsp;password=&quot;&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/NoSql&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&lt;/Appenders&gt;\n&nbsp;&nbsp;\n&nbsp;&nbsp;&lt;Loggers&gt;\n&nbsp;&nbsp;\t&lt;!--&nbsp;全局日志记录&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;Root&nbsp;level=&quot;debug&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef&nbsp;ref=&quot;Console&quot;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef&nbsp;ref=&quot;RollingFile&quot;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;AppenderRef&nbsp;ref=&quot;RollingFileError&quot;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Root&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&lt;/Loggers&gt;\n&lt;/Configuration&gt;</pre><p><br/></p><p>4、往web.xml配置文件中添加Struts2 Servlet过滤器、log4j2监听器和过滤器</p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;log4j2&nbsp;web2.0&nbsp;begin&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;listener&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;listener-class&gt;org.apache.logging.log4j.web.Log4jServletContextListener&lt;/listener-class&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/listener&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;log4jServletFilter&lt;/filter-name&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-class&gt;org.apache.logging.log4j.web.Log4jServletFilter&lt;/filter-class&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/filter&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-mapping&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;log4jServletFilter&lt;/filter-name&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/filter-mapping&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;log4j2&nbsp;web2.0&nbsp;end--&gt;\n\n\t&lt;filter&gt;\n\t\t&lt;filter-name&gt;struts2&lt;/filter-name&gt;\n\t\t&lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;\n\t&lt;/filter&gt;\n\n\t&lt;filter-mapping&gt;\n\t\t&lt;filter-name&gt;struts2&lt;/filter-name&gt;\n\t\t&lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n\t&lt;/filter-mapping&gt;</pre><p>5、将struts2.xml放到“src/main/resources”下，并且在“WEB-INF/view”目录下创建index.jsp文件</p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE&nbsp;struts&nbsp;PUBLIC\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;-//Apache&nbsp;Software&nbsp;Foundation//DTD&nbsp;Struts&nbsp;Configuration&nbsp;2.0//EN&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://struts.apache.org/dtds/struts-2.0.dtd&quot;&gt;&nbsp;\n&lt;struts&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;constant&nbsp;name=&quot;struts.devMode&quot;&nbsp;value=&quot;true&quot;&nbsp;/&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;package&nbsp;name=&quot;basicstruts2&quot;&nbsp;extends=&quot;struts-default&quot;&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;action&nbsp;name=&quot;index&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&gt;/WEB-INF/view/index.jsp&lt;/result&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/package&gt;&nbsp;\n&lt;/struts&gt;</pre><p><br/></p><pre class=\"brush:xml;toolbar:false\">&lt;html&gt;\n\t&lt;body&gt;\n\t&lt;h2&gt;Welcome&nbsp;to&nbsp;Struts&nbsp;2!&lt;/h2&gt;\n\t&lt;/body&gt;\n&lt;/html&gt;</pre><p><br/></p><p>6、 Jetty运行启动，浏览器访问：<a href=\"http://localhost:8080/imethan-struts2/index.action\" _src=\"http://localhost:8080/imethan-struts2/index.action\">http://localhost:8080/imethan-struts2/index.action</a>,返回index.jsp页面内容：</p><h2 style=\"font-family: Simsun; white-space: normal;\">Welcome to Struts 2!</h2><p><br/></p><p>参考文档</p><p><a href=\"http://struts.apache.org/docs/getting-started.html\" target=\"_blank\" textvalue=\"http://struts.apache.org/docs/getting-started.html\">http://struts.apache.org/docs/getting-started.html</a> </p><p><br/></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Struts2专题",
      "tag": "Struts2",
      "createAt": "2015/12/30 18:09:16",
      "updateAt": "2015/12/31 09:14:43"
    },
    {
      "title": "Struts2专题之二：Struts2 WEB应用的Hello World",
      "content": "<p>在上一篇描述的基础之上继续</p><p>1、创建Model类MessageStore.java</p><pre class=\"brush:java;toolbar:false\">package&nbsp;cn.imethan.web.struts2;\n/**\n&nbsp;*&nbsp;MessageStore.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年12月31日上午9:39:12\n&nbsp;*/\npublic&nbsp;class&nbsp;MessageStore&nbsp;{\n&nbsp;private&nbsp;String&nbsp;message;\n&nbsp;public&nbsp;MessageStore()&nbsp;{\n&nbsp;&nbsp;setMessage(&quot;Hello&nbsp;Struts&nbsp;User&quot;);\n&nbsp;}\n&nbsp;public&nbsp;String&nbsp;getMessage()&nbsp;{\n&nbsp;&nbsp;return&nbsp;message;\n&nbsp;}\n&nbsp;public&nbsp;void&nbsp;setMessage(String&nbsp;message)&nbsp;{\n&nbsp;&nbsp;this.message&nbsp;=&nbsp;message;\n&nbsp;}\n}</pre><p><br/></p><p>2、创建Action类HelloWorldAction.java</p><pre class=\"brush:java;toolbar:false\">package&nbsp;cn.imethan.web.struts2;\nimport&nbsp;com.opensymphony.xwork2.ActionSupport;\n/**\n&nbsp;*&nbsp;HelloWorldAction.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年12月31日上午9:39:42\n&nbsp;*/&nbsp;\npublic&nbsp;class&nbsp;HelloWorldAction&nbsp;extends&nbsp;ActionSupport&nbsp;{&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;1L;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;MessageStore&nbsp;messageStore;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;execute()&nbsp;throws&nbsp;Exception&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messageStore&nbsp;=&nbsp;new&nbsp;MessageStore()&nbsp;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SUCCESS;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MessageStore&nbsp;getMessageStore()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;messageStore;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setMessageStore(MessageStore&nbsp;messageStore)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.messageStore&nbsp;=&nbsp;messageStore;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n}</pre><p><br/></p><p>3、创建JSP视图View HelloWorld.jsp</p><pre class=\"brush:html;toolbar:false\">&lt;%@&nbsp;page&nbsp;language=&quot;java&quot;&nbsp;contentType=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;%@&nbsp;taglib&nbsp;prefix=&quot;s&quot;&nbsp;uri=&quot;/struts-tags&quot;&nbsp;%&gt;\n&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;\n&lt;title&gt;Hello&nbsp;World!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&nbsp;&lt;h2&gt;&lt;s:property&nbsp;value=&quot;messageStore.message&quot;&nbsp;/&gt;&lt;/h2&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p>4、struts.xml配置文件添加action配置</p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE&nbsp;struts&nbsp;PUBLIC\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;-//Apache&nbsp;Software&nbsp;Foundation//DTD&nbsp;Struts&nbsp;Configuration&nbsp;2.0//EN&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://struts.apache.org/dtds/struts-2.0.dtd&quot;&gt;&nbsp;\n&lt;struts&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;constant&nbsp;name=&quot;struts.devMode&quot;&nbsp;value=&quot;true&quot;&nbsp;/&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;package&nbsp;name=&quot;basicstruts2&quot;&nbsp;extends=&quot;struts-default&quot;&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;action&nbsp;name=&quot;index&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&gt;/WEB-INF/view/index.jsp&lt;/result&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;action&nbsp;name=&quot;hello&quot;&nbsp;class=&quot;cn.imethan.web.struts2.HelloWorldAction&quot;&nbsp;method=&quot;execute&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&nbsp;name=&quot;success&quot;&gt;/WEB-INF/view/HelloWorld.jsp&lt;/result&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/package&gt;&nbsp;\n&lt;/struts&gt;</pre><p><br/></p><p>5、在index.jsp中创建url调用</p><pre class=\"brush:html;toolbar:false\">&lt;%@&nbsp;page&nbsp;language=&quot;java&quot;&nbsp;contentType=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;%@&nbsp;taglib&nbsp;prefix=&quot;s&quot;&nbsp;uri=&quot;/struts-tags&quot;&nbsp;%&gt;\n&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;\n&lt;title&gt;Basic&nbsp;Struts&nbsp;2&nbsp;Application&nbsp;-&nbsp;Welcome&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&nbsp;&lt;h2&gt;Welcome&nbsp;to&nbsp;Struts&nbsp;2!&lt;/h2&gt;\n&nbsp;&lt;p&gt;&lt;a&nbsp;href=&quot;&lt;s:url&nbsp;action=&#39;hello&#39;/&gt;&quot;&gt;Hello&nbsp;World&lt;/a&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><br/></p><p>6、运行程序并且使用浏览器访问<a href=\"http://localhost:8080/imethan-struts2/index.action\" _src=\"http://localhost:8080/imethan-struts2/index.action\">http://localhost:8080/imethan-struts2/index.action</a>,返回index.jsp页面内容：</p><h2>Welcome to Struts 2!</h2><p><a href=\"http://localhost:8080/hello.action\">Hello World</a></p><p><br/></p><p>点击“Hello World”，返回HelloWorld.jsp页面内容：</p><h2>Hello Struts User</h2><p><br/></p><p>参考文档</p><p><a href=\"http://struts.apache.org/docs/getting-started.html\" target=\"_blank\" textvalue=\"http://struts.apache.org/docs/getting-started.html\">http://struts.apache.org/docs/getting-started.html</a> </p><p><br/></p>",
      "show": "1",
      "channel": "Struts2专题",
      "tag": "Struts2",
      "createAt": "2015/12/31 09:47:16",
      "updateAt": "2015/12/31 09:57:11"
    },
    {
      "title": "Struts2专题之三：Struts2 Tags标签库的使用",
      "content": "<p>国际惯例，在上一篇的基础之上继续</p><p>1、使用Struts2的tag标签库之前，需要在jsp页面的开头引入：&lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;</p><p>2、&lt;s:url action=&#39;hello&#39;/&gt;说明</p><p>在index.jsp中的代码&lt;a href=&quot;&lt;s:url action=&#39;hello&#39;/&gt;&quot;&gt;Hello World&lt;/a&gt;，在页面展示时鼠标移动到上面会显示带有“/hello.action”后缀的完整访问路径：http://localhost:8080/hello.action</p><p><br/></p><p>点击该将链接执行struts.xml配置文件中的如下Action：</p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;action&nbsp;name=&quot;hello&quot;&nbsp;class=&quot;cn.imethan.web.struts2.HelloWorldAction&quot;&nbsp;method=&quot;execute&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&nbsp;name=&quot;success&quot;&gt;/WEB-INF/view/HelloWorld.jsp&lt;/result&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/action&gt;</pre><p>3、url tag标签设置参数</p><pre class=\"brush:xml;toolbar:false\">&lt;s:url&nbsp;action=&quot;hello&quot;&nbsp;var=&quot;helloLink&quot;&gt;\n&nbsp;&nbsp;&lt;s:param&nbsp;name=&quot;userName&quot;&gt;Bruce&nbsp;Phillips&lt;/s:param&gt;\n&lt;/s:url&gt;\n&nbsp;\n&lt;p&gt;&lt;a&nbsp;href=&quot;&lt;s:property&nbsp;value=&quot;helloLink&quot;/&gt;&quot;&gt;Hello&nbsp;Bruce&nbsp;Phillips&lt;/a&gt;&lt;/p&gt;</pre><p>&lt;s:property value=&quot;helloLink&quot;/&gt;展现出来的内容是带有“/hello.action?userName=Bruce+Phillips”后缀的完整访问路径：http://localhost:8080/hello.action?userName=Bruce+Phillips<br/></p><p><br/></p><p>4、form tag标签</p><pre class=\"brush:html;toolbar:false\">&lt;p&gt;Get&nbsp;your&nbsp;own&nbsp;personal&nbsp;hello&nbsp;by&nbsp;filling&nbsp;out&nbsp;and&nbsp;submitting&nbsp;this&nbsp;form.&lt;/p&gt;&nbsp;\n&lt;s:form&nbsp;action=&quot;hello&quot;&gt;&nbsp;\n&nbsp;&nbsp;&lt;s:textfield&nbsp;name=&quot;userName&quot;&nbsp;label=&quot;Your&nbsp;name&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&lt;s:submit&nbsp;value=&quot;Submit&quot;&nbsp;/&gt;&nbsp;\n&lt;/s:form&gt;</pre><p>上述内容在页面展现时会转换为如下：</p><pre class=\"brush:html;toolbar:false\">&lt;form&nbsp;id=&quot;hello&quot;&nbsp;name=&quot;hello&quot;&nbsp;action=&quot;/Using_Tags_Struts2_Mvn/hello.action;jsessionid=3471d76027b5342cab44f297b567&quot;&nbsp;method=&quot;post&quot;&gt;\n&nbsp;&lt;table&nbsp;class=&quot;wwFormTable&quot;&gt;&nbsp;\n&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;class=&quot;tdLabel&quot;&gt;&lt;label&nbsp;for=&quot;hello_userName&quot;&nbsp;class=&quot;label&quot;&gt;Your&nbsp;name:&lt;/label&gt;&lt;/td&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;userName&quot;&nbsp;value=&quot;&quot;&nbsp;id=&quot;hello_userName&quot;/&gt;&lt;/td&gt;\n&lt;/tr&gt;&nbsp;\n&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;colspan=&quot;2&quot;&gt;&lt;div&nbsp;align=&quot;right&quot;&gt;&lt;input&nbsp;type=&quot;submit&quot;&nbsp;id=&quot;hello_0&quot;&nbsp;value=&quot;Submit&quot;/&gt;\n&lt;/div&gt;&lt;/td&gt;\n&lt;/tr&gt;&nbsp;\n&lt;/table&gt;\n&lt;/form&gt;</pre><p>5、property tag标签<br/></p><div class=\"line number1 index0 alt2\"><br/><pre class=\"brush:java;toolbar:false\">package&nbsp;cn.imethan.web.struts2;\n/**\n&nbsp;*&nbsp;MessageStore.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年12月31日上午9:39:12\n&nbsp;*/\npublic&nbsp;class&nbsp;MessageStore&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;message;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MessageStore()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setMessage(&quot;Hello&nbsp;Struts&nbsp;User&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getMessage()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;message;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setMessage(String&nbsp;message)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.message&nbsp;=&nbsp;message;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p><code class=\"html plain\"></code></p><p>&lt;s:property value=&quot;messageStore.message&quot; /&gt;展示messageStore.message内容为：Hello Struts User</p><p>&lt;s:property value=&quot;messageStore&quot; /&gt;展示的信息为：cn.imethan.web.struts2.MessageStore@353272b9</p><p>重写类MessageStore的toString方法后：</p><pre class=\"brush:java;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;@Override\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;MessageStore&nbsp;[message=&quot;&nbsp;+&nbsp;message&nbsp;+&nbsp;&quot;]&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p><code class=\"html plain\"><code class=\"html string\"></code></code></p><p>&lt;s:property value=&quot;messageStore&quot; /&gt;展示的信息为：MessageStore [message=Hello Struts User]</p><p><br/></p><p>参考文档</p><p><a href=\"http://struts.apache.org/docs/getting-started.html\" target=\"_blank\">http://struts.apache.org/docs/getting-started.html</a></p></div>",
      "show": "1",
      "channel": "Struts2专题",
      "tag": "Struts2",
      "createAt": "2015/12/31 10:47:16",
      "updateAt": "2015/12/31 11:13:31"
    },
    {
      "title": "Struts2专题开篇：写在前面的话 ",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\"><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;在</span>大学的时候学校就有开设一门Struts的课程，当时学习的是Struts1，2010年暑假自己自学了Struts2，步入工作岗位后便开始使用Struts2，后来Struts2爆出了一些列的漏洞事件，在后续的项目MVC框架便选择了Spring MVC。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\">&nbsp;&nbsp;&nbsp;&nbsp;目前JAVA WEB界还是有很多人在用Struts2，所以借着之前学习以及实际生产的经验，重新这里一下Struts2的应用知识。<br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\"> &nbsp; &nbsp;<br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\">&nbsp;&nbsp;&nbsp;&nbsp;Struts2是在Struts1和Webwork这两个框架互相取长补短整合<span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">后再</span>开发的Struts新一代产物。</span><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Struts 2以WebWork为核心，采用拦截器的机制来处理用户的请求，使得业务逻辑控制器能够与ServletAPI完全脱离开，所以Struts 2可以理解为WebWork的更新产品。虽然从Struts 1到Struts 2有着太大的变化，但是相对于WebWork，Struts 2的变化很小。</span></p><p><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Struts2是一个MVC模式的框架，</span><span style=\"color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">MVC全名是Model View Controller，是模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范，用一种业务逻辑、数据、界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面及用户交互的同时，不需要重新编写业务逻辑。MVC被独特的发展起来用于映射传统的输入、处理和输出功能在一个逻辑的图形化用户界面的结构中。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(127, 127, 127);\">参考资料</span></p><p><a href=\"http://struts.apache.org/\" target=\"_blank\" textvalue=\"http://struts.apache.org/\">http://struts.apache.org/</a> </p><p><a href=\"http://struts.apache.org/docs/guides.html\" target=\"_blank\" textvalue=\"http://struts.apache.org/docs/guides.html\">http://struts.apache.org/docs/guides.html</a> </p><p><a href=\"http://struts.apache.org/docs/tutorials.html\" target=\"_blank\" textvalue=\"http://struts.apache.org/docs/tutorials.html\">http://struts.apache.org/docs/tutorials.html</a> </p>",
      "show": "1",
      "channel": "Struts2专题",
      "tag": "Struts2",
      "createAt": "2015/12/29 18:19:39",
      "updateAt": "2015/12/31 13:37:54"
    },
    {
      "title": "Struts2专题之四：Action的定义和Form表单参数处理",
      "content": "<p>接Struts2专题上一篇</p><p>1、Action的定义，以及mapping映射描述，看代码注释</p><p>Action在MVC中充当Controller控制器的角色，Struts2定义一个Action类通常继续ActionSupport类。</p><pre class=\"brush:java;toolbar:false\">package&nbsp;cn.imethan.web.struts2;\nimport&nbsp;com.opensymphony.xwork2.ActionSupport;\n/**\n&nbsp;*&nbsp;HelloWorldAction.java\n&nbsp;*\n&nbsp;*&nbsp;@author&nbsp;Ethan&nbsp;Wong\n&nbsp;*&nbsp;@since&nbsp;JDK&nbsp;1.7\n&nbsp;*&nbsp;@datetime&nbsp;2015年12月31日上午9:39:42\n&nbsp;*/&nbsp;\npublic&nbsp;class&nbsp;HelloWorldAction&nbsp;extends&nbsp;ActionSupport&nbsp;{&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;1L;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;MessageStore&nbsp;messageStore;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;execute()&nbsp;throws&nbsp;Exception&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messageStore&nbsp;=&nbsp;new&nbsp;MessageStore()&nbsp;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SUCCESS;//对应配置文件里面的&nbsp;&quot;success&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MessageStore&nbsp;getMessageStore()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;messageStore;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setMessageStore(MessageStore&nbsp;messageStore)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.messageStore&nbsp;=&nbsp;messageStore;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\n}</pre><p><br/></p><pre class=\"brush:java;toolbar:false\">&lt;!--&nbsp;method方法指定Action调用执行的方法名称&nbsp;--&gt;\n&lt;action&nbsp;name=&quot;hello&quot;&nbsp;class=&quot;org.apache.struts.helloworld.action.HelloWorldAction&quot;&nbsp;method=&quot;execute&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;result的名称指定返回名称，对用配置的jsp页面&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&nbsp;name=&quot;success&quot;&gt;/WEB-INF/view/HelloWorld.jsp&lt;/result&gt;\n&lt;/action&gt;</pre><p><br/></p><p>2、Action中添加私有变量，处理from或者url提交的参数</p><p>在HelloWorldAction中添加如下私有变量userName和get、set方法</p><pre class=\"brush:java;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;userName;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getUserName()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;userName;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setUserName(String&nbsp;userName)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.userName&nbsp;=&nbsp;userName;\n&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p>index.jsp添加如下表单内容：</p><pre class=\"brush:html;toolbar:false\">&nbsp;&lt;s:form&nbsp;action=&quot;hello&quot;&gt;\n&nbsp;&nbsp;&nbsp;&lt;s:textfield&nbsp;name=&quot;userName&quot;&nbsp;label=&quot;Your&nbsp;name&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:submit&nbsp;value=&quot;Submit&quot;&nbsp;/&gt;\n&nbsp;&lt;/s:form&gt;</pre><p>HelloWorld.jsp添加userName展现内容：</p><p>&lt;p&gt;userName：&lt;s:property value=&quot;userName&quot;/&gt; &lt;/p&gt;</p><p><br/></p><p>部署运行项目，提交表单参数，执行name为hello的Action，浏览器返回结果如下：</p><p>userName：imethan，其中imethan是输入表单提交的内容。</p><p><br/></p><p>3、通过创建Model类，在Model类中设置变量，用于接收表单参数</p><p>创建PersonModel类、RegisterAction Action类、register.jsp注册表单页面和成功返回页面thankyou.jsp、struts.xml配置文件添加Action节点</p><pre class=\"brush:java;toolbar:false\">public&nbsp;class&nbsp;Person&nbsp;{\n&nbsp;\n&nbsp;private&nbsp;String&nbsp;firstName;\n&nbsp;private&nbsp;String&nbsp;lastName;\n&nbsp;private&nbsp;String&nbsp;email;\n&nbsp;private&nbsp;int&nbsp;age;\n\n&nbsp;public&nbsp;String&nbsp;getFirstName()&nbsp;{\n&nbsp;&nbsp;return&nbsp;firstName;\n&nbsp;}\n\n&nbsp;public&nbsp;void&nbsp;setFirstName(String&nbsp;firstName)&nbsp;{\n&nbsp;&nbsp;this.firstName&nbsp;=&nbsp;firstName;\n&nbsp;}\n\n&nbsp;public&nbsp;String&nbsp;getLastName()&nbsp;{\n&nbsp;&nbsp;return&nbsp;lastName;\n&nbsp;}\n\n&nbsp;public&nbsp;void&nbsp;setLastName(String&nbsp;lastName)&nbsp;{\n&nbsp;&nbsp;this.lastName&nbsp;=&nbsp;lastName;\n&nbsp;}\n\n&nbsp;public&nbsp;String&nbsp;getEmail()&nbsp;{\n&nbsp;&nbsp;return&nbsp;email;\n&nbsp;}\n\n&nbsp;public&nbsp;void&nbsp;setEmail(String&nbsp;email)&nbsp;{\n&nbsp;&nbsp;this.email&nbsp;=&nbsp;email;\n&nbsp;}\n\n&nbsp;public&nbsp;int&nbsp;getAge()&nbsp;{\n&nbsp;&nbsp;return&nbsp;age;\n&nbsp;}\n\n&nbsp;public&nbsp;void&nbsp;setAge(int&nbsp;age)&nbsp;{\n&nbsp;&nbsp;this.age&nbsp;=&nbsp;age;\n&nbsp;}\n\n&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{\n&nbsp;&nbsp;return&nbsp;&quot;First&nbsp;Name:&nbsp;&quot;&nbsp;+&nbsp;getFirstName()&nbsp;+&nbsp;&quot;&nbsp;Last&nbsp;Name:&nbsp;&nbsp;&quot;&nbsp;+&nbsp;getLastName()&nbsp;+&nbsp;&quot;&nbsp;Email:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;+&nbsp;getEmail()&nbsp;+&nbsp;&quot;&nbsp;Age:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;+&nbsp;getAge();\n&nbsp;}\n}</pre><p><br/></p><p>RegisterAction</p><pre class=\"brush:java;toolbar:false\">import&nbsp;com.opensymphony.xwork2.ActionSupport;\npublic&nbsp;class&nbsp;RegisterAction&nbsp;extends&nbsp;ActionSupport&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;1L;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Person&nbsp;personBean;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;register(){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;register&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;@Override\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;execute()&nbsp;throws&nbsp;Exception&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//call&nbsp;Service&nbsp;class&nbsp;to&nbsp;store&nbsp;personBean&#39;s&nbsp;state&nbsp;in&nbsp;database\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SUCCESS;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Person&nbsp;getPersonBean()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;personBean;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setPersonBean(Person&nbsp;person)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personBean&nbsp;=&nbsp;person;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p>register.jsp</p><pre class=\"brush:html;toolbar:false\">&lt;%@&nbsp;page&nbsp;language=&quot;java&quot;&nbsp;contentType=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;%@&nbsp;taglib&nbsp;prefix=&quot;s&quot;&nbsp;uri=&quot;/struts-tags&quot;&nbsp;%&gt;\n&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;\n&lt;title&gt;Register&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h3&gt;Register&nbsp;for&nbsp;a&nbsp;prize&nbsp;by&nbsp;completing&nbsp;this&nbsp;form.&lt;/h3&gt;\n&lt;s:form&nbsp;action=&quot;register&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:textfield&nbsp;name=&quot;personBean.firstName&quot;&nbsp;label=&quot;First&nbsp;name&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:textfield&nbsp;&nbsp;name=&quot;personBean.lastName&quot;&nbsp;label=&quot;Last&nbsp;name&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:textfield&nbsp;name=&quot;personBean.email&quot;&nbsp;&nbsp;label&nbsp;=&quot;Email&quot;/&gt;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:textfield&nbsp;name=&quot;personBean.age&quot;&nbsp;&nbsp;label=&quot;Age&quot;&nbsp;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:submit/&gt;\n&lt;/s:form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p>thankyou.jsp</p><pre class=\"brush:html;toolbar:false\">&lt;%@&nbsp;page&nbsp;language=&quot;java&quot;&nbsp;contentType=&quot;text/html;&nbsp;charset=UTF-8&quot;&nbsp;pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;%@&nbsp;taglib&nbsp;prefix=&quot;s&quot;&nbsp;uri=&quot;/struts-tags&quot;&nbsp;%&gt;\n&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;\n&lt;title&gt;Registration&nbsp;Successful&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&nbsp;&lt;h3&gt;Thank&nbsp;you&nbsp;for&nbsp;registering&nbsp;for&nbsp;a&nbsp;prize.&lt;/h3&gt;\n&nbsp;&lt;p&gt;Your&nbsp;registration&nbsp;information:&nbsp;&lt;s:property&nbsp;value=&quot;personBean&quot;&nbsp;/&gt;&nbsp;&lt;/p&gt;\n&nbsp;&lt;p&gt;&lt;a&nbsp;href=&quot;&lt;s:url&nbsp;action=&#39;enter&#39;&nbsp;/&gt;&quot;&nbsp;&gt;Return&nbsp;to&nbsp;home&nbsp;page&lt;/a&gt;.&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><br/></p><pre class=\"brush:xml;toolbar:false\">&lt;action&nbsp;name=&quot;enter&quot;&nbsp;class=&quot;cn.imethan.web.struts2.RegisterAction&quot;&nbsp;method=&quot;register&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&nbsp;name=&quot;register&quot;&gt;/WEB-INF/view/register.jsp&lt;/result&gt;\n&lt;/action&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;action&nbsp;name=&quot;register&quot;&nbsp;class=&quot;cn.imethan.web.struts2.RegisterAction&quot;&nbsp;method=&quot;execute&quot;&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;result&nbsp;name=&quot;success&quot;&gt;/WEB-INF/view/thankyou.jsp&lt;/result&gt;\n&lt;/action&gt;</pre><p><br/></p><p>创建完成后，部署运行，http://localhost:8080/enter.action，输入表单信息如下：</p><h3>Register for a prize by completing this form.</h3><form name=\"register\" id=\"register\" action=\"/register.action\" method=\"post\"><table class=\"wwFormTable\"><tbody><tr class=\"firstRow\"><td class=\"tdLabel\"><label for=\"register_personBean_firstName\">First name:</label></td><td style=\"word-break: break-all;\"><input name=\"personBean.firstName\" id=\"register_personBean_firstName\" type=\"text\" value=\"\"/></td></tr><tr><td class=\"tdLabel\" style=\"word-break: break-all;\"><label for=\"register_personBean_lastName\">Last name:</label></td><td style=\"word-break: break-all;\"><input name=\"personBean.lastName\" id=\"register_personBean_lastName\" type=\"text\" value=\"\"/></td></tr><tr><td class=\"tdLabel\"><label for=\"register_personBean_email\">Email:</label></td><td style=\"word-break: break-all;\"><input name=\"personBean.email\" id=\"register_personBean_email\" type=\"text\" value=\"\"/></td></tr><tr><td class=\"tdLabel\"><label for=\"register_personBean_age\">Age:</label></td><td style=\"word-break: break-all;\"><input name=\"personBean.age\" id=\"register_personBean_age\" type=\"text\" value=\"\"/></td></tr><tr><td colspan=\"2\"><p><input id=\"register_0\" type=\"submit\" value=\"Submit\"/></p></td></tr></tbody></table></form><p><br/></p><p>提交返回信息如下：</p><h3>Thank you for registering for a prize.</h3><p>Your registration information: First Name: ethan Last Name: &nbsp;wong Email: &nbsp; &nbsp; &nbsp;ethan@qq.com Age: &nbsp; &nbsp; &nbsp;100</p><p><a href=\"http://localhost:8080/enter.action\">Return to home page</a>.</p><p><br/></p><p><br/></p><p>参考文档</p><p><a href=\"http://struts.apache.org/docs/getting-started.html\" target=\"_blank\" textvalue=\"http://struts.apache.org/docs/getting-started.html\">http://struts.apache.org/docs/getting-started.html</a></p>",
      "show": "1",
      "channel": "Struts2专题",
      "tag": "Struts2",
      "createAt": "2015/12/31 13:47:23",
      "updateAt": "2015/12/31 15:44:10"
    },
    {
      "title": "Apache Log2j 2 学习笔记",
      "content": "<p>log4j 1.X用了好几年了，花了点时间研究学习了一下log4j 2.X，简介记录一下学习笔记。</p><p><strong>#使用maven构建项目，编辑pom.xml文件，首先引入dependency</strong></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;artifactId&gt;log4j-api&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;version&gt;2.4&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;artifactId&gt;log4j-core&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;version&gt;2.4&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;version&gt;2.4&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;/dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;dependency&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;artifactId&gt;log4j-nosql&lt;/artifactId&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp; &nbsp;&lt;version&gt;2.4&lt;/version&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span> &nbsp;&lt;/dependency&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;dependency&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;groupId&gt;org.mongodb&lt;/groupId&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;artifactId&gt;mongo-java-driver&lt;/artifactId&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;version&gt;2.12.3&lt;/version&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;/dependency&gt;</p><p><br/></p><p><strong>#以下是测试好的配置文件，添加相关的注释</strong></p><p>文件名称为：log4j2.xml，配置内容如下：</p><p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</p><p>&lt;!-- status表示log4j事件输出控制台级别，分别有&quot;trace&quot;, &quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, &quot;error&quot;,&quot;fatal&quot; --&gt;</p><p>&lt;!-- monitorInterval表示log4j会自动监听配置文件的变动，最小监听时间为5秒 --&gt;</p><p>&lt;Configuration status=&quot;WARN&quot; monitorInterval=&quot;5&quot;&gt;</p><p><br/></p><p>&nbsp; &nbsp;&lt;!-- 通用属性配置 --&gt;</p><p>&nbsp; &lt;Properties&gt;</p><p>&nbsp; &nbsp; &lt;Property name=&quot;appname&quot;&gt;imethan&lt;/Property&gt;</p><p>&nbsp; &lt;/Properties&gt;</p><p>&nbsp;&nbsp;</p><p>&nbsp; &lt;!-- 默认过滤等级 --&gt;</p><p>&nbsp; &lt;ThresholdFilter level=&quot;trace&quot;/&gt;</p><p>&nbsp;&nbsp;</p><p>&nbsp; &lt;Appenders&gt;</p><p>&nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;!-- 控制台输出 --&gt;</p><p>&nbsp; &nbsp; &lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;</p><p>&nbsp; &nbsp; &lt;/Console&gt;</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &lt;!-- 单个文件记录 --&gt;</p><p>&nbsp; &nbsp; &lt;File name=&quot;File&quot; fileName=&quot;${appname}.log&quot; bufferedIO=&quot;true&quot; advertiseURI=&quot;target/output.log&quot; advertise=&quot;false&quot;&gt;</p><p>&nbsp; &nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;</p><p>&nbsp; &nbsp; &lt;/File&gt;</p><p>&nbsp; &nbsp; &lt;Appender type=&quot;File&quot; name=&quot;File&quot; fileName=&quot;${appname}.log&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;Layout type=&quot;PatternLayout&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;Pattern&gt;%d %p %C{1.} [%t] %m%n&lt;/Pattern&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;/Layout&gt;</p><p>&nbsp; &nbsp; &lt;/Appender&gt;</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &lt;!-- 每日文件记录 --&gt;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;RollingFile name=&quot;RollingFile&quot; fileName=&quot;logs/${appname}.log&quot; filePattern=&quot;logs/${appname}-%d{MM-dd-yyyy}.log.gz&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;BurstFilter level=&quot;debug&quot; rate=&quot;16&quot; maxBurst=&quot;100&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;PatternLayout&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;pattern&gt;%d %p %c{1.} [%t] %m%n&lt;/pattern&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;/PatternLayout&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;TimeBasedTriggeringPolicy /&gt;</p><p>&nbsp; &nbsp; &lt;/RollingFile&gt;</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &lt;!-- NoSql数据库记录 --&gt;</p><p>&nbsp; &nbsp; &lt;NoSql name=&quot;databaseAppender&quot; ignoreExceptions=&quot;false&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;MongoDb databaseName=&quot;database&quot; collectionName=&quot;applicationLog&quot; server=&quot;127.0.0.1&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;username=&quot;&quot; password=&quot;&quot; /&gt;</p><p>&nbsp; &nbsp; &lt;/NoSql&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &lt;/Appenders&gt;</p><p>&nbsp;&nbsp;</p><p>&nbsp; &lt;Loggers&gt;</p><p>&nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;!-- 全局日志记录 --&gt;</p><p>&nbsp; &nbsp; &lt;Root level=&quot;debug&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;AppenderRef ref=&quot;Console&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;AppenderRef ref=&quot;File&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;AppenderRef ref=&quot;RollingFile&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;AppenderRef ref=&quot;databaseAppender&quot;/&gt;</p><p>&nbsp; &nbsp; &lt;/Root&gt;</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;!-- 定义特定的程序的日志记录，additivity设置为flase,阻止Root再次打印 --&gt;</p><p>&nbsp; <span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>&lt;Logger name=&quot;cn.log4j.Bar&quot; level=&quot;debug&quot; additivity=&quot;false&quot;&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;AppenderRef ref=&quot;Console&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;AppenderRef ref=&quot;File&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;!-- 过滤输出特定的日志 --&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;Filters&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;MarkerFilter marker=&quot;FLOW&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;NEUTRAL&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;MarkerFilter marker=&quot;EXCEPTION&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;/&gt;</p><p>&nbsp; &nbsp; &nbsp; &lt;/Filters&gt;</p><p>&nbsp; &nbsp; &lt;/Logger&gt;</p><p>&nbsp; &lt;/Loggers&gt;</p><p>&lt;/Configuration&gt;</p><p><br/></p><p>参考：</p><p><a href=\"http://logging.apache.org/log4j/2.x/\" target=\"_blank\">http://logging.apache.org/log4j/2.x/</a></p><p><br/></p><p><br/></p><p><br/></p>",
      "show": "1",
      "channel": "Apache框架笔记",
      "tag": "日志框架",
      "createAt": "2015/9/29 15:22:40",
      "updateAt": "2015/12/29 14:39:05"
    },
    {
      "title": "Spring项目整合Logback日志框架",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">1、加入maven依赖</span></p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&lt;!--&nbsp;logback&nbsp;begin&nbsp;&nbsp;--&gt;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;1.1.3&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.logback-extensions&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;logback-ext-spring&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;0.1.2&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;1.7.12&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;!--&nbsp;logback&nbsp;end&nbsp;&nbsp;--&gt;</pre><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: &#39;microsoft yahei&#39;; font-size: 15px; line-height: 35px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">第一个logback-classic包含了logback本身所需的slf4j-api.jar、logback-core.jar及logback-classsic.jar</span></p><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: &#39;microsoft yahei&#39;; font-size: 15px; line-height: 35px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">第二个logback-ext-spring是由官方提供的对Spring的支持，它的作用就相当于log4j中的Log4jConfigListener；这个listener，网上大多都是用的自己实现的，原因在于这个插件似乎并没有出现在官方文档的显要位置导致大多数人并不知道它的存在</span></p><p style=\"margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(85, 85, 85); font-family: &#39;microsoft yahei&#39;; font-size: 15px; line-height: 35px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">第三个jcl-over-slf4j是用来把Spring源代码中大量使用到的commons-logging替换成slf4j，只有在添加了这个依赖之后才能看到Spring框架本身打印的日志，否则只能看到开发者自己打印的日志</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">2、日志配置文件&quot;log/logback.xml&quot;</span></p><pre class=\"brush:xml;toolbar:false\">&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;\n&lt;configuration&gt;\n\n\t&lt;!--定义日志文件的存储地址&nbsp;勿在&nbsp;LogBack&nbsp;的配置中使用相对路径--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;property&nbsp;name=&quot;LOG_HOME&quot;&nbsp;value=&quot;${user.dir}&quot;&nbsp;/&gt;\n\n\t&lt;!--&nbsp;控制台输出&nbsp;--&gt;\n\t&lt;appender&nbsp;name=&quot;console&quot;&nbsp;class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;\n\t\t&lt;encoder&nbsp;charset=&quot;UTF-8&quot;&gt;\n\t\t\t&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;\n\t\t\t&lt;pattern&gt;%date{HH:mm:ss.SSS}&nbsp;[%thread]&nbsp;%-5level&nbsp;%logger{36}&nbsp;-&nbsp;%msg%n&lt;/pattern&gt;\n\t\t&lt;/encoder&gt;\n\t&lt;/appender&gt;\n\t\n\t&lt;!--&nbsp;按照每天生成日志文件&nbsp;--&gt;\n\t&lt;appender&nbsp;name=&quot;rollingFile&quot;&nbsp;class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;\n\t\t&lt;file&gt;${LOG_HOME}/logs/system.log&lt;/file&gt;\n\t\t&lt;rollingPolicy&nbsp;class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;\n\t\t\t&lt;!--日志文件输出的文件名--&gt;\n\t\t\t&lt;fileNamePattern&gt;${LOG_HOME}/logs/system.%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;\n\t\t\t&lt;!--日志文件保留天数--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;MaxHistory&gt;30&lt;/MaxHistory&gt;\n\t\t&lt;/rollingPolicy&gt;\n\t\t&lt;encoder&gt;\n\t\t\t&lt;pattern&gt;%date{HH:mm:ss.SSS}&nbsp;[%thread]&nbsp;%-5level&nbsp;%logger{36}&nbsp;-&nbsp;%msg%n&lt;/pattern&gt;\n\t\t&lt;/encoder&gt;\n\t&lt;/appender&gt;\n\t\n\t&lt;appender&nbsp;name=&quot;businessLogFile&quot;&nbsp;class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;\n\t\t&lt;file&gt;${LOG_HOME}/logs/system_business.log&lt;/file&gt;\n\t\t&lt;!--&nbsp;按每小时滚动文件，如果一个小时内达到10M也会滚动文件,&nbsp;滚动文件将会压缩成zip格式&nbsp;--&gt;\n\t\t&lt;rollingPolicy&nbsp;class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;\n\t\t\t&lt;fileNamePattern&gt;${LOG_HOME}/logs/system_business_%d{yyyy-MM-dd_HH}.%i.zip&lt;/fileNamePattern&gt;\n\t\t\t&lt;!--日志文件最大的大小--&gt;\n\t\t\t&lt;timeBasedFileNamingAndTriggeringPolicy&nbsp;class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt;\n\t\t\t\t&lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;\n\t\t\t&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;\n\t\t\t&lt;!--日志文件保留天数--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;MaxHistory&gt;30&lt;/MaxHistory&gt;\n\t\t&lt;/rollingPolicy&gt;\n\t\t&lt;!--&nbsp;独立的pattern&nbsp;--&gt;\n\t\t&lt;encoder&nbsp;charset=&quot;UTF-8&quot;&gt;\n\t\t\t&lt;pattern&gt;%d{HH:mm:ss.SSS},%msg%n&lt;/pattern&gt;\n\t\t&lt;/encoder&gt;\n\t&lt;/appender&gt;\n\t\n\t&lt;!--&nbsp;business&nbsp;log&nbsp;使用独立的appender，不继承Root的appender&nbsp;--&gt;\n\t&lt;logger&nbsp;name=&quot;business&quot;&nbsp;level=&quot;INFO&quot;&nbsp;additivity=&quot;false&quot;&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;businessLogFile&quot;&nbsp;/&gt;\n\t&lt;/logger&gt;\n\n\t&lt;!--&nbsp;日志输出级别&nbsp;--&gt;\n\t&lt;root&nbsp;level=&quot;DEBUG&quot;&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;console&quot;&nbsp;/&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;rollingFile&quot;&nbsp;/&gt;\n\t\t&lt;appender-ref&nbsp;ref=&quot;businessLogFile&quot;&nbsp;/&gt;\n\t&lt;/root&gt;\n\t\n\t&lt;!--&nbsp;下面配置一些第三方包的日志过滤级别，用于避免刷屏，additivity属性为false，表示此loger的打印信息不再向上级传递，默认为true&nbsp;--&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;org.hibernate&quot;&nbsp;level=&quot;error&quot;&nbsp;additivity=&quot;false&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;org.springframework&quot;&nbsp;level=&quot;error&quot;&nbsp;additivity=&quot;false&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;com.opensymphony&quot;&nbsp;level=&quot;WARN&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;org.apache&quot;&nbsp;level=&quot;info&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;java.sql.Connection&quot;&nbsp;level=&quot;DEBUG&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;java.sql.Statement&quot;&nbsp;level=&quot;DEBUG&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;logger&nbsp;name=&quot;java.sql.PreparedStatement&quot;&nbsp;level=&quot;DEBUG&quot;&nbsp;/&gt;\n\t\n&lt;/configuration&gt;</pre><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">3、web.xml配置文件添加如下内容配置</span></p><pre class=\"brush:xml;toolbar:false\">\t&lt;!--&nbsp;logback监听配置,context-param必须独立配置&nbsp;--&gt;\n\t&lt;context-param&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\t&lt;param-name&gt;logbackConfigLocation&lt;/param-name&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\t&lt;param-value&gt;classpath:log/logback.xml&lt;/param-value&gt;\n\t&lt;/context-param&gt;\n\t&lt;listener&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;\t&lt;listener-class&gt;ch.qos.logback.ext.spring.web.LogbackConfigListener&lt;/listener-class&gt;\n\t&lt;/listener&gt;</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">注意，该配置文件必须放在&lt;context-param&gt;...&lt;/context-param&gt;配置文件之后，如果没有会导致Logback找不到自定义的配置文件，而使用默认的配置文件，从而导致配置没有生效</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">参考文档：<br/></span></p><p><a href=\"http://logback.qos.ch/\" target=\"_blank\" style=\"text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">http://logback.qos.ch/</span></a></p><p><a href=\"http://blog.csdn.net/sadfishsc/article/details/47160213\" target=\"_self\" style=\"text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(89, 89, 89);\">http://blog.csdn.net/sadfishsc/article/details/47160213</span></a></p><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "日志框架",
      "createAt": "2015/12/29 14:43:09",
      "updateAt": "2015/12/29 15:05:29"
    },
    {
      "title": "Linux安装配置Tomcat",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">一、安装JAVA运行时环境jre</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">到oracle官网下载“jre-7u79-linux-x64.rpm”，并且安装（使用root账号登录安装）</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">rpm -ivh&nbsp;jre-7u79-linux-x64.rpm</span><br/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">查看默认安装目录&nbsp;</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">find / -name java</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">/usr/java/jre1.7.0_79</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">环境变量配置</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi&nbsp;<span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">/etc/profile</span></span></p><p><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">在profile文件末尾加入：&nbsp;</span><br style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">export JAVA_HOME=/usr/java/jre1.7.0_79&nbsp;</span><br style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">export PATH=$JAVA_HOME/bin:$PATH&nbsp;</span><br style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"font-family: &#39;black Verdana&#39;, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px; background-color: rgb(255, 255, 255);\">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar&nbsp;</span></span></p><p><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">二、安装配置Tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1、到tomcat官网下载“apache-tomcat-7.0.67-windows-x64.zip”，将安装zip文件上传至/data并且解压</span></p><p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">cd /</span></p><p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">mkdir data</span></p><p style=\"white-space: normal;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">cd /data</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">unzip&nbsp;apache-tomcat-7.0.67-windows-x64.zip &nbsp;(如果没有unzip命令则安装：yum install unzip)</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">2、解压完成后，为脚本文件授权</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">cd&nbsp;/data/apache-tomcat-7.0.67/bin</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod +x startup.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod +x&nbsp;catalina.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod +x&nbsp;shutdown.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">3、配置server.xml中的URIEncoding编码为：URIEncoding=&quot;utf-8&quot;，</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi&nbsp;/data/apache-tomcat-7.0.67/conf/server.xml</span></p><pre class=\"brush:xml;toolbar:false\">&lt;Connector&nbsp;port=&quot;8080&quot;&nbsp;protocol=&quot;HTTP/1.1&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectionTimeout=&quot;20000&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirectPort=&quot;8443&quot;&nbsp;URIEncoding=&quot;utf-8&quot;&nbsp;/&gt;</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">这里同时可以修改默认端口8080为其他未被占用的端口</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">4、为tomcat加大内存配置：编辑catalina.sh添加内存配置，这里最大内存配置为2G</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi&nbsp;/data/apache-tomcat-7.0.67/bin/catalina.sh</span></p><pre class=\"brush:xml;toolbar:false\">JAVA_OPTS=&quot;-server&nbsp;-Xms1600m&nbsp;-Xmx1600m&nbsp;-Xmn533m&nbsp;-XX:PermSize=128m&nbsp;-XX:MaxPermSize=320m\n-XX:NewSize=320m&nbsp;-XX:MaxNewSize=512m&nbsp;-Dfile.encoding=utf-8&quot;</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">至此，tomcat可以开始启动运行工作</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">./startup.sh</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CATALINA_BASE: &nbsp; /data/apache-tomcat-7.0.67</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CATALINA_HOME: &nbsp; /data/apache-tomcat-7.0.67</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CATALINA_TMPDIR: /data/apache-tomcat-7.0.67/temp</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using JRE_HOME: &nbsp; &nbsp; &nbsp; &nbsp;/usr</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Using CLASSPATH: &nbsp; &nbsp; &nbsp; /data/apache-tomcat-7.0.67/bin/bootstrap.jar:/data/apache-tomcat-7.0.67/bin/tomcat-juli.jar</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Tomcat started.</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">三、其他更多配置<br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1、将tomcat配置为服务启动</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">vi /etc/init.d/tomcat</span></p><pre class=\"brush:xml;toolbar:false\">#!/bin/bash\n#set&nbsp;startup&nbsp;script&nbsp;for&nbsp;the&nbsp;Tomcat&nbsp;server\n#\n#&nbsp;chkconfig:&nbsp;345&nbsp;80&nbsp;20\n#&nbsp;description:&nbsp;start&nbsp;the&nbsp;tomcat&nbsp;deamon\n#\n#&nbsp;Source&nbsp;function&nbsp;library\n.&nbsp;/etc/rc.d/init.d/functions\n&nbsp;\nprog=tomcat\nJAVA_HOME=/usr/java/jre1.7.0_79\n&nbsp;export&nbsp;JAVA_HOME\nCATALANA_HOME=/data/apache-tomcat-7.0.67\n&nbsp;export&nbsp;CATALINA_HOME\n&nbsp;\ncase&nbsp;&quot;$1&quot;&nbsp;in&nbsp;start)\n&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Starting&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/startup.sh\n&nbsp;&nbsp;&nbsp;&nbsp;;;\n&nbsp;\nstop)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Stopping&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/shutdown.sh\n&nbsp;&nbsp;&nbsp;&nbsp;;;\n&nbsp;\nrestart)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Stopping&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/shutdown.sh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Starting&nbsp;Tomcat...&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;$CATALANA_HOME/bin/startup.sh\n&nbsp;&nbsp;&nbsp;&nbsp;;;\n&nbsp;*)\n&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Usage:&nbsp;$prog&nbsp;{start|stop|restart}&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;;;&nbsp;esac\nexit&nbsp;0</pre><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"></span><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">为服务启动脚本执行授权</span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">chmod +x /etc/init.d/tomcat</span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><br/></span></p><p><span style=\"font-family:微软雅黑\"><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">检查是否配置成功</span></span></p><p><span style=\"font-family:微软雅黑\"><span style=\"font-size: 14px; line-height: 21px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">service tomcat start | stop | restart</span></span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\"><br/></span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">2、配置为开启自动启<br/></span></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">chkconfig --add tomcat</span></p><p><br/></p><p><span style=\"font-size: 14px; line-height: 21px; widows: auto; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; background-color: rgb(255, 255, 255);\">3、将tomcat目录和服务执行脚本的拥有者分配给非root用户</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">创建用户组tomcat：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">groupadd tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">添加用户并加入组：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">useradd tomcat -g tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">修改tomcat用户密码：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">passwd tomcat</span></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">给tomcat组用户tomcat分配</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown -R tomcat:tomcat /data/apache-tomcat-7.0.67</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chown &nbsp;tomcat:tomcat&nbsp;/etc/init.d/tomcat</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">chmod a+x /etc/init.d/tomcat</span></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Tomcat",
      "createAt": "2016/1/5 10:02:37",
      "updateAt": "2016/1/5 12:15:04"
    },
    {
      "title": "Tomcat使用Redis缓存实现分布式Session共享",
      "content": "<p>前置场景描述</p><p>&nbsp;&nbsp;&nbsp; 在两台linux服务器上分别安装Tomcat，并且部署相同的WEB应用，通过前置服务器的nginx反向代理，达到这两个Tomcat的负载均衡的目的，实现分布式部署；当发生单点故障或者临时停机，nginx会将用户当前访问的WEB应用切换到其他正常服务器到应用上，这个时候如果session不同步，则会导致用户会话超时，提示再次登录的现象，会给用户产生非常不好的体验。</p><p>所以出现了Tocmat Session共享的课题，用于解决session不同步，应用切换时会话超时的问题。</p><p>&nbsp;&nbsp;&nbsp; Tomcat Session共享的实现方式有多种，例如使用memcache、mongodb、redis等，本文主要针对使用redis来实现Tomcat的Session共享。</p><p><br/></p><p>实际操作步骤</p><p>1、访问<a _src=\"https://github.com/jcoleman/tomcat-redis-session-manager/releases\" href=\"https://github.com/jcoleman/tomcat-redis-session-manager/releases\">https://github.com/jcoleman/tomcat-redis-session-manager/releases</a> ，下载&quot;1.2-tomcat-7-java-7.zip&quot;并解压后将项目导入Eclipse，构建成功，并且导出“tomcat-redis-session-manager-1.2-tomcat-7.jar”</p><p><br/></p><p>2、将如下jar包放到tomcat的lib目录下</p><p>tomcat-redis-session-manager-1.2-tomcat-7.jar</p><p>commons-pool2-2.2.jar</p><p>jedis-2.5.2.jar</p><p>tomcat-juli-7.0.27.jar</p><p><br/></p><p>3、编辑tomcat配置文件context.xml，加入如下内容</p><pre class=\"brush:xml;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;Valve&nbsp;className=&quot;com.radiadesign.catalina.session.RedisSessionHandlerValve&quot;&nbsp;/&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;Manager&nbsp;className=&quot;com.radiadesign.catalina.session.RedisSessionManager&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host=&quot;localhost&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=&quot;6379&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;database=&quot;0&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxInactiveInterval=&quot;60&quot;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&gt;</pre><p><br/></p><p>这里使用的是本机默认安装的redis</p><p><br/></p><p>4、启动tomcat并且访问应用，查看redis缓存内容如下</p><p>127.0.0.1:6379&gt; get 33B32CE273EE4375C78B75CD8BE684DA<br/>&quot;\\xac\\xed\\x00\\x05sr\\x00Ncn.zblink.framework.redis.session.manager.tomcat7.SessionSerializationMetadata\\xdea\\xb1\\n\\x9a\\xcdn\\xff\\x03\\x00\\x01[\\x00\\x15sessionAttributesHasht\\x00\\x02[Bxpw\\x14\\x00\\x00\\x00\\x10V\\x1b\\x96:\\xe1r\\x97_m&#39;k\\xbb\\xca\\xeb\\x0e\\x1axsr\\x00\\x0ejava.lang.Long;\\x8b\\xe4\\x90\\xcc\\x8f#\\xdf\\x02\\x00\\x01J\\x00\\x05valuexr\\x00\\x10java.lang.Number\\x86\\xac\\x95\\x1d\\x0b\\x94\\xe0\\x8b\\x02\\x00\\x00xp\\x00\\x00\\x01RDC\\&quot;\\x02sq\\x00~\\x00\\x03\\x00\\x00\\x01RDC\\&quot;\\x02sr\\x00\\x11java.lang.Integer\\x12\\xe2\\xa0\\xa4\\xf7\\x81\\x878\\x02\\x00\\x01I\\x00\\x05valuexq\\x00~\\x00\\x04\\x00\\x00\\a\\bsr\\x00\\x11java.lang.Boolean\\xcd r\\x80\\xd5\\x9c\\xfa\\xee\\x02\\x00\\x01Z\\x00\\x05valuexp\\x01q\\x00~\\x00\\nsq\\x00~\\x00\\x03\\x00\\x00\\x01RDC\\&quot;\\x03t\\x00 33B32CE273EE4375C78B75CD8BE684DAsq\\x00~\\x00\\a\\x00\\x00\\x00\\x01t\\x00\\x15justForSessionTestKeyq\\x00~\\x00\\x0ew\\b\\x00\\x00\\x01RDC\\&quot;\\x02&quot;<br/>127.0.0.1:6379&gt;</p><p><br/></p><p>参考文档：</p><p>https://github.com/jcoleman/tomcat-redis-session-manager</p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Tomcat",
      "createAt": "2016/1/15 15:23:42",
      "updateAt": "2016/1/15 15:52:57"
    },
    {
      "title": "持续集成工具Jenkins安装配置(Jenkins、SVN、MAVEN、Tomcat )",
      "content": "<p><strong>开篇说明</strong></p><p>持续集成工具可以使项目的构建、测试和部署等自动化，为软件开发节省大量的时间,这里主要简单介绍MAC下安装Jenkins，并且新建一个构建MAVEN的项目，使用SVN进行源码管理，构建成功后，安装部署到Tomcat 7.x。</p><p><br/></p><p><strong>环境准备</strong></p><p>1、安装好JDK并且配置好环境变量，这里略过</p><p>2、安装好MAVEN并且配置好环境变量，这里略过</p><p>3、安装好Tomcat并且配置好端口和管理用户权限和角色</p><p style=\"white-space: normal;\">下载“apache-tomcat-7.0.67-windows-x64.zip”解压为“apache-tomcat-7.0.67”</p><p style=\"white-space: normal;\">编辑“conf/tomcat-users.xml”，配置管理员账号和权限</p><pre class=\"brush:xml;toolbar:false\">&lt;role&nbsp;rolename=&quot;manager-gui&quot;/&gt;\n&lt;role&nbsp;rolename=&quot;manager-script&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;role&nbsp;rolename=&quot;manager-jmx&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;role&nbsp;rolename=&quot;manager-status&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;user&nbsp;username=&quot;admin&quot;&nbsp;password=&quot;123456&quot;&nbsp;roles=&quot;manager-gui&quot;/&gt;&nbsp;&nbsp;\n&lt;user&nbsp;username=&quot;tomcat&quot;&nbsp;password=&quot;123456&quot;&nbsp;roles=&quot;manager-script,manager-jmx,manager-status&quot;/&gt;</pre><p style=\"white-space: normal;\">由于Jenkins默认安装的端口是8080,所有这里需要修改Tomcat的端口为7777</p><p style=\"white-space: normal;\">编辑“conf/server.xml”</p><pre class=\"brush:xml;toolbar:false\">&lt;Connector&nbsp;port=&quot;7777&quot;&nbsp;protocol=&quot;HTTP/1.1&quot;&nbsp;connectionTimeout=&quot;20000&quot;&nbsp;redirectPort=&quot;8443&quot;</pre><p><br/></p><p><strong>具体步骤</strong></p><p>1、访问<a href=\"http://jenkins-ci.org/\" target=\"_blank\" textvalue=\"http://jenkins-ci.org/\">http://jenkins-ci.org/</a>下载适合自己操作系统的版本的安装包。</p><p>MAC下载安装“jenkins-1.644.pkg”，浏览器打开：http://localhost:8080,显示Jenkins表示安装成功。</p><p><br/></p><p>2、默认安装的Jenkins没有自带“Deploy to container Plugin”插件，所里这里需要安装这个插件，在Jenkins首页进入到“系统管理”-》“插件管理”-》“可选插件”，选择“Deploy to container Plugin”并且安装。</p><p><br/></p><p>3、进行“系统管理”-》“系统配置”</p><p>&nbsp;&nbsp;&nbsp;&nbsp;1）Maven Configuration</p><p>&nbsp;&nbsp;&nbsp;&nbsp;2）Maven -》 Maven安装</p><p>&nbsp;&nbsp;&nbsp;&nbsp;3）邮件通知</p><p><br/></p><p>4、在Jenkins首页新建一个“<strong style=\"box-sizing: border-box; color: rgb(51, 51, 51); font-family: Helvetica, Arial, sans-serif; font-size: 13px; white-space: normal;\">构建一个maven项目</strong>”的项目</p><p>&nbsp; &nbsp;1）源码管理配置：svn://localhost/svn-repository/appone</p><p>&nbsp; &nbsp;2）构建触发器&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Helvetica, Arial, sans-serif; font-size: 13px;\">Poll SCM ：&nbsp;*/5 * * * * &nbsp; &nbsp;//5分钟执行一次</span></p><p>&nbsp; &nbsp;3）构建后操作 构建成功后部署到Tomcat</p><p><br/></p><p><strong>其他说明</strong></p><p>1、mac下使用如下命令可以进行Jenkins的启动和关闭</p><p><!--StartFragment--></p><p>sudo launchctl unload\n/Library/LaunchDaemons/org.jenkins-ci.plist</p><p>sudo launchctl load\n/Library/LaunchDaemons/org.jenkins-ci.plist</p><p><!--EndFragment--></p><p><br/></p><p>2、mac下默认安装的Jenkins的目录是“/Users/Shared/Jenkins/Home”</p><p><br/></p><p><br/></p><p>参考文档</p><p><a _src=\"http://jenkins-ci.org/\" href=\"http://jenkins-ci.org/\">http://jenkins-ci.org/</a></p><p><a href=\"http://www.cnblogs.com/itech/archive/2011/11/23/2260009.html\" _src=\"http://www.cnblogs.com/itech/archive/2011/11/23/2260009.html\">http://www.cnblogs.com/itech/archive/2011/11/23/2260009.html</a></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Tomcat",
      "createAt": "2016/1/15 17:27:13",
      "updateAt": "2016/1/17 15:51:04"
    },
    {
      "title": "org.quartz.SchedulerException: Couldn't get host name! [See nested exception: java.net.UnknownHostException:",
      "content": "<p>hostname没有指向IP地址，编辑/etc/hosts，将hostname指向127.0.0.1即可</p><p>vi /etc/hosts</p><pre class=\"brush:xml;toolbar:false\">127.0.0.1&nbsp;&nbsp;&nbsp;localhost&nbsp;localhost.localdomain&nbsp;localhost4&nbsp;localhost4.localdomain4\n::1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localhost&nbsp;localhost.localdomain&nbsp;localhost6&nbsp;localhost6.localdomain6\n127.0.0.1&nbsp;&nbsp;&nbsp;ticket.centerB</pre><p><br/></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "Nginx",
      "createAt": "2016/1/12 13:30:28",
      "updateAt": "2016/1/17 23:09:47"
    },
    {
      "title": "nginx反向代理tomcat应用加载不了js问题处理",
      "content": "<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>问题描述</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">在Linux上安装nginx进行反向代理至后端的Tomcat WEB应用，出现加载不了js问题，直接访问相关js也发现内容确实只加载了一半，强制刷新无用，依然只有一半。但是直接访问tomcat的80或者8080端口发现是没有问题的。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>问题原因</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">Nginx代理之后会有相应的代理缓存区，缓存区默认只有几十K，某些版本的nginx默认设置中没有相关处理，导致部分文件代理是会出现加载不全的现象，其实不仅仅是JS文件。只是因为框架的JS文件略大，所以经常出现类似问题。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>问题解决</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">\t在Nginx.conf中添加 &nbsp; &nbsp; proxy_buffer_size 128k;<br/>\t&nbsp; 　　　　　　　　　 &nbsp; proxy_buffers&nbsp;&nbsp; 32 128k;<br/>\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　 &nbsp;proxy_busy_buffers_size 128k;</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">然后重启nginx，即可。Nginx在代理了相应服务后或根据我们配置的UpStream和location来获取相应的文件，首先文件会被解析到nginx的内存或者临时文件目录中，然后由nginx再来响应。那么当proxy_buffers和proxy_buffer_size以及proxy_busy_buffers_size 都太小时，会将内容根据nginx的配置生成到临时文件中，但是临时文件的大小也有默认值。所以当这四个值都过小时就会导致部分文件只加载一部分。所以要根据我们的服务器情况适当的调整proxy_buffers和proxy_buffer_size以及proxy_busy_buffers_size、proxy_temp_file_write_size。具体几个参数的详细如下</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">proxy_buffers&nbsp;&nbsp; 32 128k;&nbsp; 设置了32个缓存区，每个的大小是128k</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">\tproxy_buffer_size 128k; 每个缓存区的大小是128k，当两个值不一致时没有找到具体哪个有效，建议和上面的设置一致。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">proxy_busy_buffers_size 128k;设置使用中的缓存区的大小，控制传输至客户端的缓存的最大</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">proxy_temp_file_write_size 缓存文件的大小</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><strong><font face=\"微软雅黑, Microsoft YaHei\">参考文档</font></strong></p><p><a href=\"http://www.zving.com/dev/server/257610.shtml\" target=\"_blank\" title=\"http://www.zving.com/dev/server/257610.shtml\"><font face=\"微软雅黑, Microsoft YaHei\">http://www.zving.com/dev/server/257610.shtml</font></a></p><p><font face=\"微软雅黑, Microsoft YaHei\"><br/></font></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Nginx",
      "createAt": "2016/3/15 16:13:53",
      "updateAt": "2016/3/15 16:17:48"
    },
    {
      "title": "nginx反向代理转发端口问题",
      "content": "<p>在使用nginx进行反向代理，转发指定的请求的时候没有配置端口转发，导致在程序里面获取不到端口<br/></p><p>没有端口转发的配置：</p><pre class=\"brush:xml;toolbar:false\">upstream&nbsp;server&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;ip_hash;\n&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;192.168.1.100:8080;\n}\n\nserver&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8080;\n&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;&nbsp;server&nbsp;;\n\n&nbsp;&nbsp;&nbsp;&nbsp;charset&nbsp;utf-8;\n\n&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;/&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;&nbsp;&nbsp;html;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;&nbsp;index.html&nbsp;index.htm;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;&nbsp;&nbsp;&nbsp;http://server&nbsp;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_redirect&nbsp;&nbsp;&nbsp;&nbsp;off;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;&nbsp;&nbsp;Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;&nbsp;&nbsp;X-Real-IP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$remote_addr;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;&nbsp;&nbsp;X-Forwarded-For&nbsp;&nbsp;$proxy_add_x_forwarded_for;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_connect_timeout&nbsp;1000;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_read_timeout&nbsp;1000;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_send_timeout&nbsp;1000;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_buffer_size&nbsp;16k;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_buffers&nbsp;4&nbsp;32k;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proxy_busy_buffers_size&nbsp;64k;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;#error_page&nbsp;&nbsp;404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/404.html;\n\n&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;redirect&nbsp;server&nbsp;error&nbsp;pages&nbsp;to&nbsp;the&nbsp;static&nbsp;page&nbsp;/50x.html\n&nbsp;&nbsp;&nbsp;&nbsp;#\n&nbsp;&nbsp;&nbsp;&nbsp;error_page&nbsp;&nbsp;&nbsp;500&nbsp;502&nbsp;503&nbsp;504&nbsp;&nbsp;/50x.html;\n&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;=&nbsp;/50x.html&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;&nbsp;&nbsp;/usr/local/nginx/html;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n}</pre><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">使用该配置，在服务端通过JAVA代码“String uri = request.getRequestURL().toString();”获取URL地址如下，没有端口</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><a href=\"http://192.168.20.2/console/security_check\" _src=\"http://192.168.20.2/console/security_check\">http://192.168.20.2/console/security_check</a></p><p><br/></p><p>需要将配置</p><pre class=\"brush:xml;toolbar:false\">proxy_set_header&nbsp;&nbsp;&nbsp;Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host;</pre><p>改为<br/></p><pre class=\"brush:xml;toolbar:false\">proxy_set_header&nbsp;&nbsp;&nbsp;Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host:$server_port;;</pre><p><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">重新在服务端通过JAVA代码“String uri = request.getRequestURL().toString();”获取URL地址如下，有端口</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><a style=\"white-space: normal;\" href=\"http://192.168.20.2/console/security_check\" _src=\"http://192.168.20.2/console/security_check\">http://192.168.20.2:8080/console/security_check</a></p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Nginx",
      "createAt": "2016/1/12 11:23:52",
      "updateAt": "2016/3/15 16:19:18"
    },
    {
      "title": "搭建nginx反向代理用做内网域名转发",
      "content": "<p>参考文档</p><p><a href=\"https://www.ttlsa.com/nginx/use-nginx-proxy/\" _src=\"https://www.ttlsa.com/nginx/use-nginx-proxy/\">https://www.ttlsa.com/nginx/use-nginx-proxy/</a> </p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Nginx",
      "createAt": "2016/4/24 19:35:49",
      "updateAt": "2016/4/24 19:36:07"
    },
    {
      "title": "nginx 禁止非法url访问 ",
      "content": "<p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">$request_uri&nbsp;<span style=\"word-wrap: break-word;font-family: 宋体\">这个变量等于包含一些客户端请求参数的原始</span><span style=\"word-wrap: break-word;font-family: &#39;Times New Roman&#39;\">URI,</span><span style=\"word-wrap: break-word;font-family: 宋体\">我们可以通过</span><span style=\"word-wrap: break-word;font-family: &#39;Times New Roman&#39;\">if</span><span style=\"word-wrap: break-word;font-family: 宋体\">判断，限制非授权用户使用关键字访问我们的页面</span></p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">&nbsp;</p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">&nbsp;&nbsp;if&nbsp;&nbsp;($request_uri&nbsp;&nbsp;~*&nbsp;&quot;/abc.html\\?test&quot;)&nbsp;{</p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;403&nbsp;&nbsp;&nbsp;&quot;I&#39;ve&nbsp;recorded&nbsp;your&nbsp;ip&nbsp;Wait&nbsp;to&nbsp;check&nbsp;the&nbsp;water&nbsp;meter&quot;;</p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">}</p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">如果正常访问<span style=\"word-wrap: break-word;font-family: &#39;Times New Roman&#39;\">abc.html&nbsp;</span><span style=\"word-wrap: break-word;font-family: 宋体\">是正常的，如果添加了</span><span style=\"word-wrap: break-word;font-family: &#39;Times New Roman&#39;\">?test&nbsp;&nbsp;</span><span style=\"word-wrap: break-word;font-family: 宋体\">这个参数，可能是要非法访问，就会提示&nbsp;&nbsp;</span><span style=\"word-wrap: break-word;font-family: &#39;Times New Roman&#39;\">&quot;I&#39;ve&nbsp;recorded&nbsp;your&nbsp;ip&nbsp;Wait&nbsp;to&nbsp;check&nbsp;the&nbsp;water&nbsp;meter&quot;</span></p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\"><img src=\"http://blog.chinaunix.net/attachment/201501/23/26719405_1421990202e5ov.png\" width=\"342\" height=\"136\" alt=\"\" style=\"word-wrap: break-word;border: 0px\"/>&nbsp;</p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">添加参数测试</p><p style=\"word-wrap: break-word;padding: 0px;color: rgb(102, 102, 102);font-family: 宋体, Arial;line-height: 26px;white-space: normal;background-color: rgb(255, 255, 255)\">&nbsp;<img src=\"http://blog.chinaunix.net/attachment/201501/23/26719405_1421990212z6a6.png\" width=\"443\" height=\"121\" alt=\"\" style=\"word-wrap: break-word;border: 0px\"/></p><p>参考文档</p><p><a href=\"http://blog.chinaunix.net/uid-26719405-id-4777586.html\" _src=\"http://blog.chinaunix.net/uid-26719405-id-4777586.html\">http://blog.chinaunix.net/uid-26719405-id-4777586.html</a> </p><p><br/></p>",
      "show": "1",
      "channel": "Linux操作笔记",
      "tag": "Nginx",
      "createAt": "2016/6/29 10:40:55",
      "updateAt": "2016/6/29 10:42:04"
    },
    {
      "title": "持续集成工具Jenkins安装配置(Jenkins、SVN、MAVEN、Tomcat )",
      "content": "<p><strong>开篇说明</strong></p><p>持续集成工具可以使项目的构建、测试和部署等自动化，为软件开发节省大量的时间,这里主要简单介绍MAC下安装Jenkins，并且新建一个构建MAVEN的项目，使用SVN进行源码管理，构建成功后，安装部署到Tomcat 7.x。</p><p><br/></p><p><strong>环境准备</strong></p><p>1、安装好JDK并且配置好环境变量，这里略过</p><p>2、安装好MAVEN并且配置好环境变量，这里略过</p><p>3、安装好Tomcat并且配置好端口和管理用户权限和角色</p><p style=\"white-space: normal;\">下载“apache-tomcat-7.0.67-windows-x64.zip”解压为“apache-tomcat-7.0.67”</p><p style=\"white-space: normal;\">编辑“conf/tomcat-users.xml”，配置管理员账号和权限</p><pre class=\"brush:xml;toolbar:false\">&lt;role&nbsp;rolename=&quot;manager-gui&quot;/&gt;\n&lt;role&nbsp;rolename=&quot;manager-script&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;role&nbsp;rolename=&quot;manager-jmx&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;role&nbsp;rolename=&quot;manager-status&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;user&nbsp;username=&quot;admin&quot;&nbsp;password=&quot;123456&quot;&nbsp;roles=&quot;manager-gui&quot;/&gt;&nbsp;&nbsp;\n&lt;user&nbsp;username=&quot;tomcat&quot;&nbsp;password=&quot;123456&quot;&nbsp;roles=&quot;manager-script,manager-jmx,manager-status&quot;/&gt;</pre><p style=\"white-space: normal;\">由于Jenkins默认安装的端口是8080,所有这里需要修改Tomcat的端口为7777</p><p style=\"white-space: normal;\">编辑“conf/server.xml”</p><pre class=\"brush:xml;toolbar:false\">&lt;Connector&nbsp;port=&quot;7777&quot;&nbsp;protocol=&quot;HTTP/1.1&quot;&nbsp;connectionTimeout=&quot;20000&quot;&nbsp;redirectPort=&quot;8443&quot;</pre><p><br/></p><p><strong>具体步骤</strong></p><p>1、访问<a href=\"http://jenkins-ci.org/\" target=\"_blank\" textvalue=\"http://jenkins-ci.org/\">http://jenkins-ci.org/</a>下载适合自己操作系统的版本的安装包。</p><p>MAC下载安装“jenkins-1.644.pkg”，浏览器打开：http://localhost:8080,显示Jenkins表示安装成功。</p><p><br/></p><p>2、默认安装的Jenkins没有自带“Deploy to container Plugin”插件，所里这里需要安装这个插件，在Jenkins首页进入到“系统管理”-》“插件管理”-》“可选插件”，选择“Deploy to container Plugin”并且安装。</p><p><br/></p><p>3、进行“系统管理”-》“系统配置”</p><p>&nbsp;&nbsp;&nbsp;&nbsp;1）Maven Configuration</p><p>&nbsp;&nbsp;&nbsp;&nbsp;2）Maven -》 Maven安装</p><p>&nbsp;&nbsp;&nbsp;&nbsp;3）邮件通知</p><p><br/></p><p>4、在Jenkins首页新建一个“<strong style=\"box-sizing: border-box; color: rgb(51, 51, 51); font-family: Helvetica, Arial, sans-serif; font-size: 13px; white-space: normal;\">构建一个maven项目</strong>”的项目</p><p>&nbsp; &nbsp;1）源码管理配置：svn://localhost/svn-repository/appone</p><p>&nbsp; &nbsp;2）构建触发器&nbsp;<span style=\"color: rgb(51, 51, 51); font-family: Helvetica, Arial, sans-serif; font-size: 13px;\">Poll SCM ：&nbsp;*/5 * * * * &nbsp; &nbsp;//5分钟执行一次</span></p><p>&nbsp; &nbsp;3）构建后操作 构建成功后部署到Tomcat</p><p><br/></p><p><strong>其他说明</strong></p><p>1、mac下使用如下命令可以进行Jenkins的启动和关闭</p><p><!--StartFragment--></p><p>sudo launchctl unload\n/Library/LaunchDaemons/org.jenkins-ci.plist</p><p>sudo launchctl load\n/Library/LaunchDaemons/org.jenkins-ci.plist</p><p><!--EndFragment--></p><p><br/></p><p>2、mac下默认安装的Jenkins的目录是“/Users/Shared/Jenkins/Home”</p><p><br/></p><p><br/></p><p>参考文档</p><p><a _src=\"http://jenkins-ci.org/\" href=\"http://jenkins-ci.org/\">http://jenkins-ci.org/</a></p><p><a href=\"http://www.cnblogs.com/itech/archive/2011/11/23/2260009.html\" _src=\"http://www.cnblogs.com/itech/archive/2011/11/23/2260009.html\">http://www.cnblogs.com/itech/archive/2011/11/23/2260009.html</a></p>",
      "show": "1",
      "channel": "程序员笔记",
      "tag": "持续集成",
      "createAt": "2016/1/15 17:27:13",
      "updateAt": "2016/1/17 15:51:04"
    }
  ]
}